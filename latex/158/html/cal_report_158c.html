
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>cal_report_158c</title><meta name="generator" content="MATLAB 9.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-07-12"><meta name="DC.source" content="cal_report_158c.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Brewer Evaluation</a></li><li><a href="#3">READ Brewer Summaries</a></li><li><a href="#4">configuration files</a></li><li><a href="#6">DT analysis_</a></li><li><a href="#7">SL Report</a></li><li><a href="#8">SL report plot</a></li><li><a href="#9">Hg Report</a></li><li><a href="#10">READ Configuration</a></li><li><a href="#11">Data recalculation for summaries  and individual observations</a></li><li><a href="#12">Filter distribution</a></li><li><a href="#14">filter correction</a></li><li><a href="#15">Ozone Calibration</a></li><li><a href="#16">Change? No change</a></li><li><a href="#17">Blind Period</a></li><li><a href="#19">Sugerido con los blind_days</a></li><li><a href="#22">Blind days table</a></li><li><a href="#24">Final Period</a></li><li><a href="#25">filter correction</a></li><li><a href="#26">TEST NEW CONFIG</a></li><li><a href="#27">FINAL CONFIG</a></li><li><a href="#28">TWO POINT CALIBRATION</a></li><li><a href="#31">STRAY</a></li><li><a href="#34">Latex variables</a></li><li><a href="#35">calculation</a></li><li><a href="#36">Apply the SL correction</a></li><li><a href="#37">Difference iter#1 to iter#2</a></li><li><a href="#39">Final days table</a></li><li><a href="#40">Summary  Final Comparison all data detailed for osc ranges</a></li><li><a href="#42">Plot daily summary</a></li><li><a href="#43">final days: final config.</a></li><li><a href="#44">detailed comparison</a></li></ul></div><pre class="codeinput"><span class="comment">% options_pub.outputDir=fullfile(pwd,'latex','158','html'); options_pub.showCode=true;</span>
<span class="comment">% close all; publish(fullfile(pwd,'cal_report_158c.m'),options_pub);</span>
</pre><h2 id="2">Brewer Evaluation</h2><pre class="codeinput">clear <span class="string">all</span>;
file_setup=<span class="string">'arenos2019_setup'</span>;

eval(file_setup);     <span class="comment">% configuracion por defecto</span>
Cal.n_inst=find(Cal.brw==158);
Cal.file_latex=fullfile(<span class="string">'.'</span>,<span class="string">'latex'</span>,Cal.brw_str{Cal.n_inst});
Cal.dir_figs=fullfile(<span class="string">'latex'</span>,filesep(),Cal.brw_str{Cal.n_inst},<span class="keyword">...</span>
                              filesep(),[Cal.brw_str{Cal.n_inst},<span class="string">'_figures'</span>],filesep());
mkdir(Cal.dir_figs);

<span class="keyword">try</span>
 save(Cal.file_save,<span class="string">'-Append'</span>,<span class="string">'Cal'</span>); <span class="comment">%sobreescribimos la configuracion guardada.</span>
 load(Cal.file_save);
<span class="keyword">catch</span>
    disp(<span class="string">'clean'</span>);
    save(Cal.file_save);
<span class="keyword">end</span>

<span class="comment">% Brewer setup</span>
Cal.Date.CALC_DAYS=Cal.calibration_days{Cal.n_inst,1};
Cal.n_ref=find(Cal.brw==185);
</pre><pre class="codeoutput">
ans =

  logical

   1


ans =

  1&times;1 cell array

    {'IZO#185'}


ans =

  20&times;9 cell array

  Columns 1 through 5

    {'TSK#005'}    {[  5]}    {[2]}    {[0]}    {'005'}
    {'IOS#017'}    {[ 17]}    {[2]}    {[0]}    {'017'}
    {'SCO#033'}    {[ 33]}    {[2]}    {[0]}    {'033'}
    {'MAD#070'}    {[ 70]}    {[4]}    {[0]}    {'070'}
    {'UK_#075'}    {[ 75]}    {[4]}    {[0]}    {'075'}
    {'MUR#117'}    {[117]}    {[4]}    {[0]}    {'117'}
    {'UK_#126'}    {[126]}    {[4]}    {[0]}    {'126'}
    {'ARE#150'}    {[150]}    {[3]}    {[0]}    {'150'}
    {'COR#151'}    {[151]}    {[4]}    {[0]}    {'151'}
    {'K&amp;Z#158'}    {[158]}    {[3]}    {[0]}    {'158'}
    {'WRC#163'}    {[163]}    {[3]}    {[0]}    {'163'}
    {'ZAR#166'}    {[166]}    {[4]}    {[0]}    {'166'}
    {'UK_#172'}    {[172]}    {[3]}    {[0]}    {'172'}
    {'JAP#174'}    {[174]}    {[3]}    {[0]}    {'174'}
    {'IZO#185'}    {[185]}    {[3]}    {[0]}    {'185'}
    {'MAD#186'}    {[186]}    {[3]}    {[0]}    {'186'}
    {'CAN#190'}    {[190]}    {[3]}    {[0]}    {'190'}
    {'TAM#201'}    {[201]}    {[3]}    {[0]}    {'201'}
    {'DNK#202'}    {[202]}    {[3]}    {[0]}    {'202'}
    {'DNK#228'}    {[228]}    {[3]}    {[0]}    {'228'}

  Columns 6 through 9

    {'..\005\ICF15117&#8230;'}    {'..\005\ICF17219&#8230;'}    {'1838'}    {'1838'}
    {'..\017\ICF14919&#8230;'}    {'..\017\ICF14919&#8230;'}    {'1680'}    {'1680'}
    {'..\033\ICF15617&#8230;'}    {'..\033\IOS15617&#8230;'}    {'2325'}    {'2325'}
    {'..\070\ICF15617&#8230;'}    {'..\070\IOS15617&#8230;'}    {'1685'}    {'1685'}
    {'..\075\ICF15017&#8230;'}    {'..\075\ICF17819&#8230;'}    {'1714'}    {'1714'}
    {'..\117\ICF15517&#8230;'}    {'..\117\IOS15517&#8230;'}    {'1620'}    {'1620'}
    {'..\126\icf15517&#8230;'}    {'..\126\ICF17419&#8230;'}    {'1710'}    {'1710'}
    {'..\150\ICF15617&#8230;'}    {'..\150\ICF17519&#8230;'}    {'0322'}    {'0315'}
    {'..\151\ICF15317&#8230;'}    {'..\151\IOS15317&#8230;'}    {'1880'}    {'1880'}
    {'..\158\ICF21218&#8230;'}    {'..\158\ICF17519&#8230;'}    {'0558'}    {'0540'}
    {'..\163\ICF21018&#8230;'}    {'..\163\ICF17519&#8230;'}    {'0274'}    {'0274'}
    {'..\166\ICF15217&#8230;'}    {'..\166\ICF17419&#8230;'}    {'1955'}    {'1955'}
    {'..\172\ICF15117&#8230;'}    {'..\172\ICF17819&#8230;'}    {'0444'}    {'0444'}
    {'..\174\ICF20718&#8230;'}    {'..\174\ICF17819&#8230;'}    {'0605'}    {'0605'}
    {'..\185\config18&#8230;'}    {'..\185\config18&#8230;'}    {'0365'}    {'0367'}
    {'..\186\ICF15317&#8230;'}    {'..\186\IOS15317&#8230;'}    {'0315'}    {'0315'}
    {'..\190\ICF11419&#8230;'}    {'..\190\ICF17519&#8230;'}    {'0410'}    {'0410'}
    {'..\201\ICF14315&#8230;'}    {'..\201\ICF17519&#8230;'}    {'0320'}    {'0320'}
    {'..\202\ICF15017&#8230;'}    {'..\202\ICF17519&#8230;'}    {'0270'}    {'0270'}
    {'..\228\ICF15017&#8230;'}    {'..\228\ICF17419&#8230;'}    {'0242'}    {'0242'}


Cal = 

  struct with fields:

           path_root: '/Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019'
           file_save: 'arenos_2019.mat'
            campaign: 'Arenosillo, Huelva (Spain), Jun 27th -- June 05th, 2019'
             Station: [1&times;1 struct]
                Date: [1&times;1 struct]
    calibration_days: {20&times;3 cell}
          blind_days: {20&times;1 cell}
          final_days: {20&times;1 cell}
                 brw: [1&times;20 double]
                brwM: [2 2 2 4 4 4 4 3 4 3 3 4 3 3 3 3 3 3 3 3]
                sl_c: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
          sl_c_blind: [1 1 0 0 1 0 0 1 1 0 0 0 1 1 0 0 1 1 1 1]
            no_maint: [0 1 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 0 0 0]
                 plt: {1&times;20 cell}
               n_brw: 20
            brw_name: {1&times;20 cell}
             brw_str: {1&times;20 cell}
               Tsync: 3.5000
          brewer_ref: 15
               n_ref: [15 15]
              events: {1&times;19 cell}
            events_n: {1&times;19 cell}
         events_text: {1&times;19 cell}
          events_raw: {1&times;19 cell}
     incidences_text: {1&times;19 cell}
               ETC_C: {20&times;1 cell}


check =

  20&times;10 cell array

  Columns 1 through 5

    {'TSK#005'}    {[  5]}    {[2]}    {[0]}    {'005'}
    {'IOS#017'}    {[ 17]}    {[2]}    {[0]}    {'017'}
    {'SCO#033'}    {[ 33]}    {[2]}    {[0]}    {'033'}
    {'MAD#070'}    {[ 70]}    {[4]}    {[0]}    {'070'}
    {'UK_#075'}    {[ 75]}    {[4]}    {[0]}    {'075'}
    {'MUR#117'}    {[117]}    {[4]}    {[0]}    {'117'}
    {'UK_#126'}    {[126]}    {[4]}    {[0]}    {'126'}
    {'ARE#150'}    {[150]}    {[3]}    {[0]}    {'150'}
    {'COR#151'}    {[151]}    {[4]}    {[0]}    {'151'}
    {'K&amp;Z#158'}    {[158]}    {[3]}    {[0]}    {'158'}
    {'WRC#163'}    {[163]}    {[3]}    {[0]}    {'163'}
    {'ZAR#166'}    {[166]}    {[4]}    {[0]}    {'166'}
    {'UK_#172'}    {[172]}    {[3]}    {[0]}    {'172'}
    {'JAP#174'}    {[174]}    {[3]}    {[0]}    {'174'}
    {'IZO#185'}    {[185]}    {[3]}    {[0]}    {'185'}
    {'MAD#186'}    {[186]}    {[3]}    {[0]}    {'186'}
    {'CAN#190'}    {[190]}    {[3]}    {[0]}    {'190'}
    {'TAM#201'}    {[201]}    {[3]}    {[0]}    {'201'}
    {'DNK#202'}    {[202]}    {[3]}    {[0]}    {'202'}
    {'DNK#228'}    {[228]}    {[3]}    {[0]}    {'228'}

  Columns 6 through 9

    {'..\005\ICF15117&#8230;'}    {'..\005\ICF17219&#8230;'}    {'1838'}    {'1838'}
    {'..\017\ICF14919&#8230;'}    {'..\017\ICF14919&#8230;'}    {'1680'}    {'1680'}
    {'..\033\ICF15617&#8230;'}    {'..\033\IOS15617&#8230;'}    {'2325'}    {'2325'}
    {'..\070\ICF15617&#8230;'}    {'..\070\IOS15617&#8230;'}    {'1685'}    {'1685'}
    {'..\075\ICF15017&#8230;'}    {'..\075\ICF17819&#8230;'}    {'1714'}    {'1714'}
    {'..\117\ICF15517&#8230;'}    {'..\117\IOS15517&#8230;'}    {'1620'}    {'1620'}
    {'..\126\icf15517&#8230;'}    {'..\126\ICF17419&#8230;'}    {'1710'}    {'1710'}
    {'..\150\ICF15617&#8230;'}    {'..\150\ICF17519&#8230;'}    {'0322'}    {'0315'}
    {'..\151\ICF15317&#8230;'}    {'..\151\IOS15317&#8230;'}    {'1880'}    {'1880'}
    {'..\158\ICF21218&#8230;'}    {'..\158\ICF17519&#8230;'}    {'0558'}    {'0540'}
    {'..\163\ICF21018&#8230;'}    {'..\163\ICF17519&#8230;'}    {'0274'}    {'0274'}
    {'..\166\ICF15217&#8230;'}    {'..\166\ICF17419&#8230;'}    {'1955'}    {'1955'}
    {'..\172\ICF15117&#8230;'}    {'..\172\ICF17819&#8230;'}    {'0444'}    {'0444'}
    {'..\174\ICF20718&#8230;'}    {'..\174\ICF17819&#8230;'}    {'0605'}    {'0605'}
    {'..\185\config18&#8230;'}    {'..\185\config18&#8230;'}    {'0365'}    {'0367'}
    {'..\186\ICF15317&#8230;'}    {'..\186\IOS15317&#8230;'}    {'0315'}    {'0315'}
    {'..\190\ICF11419&#8230;'}    {'..\190\ICF17519&#8230;'}    {'0410'}    {'0410'}
    {'..\201\ICF14315&#8230;'}    {'..\201\ICF17519&#8230;'}    {'0320'}    {'0320'}
    {'..\202\ICF15017&#8230;'}    {'..\202\ICF17519&#8230;'}    {'0270'}    {'0270'}
    {'..\228\ICF15017&#8230;'}    {'..\228\ICF17419&#8230;'}    {'0242'}    {'0242'}

  Column 10

    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}
    {1&times;6 double}

</pre><h2 id="3">READ Brewer Summaries</h2><pre class="codeinput"> <span class="keyword">for</span> i=[Cal.n_ref,Cal.n_inst]
    dsum{i}={};       ozone_raw{i}={};   hg{i}={};
    ozone_sum{i}={};  ozone_raw0{i}={};  bhg{i}={};
    config{i}={};     sl{i}={};          log{i}={};
    ozone_ds{i}={};   sl_cr{i}={};       missing{i}=[];

    [ozone,log_,missing_]=read_bdata(i,Cal);

    dsum{i}=ozone.dsum;
    ozone_sum{i}=ozone.ozone_sum;
    config{i}=ozone.config;
    ozone_ds{i}=ozone.ozone_ds;
    ozone_raw{i}=ozone.raw;
    ozone_raw0{i}=ozone.raw0;
    sl{i}=ozone.sl; <span class="comment">%first calibration/ bfiles</span>
    sl_cr{i}=ozone.sl_cr; <span class="comment">%recalculated with 2? configuration</span>
    hg{i}=ozone.hg;
    bhg{i}=ozone.bhg;
    log{i}=cat(1,log_{:});
    missing{i}=missing_';
    disp(log{i});
 <span class="keyword">end</span>

save(Cal.file_save,<span class="string">'-APPEND'</span>,<span class="string">'ozone_raw'</span>,<span class="string">'dsum'</span>,<span class="string">'ozone_sum'</span>,<span class="string">'ozone_ds'</span>,<span class="string">'config'</span>,<span class="string">'sl'</span>,<span class="string">'sl_cr'</span>,<span class="string">'log'</span>,<span class="string">'missing'</span>);
matrix2latex(log{Cal.n_inst},fullfile(Cal.file_latex,[<span class="string">'tabla_fileprocess_'</span>,Cal.brw_str{Cal.n_inst},<span class="string">'.tex'</span>]));
</pre><pre class="codeoutput">
Brewer: IZO#185
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B16819.185 IZO#185 ozone obs day 168
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B16919.185 IZO#185 ozone obs day 169
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17019.185 IZO#185 ozone obs day 170
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17119.185 IZO#185 ozone obs day 171
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17219.185 IZO#185 ozone obs day 172
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17319.185 IZO#185 ozone obs day 173
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17419.185 IZO#185 ozone obs day 174
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17519.185 IZO#185 ozone obs day 175
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17619.185 IZO#185 ozone obs day 176
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17719.185 IZO#185 ozone obs day 177
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17819.185 IZO#185 ozone obs day 178
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17919.185 IZO#185 ozone obs day 179
  Columns 1 through 6

    'OK '    []    '/Users/aredondas/&#8230;'    'IZO#185'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'IZO#185'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'IZO#185'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'IZO#185'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'IZO#185'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'IZO#185'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'IZO#185'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'IZO#185'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'IZO#185'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'IZO#185'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'IZO#185'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'IZO#185'    ''    '  '

  Columns 7 through 8

    '08-Apr-2019'    '08-Apr-2019'
    '08-Apr-2019'    '08-Apr-2019'
    '08-Apr-2019'    '08-Apr-2019'
    '08-Apr-2019'    '08-Apr-2019'
    '08-Apr-2019'    '08-Apr-2019'
    '08-Apr-2019'    '08-Apr-2019'
    '08-Apr-2019'    '08-Apr-2019'
    '08-Apr-2019'    '08-Apr-2019'
    '08-Apr-2019'    '08-Apr-2019'
    '08-Apr-2019'    '08-Apr-2019'
    '08-Apr-2019'    '08-Apr-2019'
    '08-Apr-2019'    '08-Apr-2019'


Brewer: K&amp;Z#158
Missing   /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B16819.158
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B16919.158 K&amp;Z#158 ozone obs day 169
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17019.158 K&amp;Z#158 ozone obs day 170
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17119.158 K&amp;Z#158 ozone obs day 171
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17219.158 K&amp;Z#158 ozone obs day 172
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17319.158 K&amp;Z#158 ozone obs day 173
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17419.158 K&amp;Z#158 ozone obs day 174
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17519.158 K&amp;Z#158 ozone obs day 175
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17619.158 K&amp;Z#158 ozone obs day 176
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17719.158 K&amp;Z#158 ozone obs day 177
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17819.158 K&amp;Z#158 ozone obs day 178
OK-&gt; /Users/aredondas/CODE/rbcce.aemet.es/campaigns/are2019/bfiles/B17919.158 K&amp;Z#158 ozone obs day 179
  Columns 1 through 6

    'OK '    []    '/Users/aredondas/&#8230;'    'K&amp;Z#158'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'K&amp;Z#158'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'K&amp;Z#158'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'K&amp;Z#158'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'K&amp;Z#158'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'K&amp;Z#158'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'K&amp;Z#158'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'K&amp;Z#158'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'K&amp;Z#158'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'K&amp;Z#158'    ''    '  '
    'OK '    []    '/Users/aredondas/&#8230;'    'K&amp;Z#158'    ''    '  '

  Columns 7 through 8

    '18-Oct-2017'    '18-Oct-2017'
    '18-Oct-2017'    '18-Oct-2017'
    '18-Oct-2017'    '18-Oct-2017'
    '18-Oct-2017'    '18-Oct-2017'
    '18-Oct-2017'    '18-Oct-2017'
    '18-Oct-2017'    '18-Oct-2017'
    '18-Oct-2017'    '18-Oct-2017'
    '18-Oct-2017'    '18-Oct-2017'
    '18-Oct-2017'    '18-Oct-2017'
    '18-Oct-2017'    '18-Oct-2017'
    '18-Oct-2017'    '18-Oct-2017'

</pre><h2 id="4">configuration files</h2><pre class="codeinput">change=write_excel_config(config,Cal,Cal.n_inst);

[config_ref,TCref,DTref,ETCref,A1ref,ATref,leg]  =read_icf(Cal.brw_config_files{Cal.n_ref(1),2});
[config_def,TCdef,DTdef,ETCdef,A1def,ATdef]      =read_icf(Cal.brw_config_files{Cal.n_inst,2});
[config_orig,TCorig,DTorig,ETCorig,A1orig,ATorig]=read_icf(Cal.brw_config_files{Cal.n_inst,1});

latexcmd(fullfile(Cal.file_latex,[<span class="string">'cal_config_'</span>,Cal.brw_str{Cal.n_inst}]),<span class="keyword">...</span>
                     DTref,<span class="string">'\ETCref'</span>,ETCref(1),<span class="string">'\Aref'</span>,A1ref(1),<span class="keyword">...</span>
                     DTdef,<span class="string">'\ETCdef'</span>,ETCdef(1),<span class="string">'\Adef'</span>,A1def(1),<span class="keyword">...</span>
                     DTorig,<span class="string">'\ETCorig'</span>,ETCorig(1),<span class="string">'\Aorig'</span>,A1orig(1));
str_leg={};
 <span class="keyword">for</span> i=1:size(leg,1)
     str_leg{i,1}=leg(i,:);
 <span class="keyword">end</span>
rowlabels=regexprep(str_leg, <span class="string">'#'</span>, <span class="string">'\#'</span>);
[a b c]=fileparts(Cal.brw_config_files{Cal.n_inst,1}); confini=strcat(b,c);
[a b c]=fileparts(Cal.brw_config_files{Cal.n_inst,2}); confend=strcat(b,c);
columnlabels={sprintf(<span class="string">'%s %c%s%c'</span>,<span class="string">'Initial'</span>,<span class="string">'('</span>,confini,<span class="string">')'</span>),<span class="keyword">...</span>
              sprintf(<span class="string">'%s %c%s%c'</span>,<span class="string">'Final'</span>,<span class="string">'('</span>,confend,<span class="string">')'</span>)};
matrix2latex_config([config_orig(2:end),config_def(2:end)],<span class="keyword">...</span>
                     fullfile(Cal.file_latex,[<span class="string">'table_config_'</span>,Cal.brw_str{Cal.n_inst},<span class="string">'.tex'</span>]),<span class="keyword">...</span>
                                              <span class="string">'rowlabels'</span>,rowlabels(2:end),<span class="string">'columnlabels'</span>,columnlabels,<span class="keyword">...</span>
                                              <span class="string">'size'</span>,<span class="string">'footnotesize'</span>);
</pre><pre class="codeoutput">Day 172 (21-Jun-2019, K&amp;Z#158): O3 on SO2 Ratio


Day 172 (21-Jun-2019, K&amp;Z#158): O3 on SO2 Ratio

Day 174 (23-Jun-2019, K&amp;Z#158): O3 on SO2 Ratio


Day 172 (21-Jun-2019, K&amp;Z#158): O3 on SO2 Ratio

Day 174 (23-Jun-2019, K&amp;Z#158): O3 on SO2 Ratio

Day 179 (28-Jun-2019, K&amp;Z#158): n2 Temp coef hg


</pre><pre class="codeinput"> makeHtml_Table([config_orig,config_def],[],cellstr(leg),[Cal.brw_config_files(Cal.n_inst,1),Cal.brw_config_files(Cal.n_inst,2)])
</pre><pre class="codeoutput">varname error

ans =

  52&times;2 table

                               M1            M2    
                           __________    __________

    ReleaseDate            7.3699e+05    7.3699e+05
    o3TempCoef1                     0             0
    o3TempCoef2                  -0.1         -0.43
    o3TempCoef3                  -0.3         -1.04
    o3TempCoef4                  -0.8         -1.95
    o3TempCoef5                  -1.3         -2.48
    MicrometerSteps_deg             0             0
    O3OnO3Ratio                0.3414        0.3435
    SO2OnSO2Ratio                2.35          2.35
    O3OnSO2Ratio               1.1636        1.1636
    ETCOnO3Ratio                 1820          1780
    ETCOnSO2Ratio                 332           332
    DeadTime_sec_             2.8e-08         3e-08
    WLCalStepNumber              1015          1015
    SlitmaskMotorDelay             14            14
    UmkehrOffset                 2463          2463
    NDFilter0                       0             0
    NDFilter1                    4385          4385
    NDFilter2                    9358          9358
    NDFilter3                   13754         13754
    NDFilter4                   21466         21466
    NDFilter5                   25162         25162
    ZenithSteps_rev              2972          2972
    BrewerType                      3             3
    COMPort_                        1             1
    o3TempCoefHg                    0             0
    n2TempCoefHg                    0             0
    n2TempCoef1                     0             0
    n2TempCoef2                     0             0
    n2TempCoef3                     0             0
    n2TempCoef4                     0             0
    n2TempCoef5                     0             0
    O3Mic_1Offset                   0             0
    Mic_2Offset                     0             0
    O3FW_3Offset                  178           178
    NO2AbsnCoeff                   -3            -3
    NO2DsEtc                      770           770
    NO2ZsEtc                      740           740
    NO2Mic_1Offset               8028          8028
    NO2FW_3Offset                 178           178
    NO2_O3ModeChange             2497          2497
    GratingSlope               0.9989        0.9989
    GratingIntercept           -13.86        -13.86
    MicrometerZero               1738          1738
    IrisOpenSteps                 250           250
    BufferDelay_s_                  0             0
    NO2FW_1Pos                      0             0
    O3FW_1Pos                     256           256
    FW_2Pos                         0             0
    uvFW_2Pos                       0             0
    ZenithOffset                    0             0
    ZenithUVBPosition               0             0

</pre><h2 id="6">DT analysis_</h2><pre class="codeinput"> DT_analysis(Cal,ozone_raw0,config,<span class="string">'plot_flag'</span>,0);

<span class="comment">%</span>
<span class="comment">%figure(findobj('tag','DT_comp'));</span>
<span class="comment">%set(get(gca,'title'),'FontSize',8);</span>
<span class="comment">%printfiles_report(gcf,Cal.dir_figs,'LockAxes',0,'Height',6);</span>

<span class="comment">% figure(findobj('tag','raw_counts_187')); title('Day 18711');</span>
<span class="comment">% set(findobj(gcf,'Tag','legend'),'FontSize',8);</span>
<span class="comment">% printfiles_report(gcf,Cal.dir_figs,'Width',8,'Height',6,'LockAxes',0);</span>
<span class="comment">%</span>
<span class="comment">% figure(findobj('tag','raw_counts_191')); title('Day 19111'); ylabel('');</span>
<span class="comment">% set(findobj(gcf,'Tag','legend'),'FontSize',8);</span>
<span class="comment">% printfiles_report(gcf,Cal.dir_figs,'Width',8,'Height',6,'LockAxes',0);</span>
<span class="comment">%close all</span>
<span class="comment">%</span>
</pre><img vspace="5" hspace="5" src="cal_report_158c_01.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_02.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_03.png" alt=""> <h2 id="7">SL Report</h2><pre class="codeinput">close <span class="string">all</span>;
<span class="keyword">for</span> ii=[Cal.n_ref,Cal.n_inst]
    sl_mov_o{ii}={}; sl_median_o{ii}={}; sl_out_o{ii}={}; R6_o{ii}={};
    sl_mov_n{ii}={}; sl_median_n{ii}={}; sl_out_n{ii}={}; R6_n{ii}={};
    <span class="keyword">try</span>
    <span class="keyword">if</span> ii==Cal.n_inst
<span class="comment">% old instrumental constants</span>
      [sl_mov_o{ii},sl_median_o{ii},sl_out_o{ii},R6_o{ii}]=sl_report_jday(ii,sl,Cal.brw_str,<span class="keyword">...</span>
                               <span class="string">'date_range'</span>,datenum(Cal.Date.cal_year,1,Cal.calibration_days{Cal.n_inst,1}([1 end])),<span class="keyword">...</span>
                               <span class="string">'outlier_flag'</span>,0,<span class="string">'hgflag'</span>,1,<span class="string">'fplot'</span>,1);
      fprintf(<span class="string">'%s Old constants: %5.0f +/-%5.1f\n'</span>,Cal.brw_name{ii},<span class="keyword">...</span>
                  nanmedian(R6_o{ii}(diajul(R6_o{ii}(:,1))&gt;=Cal.calibration_days{ii,2}(1),2)),<span class="keyword">...</span>
                  nanstd(   R6_o{ii}(diajul(R6_o{ii}(:,1))&gt;=Cal.calibration_days{ii,2}(1),2)));
<span class="comment">% new instrumental constants</span>
      [sl_mov_n{ii},sl_median_n{ii},sl_out_n{ii},R6_n{ii}]=sl_report_jday(ii,sl_cr,Cal.brw_str,<span class="keyword">...</span>
                               <span class="string">'date_range'</span>,datenum(Cal.Date.cal_year,1,Cal.calibration_days{Cal.n_inst,1}([1 end])),<span class="keyword">...</span>
                               <span class="string">'outlier_flag'</span>,0,<span class="string">'hgflag'</span>,1,<span class="string">'fplot'</span>,1);
      fprintf(<span class="string">'%s New constants: %5.0f +/-%5.1f\n'</span>,Cal.brw_name{ii},<span class="keyword">...</span>
                  nanmedian(R6_n{ii}(diajul(R6_n{ii}(:,1))&gt;=Cal.calibration_days{ii,3}(1),2)),<span class="keyword">...</span>
                  nanstd(   R6_n{ii}(diajul(R6_n{ii}(:,1))&gt;=Cal.calibration_days{ii,3}(1),2)));
    <span class="keyword">else</span>

      [sl_mov_o{ii},sl_median_o{ii},sl_out_o{ii},R6_o{ii}]=sl_report_jday(ii,sl,Cal.brw_str,<span class="keyword">...</span>
                               <span class="string">'date_range'</span>,datenum(Cal.Date.cal_year,1,Cal.calibration_days{Cal.n_ref,1}([1 end])),<span class="keyword">...</span>
                               <span class="string">'outlier_flag'</span>,0,<span class="string">'fplot'</span>,0);

      [sl_mov_n{ii},sl_median_n{ii},sl_out_n{ii},R6_n{ii}]=sl_report_jday(ii,sl_cr,Cal.brw_str,<span class="keyword">...</span>
                               <span class="string">'date_range'</span>,datenum(Cal.Date.cal_year,1,Cal.calibration_days{Cal.n_ref,1}([1 end])),<span class="keyword">...</span>
                               <span class="string">'outlier_flag'</span>,0,<span class="string">'fplot'</span>,0);

    <span class="keyword">end</span>
    <span class="keyword">catch</span> exception
          fprintf(<span class="string">'%s, brewer: %s\n'</span>,exception.message,Cal.brw_str{ii});
    <span class="keyword">end</span>
<span class="keyword">end</span>
<span class="comment">% anadimos el sl</span>
save(Cal.file_save,<span class="string">'-APPEND'</span>,<span class="string">'sl_mov_o'</span>,<span class="string">'sl_median_o'</span>,<span class="string">'sl_out_o'</span>,<span class="string">'R6_o'</span>,<span class="keyword">...</span>
                             <span class="string">'sl_mov_n'</span>,<span class="string">'sl_median_n'</span>,<span class="string">'sl_out_n'</span>,<span class="string">'R6_n'</span>);

sl_report{Cal.n_inst}.sl_mov_n=sl_mov_n{Cal.n_inst};         sl_report{Cal.n_inst}.sl_mov_o=sl_mov_o{Cal.n_inst};
sl_report{Cal.n_inst}.sl_median_n=sl_median_n{Cal.n_inst};   sl_report{Cal.n_inst}.sl_median_o=sl_median_o{Cal.n_inst};
sl_report{Cal.n_inst}.sl_out_n=sl_out_n{Cal.n_inst};         sl_report{Cal.n_inst}.sl_out_o=sl_out_o{Cal.n_inst};
sl_report{Cal.n_inst}.R6_n{Cal.n_inst}=R6_n{Cal.n_inst};     sl_report{Cal.n_inst}.R6_o{Cal.n_inst}=R6_o{Cal.n_inst};
save(Cal.file_save,<span class="string">'-APPEND'</span>,<span class="string">'sl_report'</span>);
</pre><pre class="codeoutput">K&amp;Z#158 Old constants:   558 +/-  3.9
K&amp;Z#158 New constants:   543 +/-  1.9
</pre><img vspace="5" hspace="5" src="cal_report_158c_04.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_05.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_06.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_07.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_08.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_09.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_10.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_11.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_12.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_13.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_14.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_15.png" alt=""> <h2 id="8">SL report plot</h2><pre class="codeinput">ix=sort(findobj(<span class="string">'-regexp'</span>,<span class="string">'Tag'</span>,<span class="string">'SL_R\w+'</span>));
<span class="keyword">if</span> length(ix)&gt;2
   <span class="keyword">for</span> i=ix, set( findobj(i,<span class="string">'Tag'</span>,<span class="string">'legend'</span>),<span class="string">'FontSize'</span>,8); <span class="keyword">end</span>
   set(ix(1),<span class="string">'tag'</span>,<span class="string">'SL_R6_report_old'</span>); set(ix(2),<span class="string">'tag'</span>,<span class="string">'SL_R5_report_old'</span>);
   Width=8; Height=6;
<span class="keyword">else</span>
   Width=14; Height=6.5;
<span class="keyword">end</span>
printfiles_report(ix',Cal.dir_figs,<span class="string">'Width'</span>,Width,<span class="string">'Height'</span>,Height);

figure(maxf(findobj(<span class="string">'tag'</span>,<span class="string">'SL_I5_report'</span>)));
printfiles_report(gcf,Cal.dir_figs,<span class="string">'LockAxes'</span>,0,<span class="string">'no_export'</span>);

close <span class="string">all</span>
</pre><h2 id="9">Hg Report</h2><p>Hg failure</p><pre class="codeinput">hg_fail=read_custom(fullfile(Cal.path_root,sprintf(<span class="string">'bdata%s'</span>,Cal.brw_str{Cal.n_inst})),sprintf(<span class="string">'B*.%s'</span>,Cal.brw_str{Cal.n_inst}),<span class="keyword">...</span>
                              <span class="string">'hg: lamp not detected'</span>,<span class="string">'printfile'</span>,0,<span class="keyword">...</span>
                              <span class="string">'date_range'</span>,datenum(Cal.Date.cal_year,1,1));
<span class="keyword">if</span> ~isempty(hg_fail)
    [mean_hg_fail N_hg_fail] = grpstats(fix(hg_fail),fix(hg_fail),{<span class="string">'nanmean'</span>,<span class="string">'numel'</span>});
    displaytable( N_hg_fail,{<span class="string">'N(Hg failure)'</span>},13,<span class="string">'d'</span>,cellstr(datestr(mean_hg_fail(:,1),1)))
<span class="keyword">else</span>
    fprintf(<span class="string">'Ho Hg failures recorded for Brewer %s\r\n'</span>,Cal.brw_name{Cal.n_inst});
<span class="keyword">end</span>
<span class="comment">% Hg during campaign</span>
hg_report(Cal.n_inst,hg,Cal,<span class="string">'outlier_flag'</span>,1,<span class="string">'date_range'</span>,[]);
</pre><pre class="codeoutput">Ho Hg failures recorded for Brewer K&amp;Z#158
</pre><img vspace="5" hspace="5" src="cal_report_158c_16.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_17.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_18.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_19.png" alt=""> <h2 id="10">READ Configuration</h2><pre class="codeinput">close <span class="string">all</span>
[A,ETC,SL_B,SL_R,F_corr,cfg]=read_cal_config_new(config,Cal,{sl_median_o,sl_median_n});

<span class="keyword">try</span>
 tabla_sl=printmatrix([Cal.brw(:)';ETC.old;ETC.new;A.old;A.new;Cal.SL_OLD_REF';Cal.SL_NEW_REF';fix(SL_B)']',4);
 cell2csv(fullfile(Cal.file_latex,<span class="string">'tabla_config.csv'</span>),tabla_sl',<span class="string">';'</span>);
<span class="keyword">catch</span>
  l=lasterror;
  disp(l.message)
  disp(<span class="string">'tabla de configuracion posiblemente incompleta'</span>)
<span class="keyword">end</span>
</pre><pre class="codeoutput">Index in position 1 is invalid. Array indices must be positive integers or logical values. File: read_cal_config_new, line: 99, brewer: al_report_158c
instrumentAndRun File: evalmxdom, line: 112, brewer: ublish
: File: &deg;, line: 115, brewer:  
  File: TSK#005, line: No data. Continue
Index in position 1 is invalid. Array indices must be positive integers or logical values. File: read_cal_config_new, line: 99, brewer: al_report_158c
instrumentAndRun File: evalmxdom, line: 112, brewer: ublish
: File: &deg;, line: 115, brewer:  
  File: IOS#017, line: No data. Continue
Index in position 1 is invalid. Array indices must be positive integers or logical values. File: read_cal_config_new, line: 99, brewer: al_report_158c
instrumentAndRun File: evalmxdom, line: 112, brewer: ublish
: File: &deg;, line: 115, brewer:  
  File: SCO#033, line: No data. Continue
Index in position 1 is invalid. Array indices must be positive integers or logical values. File: read_cal_config_new, line: 99, brewer: al_report_158c
instrumentAndRun File: evalmxdom, line: 112, brewer: ublish
: File: &deg;, line: 115, brewer:  
  File: MAD#070, line: No data. Continue
Index in position 1 is invalid. Array indices must be positive integers or logical values. File: read_cal_config_new, line: 99, brewer: al_report_158c
instrumentAndRun File: evalmxdom, line: 112, brewer: ublish
: File: &deg;, line: 115, brewer:  
  File: UK_#075, line: No data. Continue
Index in position 1 is invalid. Array indices must be positive integers or logical values. File: read_cal_config_new, line: 99, brewer: al_report_158c
instrumentAndRun File: evalmxdom, line: 112, brewer: ublish
: File: &deg;, line: 115, brewer:  
  File: MUR#117, line: No data. Continue
Index in position 1 is invalid. Array indices must be positive integers or logical values. File: read_cal_config_new, line: 99, brewer: al_report_158c
instrumentAndRun File: evalmxdom, line: 112, brewer: ublish
: File: &deg;, line: 115, brewer:  
  File: UK_#126, line: No data. Continue
Brewer ARE#150:  1&ordf; config -&gt; ICF15617.150			2&ordf; config -&gt; ICF17519.150
ARE#150: sl_median_OLD y sl_median_NEW no tienen igual longitud?
		 Check sl_report_jday inputs !!
File: read_cal_config_new, line: 99
al_report_158c: sl_median_OLD y sl_median_NEW no tienen igual longitud?
		 Check sl_report_jday inputs !!
File: instrumentAndRun, line: 101
valmxdom: sl_median_OLD y sl_median_NEW no tienen igual longitud?
		 Check sl_report_jday inputs !!
File: publish, line: 214
&deg;: sl_median_OLD y sl_median_NEW no tienen igual longitud?
		 Check sl_report_jday inputs !!
File: s, line: 21
 : sl_median_OLD y sl_median_NEW no tienen igual longitud?
		 Check sl_report_jday inputs !!
File: Index in position 1 is invalid. Array indices must be positive integers or logical values. File: read_cal_config_new, line: 99, brewer: al_report_158c
instrumentAndRun File: evalmxdom, line: 112, brewer: ublish
: File: &deg;, line: 115, brewer:  
  File: COR#151, line: No data. Continue
Brewer K&amp;Z#158:  1&ordf; config -&gt; ICF21218.158			2&ordf; config -&gt; ICF17519.158
Brewer WRC#163:  1&ordf; config -&gt; ICF21018.163			2&ordf; config -&gt; ICF17519.163
WRC#163: est&aacute;s corrigiendo SIEMPRE con las R6 -&gt; 2&ordm; config
Index in position 1 is invalid. Array indices must be positive integers or logical values. File: read_cal_config_new, line: 99, brewer: al_report_158c
instrumentAndRun File: evalmxdom, line: 112, brewer: ublish
: File: &deg;, line: 115, brewer:  
  File: ZAR#166, line: No data. Continue
Index in position 1 is invalid. Array indices must be positive integers or logical values. File: read_cal_config_new, line: 99, brewer: al_report_158c
instrumentAndRun File: evalmxdom, line: 112, brewer: ublish
: File: &deg;, line: 115, brewer:  
  File: UK_#172, line: No data. Continue
Index in position 1 is invalid. Array indices must be positive integers or logical values. File: read_cal_config_new, line: 99, brewer: al_report_158c
instrumentAndRun File: evalmxdom, line: 112, brewer: ublish
: File: &deg;, line: 115, brewer:  
  File: JAP#174, line: No data. Continue
Brewer IZO#185:  1&ordf; config -&gt; CONFIG185.CFG			(warning NaN replaced by 0 in 1 config)2&ordf; config -&gt; CONFIG185.CFG
(warning NaN replaced by 0 in 2 config)Index exceeds array bounds. File: read_cal_config_new, line: 99, brewer: al_report_158c
instrumentAndRun File: evalmxdom, line: 112, brewer: ublish
9 File: &deg;, line: 115, brewer:  
  File: MAD#186, line: No data. Continue
Index exceeds array bounds. File: read_cal_config_new, line: 99, brewer: al_report_158c
instrumentAndRun File: evalmxdom, line: 112, brewer: ublish
9 File: &deg;, line: 115, brewer:  
  File: CAN#190, line: No data. Continue
Index exceeds array bounds. File: read_cal_config_new, line: 99, brewer: al_report_158c
instrumentAndRun File: evalmxdom, line: 112, brewer: ublish
9 File: &deg;, line: 115, brewer:  
  File: TAM#201, line: No data. Continue
Index exceeds array bounds. File: read_cal_config_new, line: 99, brewer: al_report_158c
instrumentAndRun File: evalmxdom, line: 112, brewer: ublish
9 File: &deg;, line: 115, brewer:  
  File: DNK#202, line: No data. Continue
Index exceeds array bounds. File: read_cal_config_new, line: 99, brewer: al_report_158c
instrumentAndRun File: evalmxdom, line: 112, brewer: ublish
9 File: &deg;, line: 115, brewer:  
  File: DNK#228, line: No data. Continue
Undefined function 'fix' for input arguments of type 'struct'.
tabla de configuracion posiblemente incompleta
</pre><h2 id="11">Data recalculation for summaries  and individual observations</h2><pre class="codeinput"><span class="keyword">for</span> i=[Cal.n_inst Cal.n_ref]
    cal{i}={}; summary{i}={}; summary_old{i}={};
    <span class="keyword">if</span> i==Cal.n_inst
    [cal{i},summary{i},summary_old{i}]=test_recalculation(Cal,i,ozone_ds,A,SL_R,SL_B,<span class="string">'flag_sl'</span>,1,<span class="string">'hg_dep'</span>,1);
    <span class="keyword">else</span>
    [cal{i},summary{i},summary_old{i}]=test_recalculation(Cal,i,ozone_ds,A,SL_R,SL_B,<span class="string">'flag_sl'</span>,1);
    <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="comment">% outlier</span>
<span class="comment">% id_out=find(summary{Cal.n_inst}(:,6)&gt;400 | summary{Cal.n_inst}(:,6)&lt;200);</span>
<span class="comment">% disp(unique(diaj(summary{Cal.n_inst}(id_out,1))));</span>
<span class="comment">%</span>
<span class="comment">% id_out=find(isoutlier(summary{Cal.n_inst}(:,6)))</span>
<span class="comment">% disp(unique(diaj(summary{Cal.n_inst}(id_out,1))));</span>
<span class="comment">%</span>
<span class="comment">% summary{Cal.n_inst}(id_out,:)=[];</span>
<span class="comment">% summary_old{Cal.n_inst}(id_out,:)=[];</span>



summary_orig=summary; summary_orig_old=summary_old;
save(Cal.file_save,<span class="string">'-APPEND'</span>,<span class="string">'summary_old'</span>,<span class="string">'summary_orig_old'</span>,<span class="string">'summary'</span>,<span class="string">'summary_orig'</span>);
</pre><h2 id="12">Filter distribution</h2><pre class="codeinput">close <span class="string">all</span>
ozone_filter_analysis_mi(summary,Cal);
</pre><pre class="codeoutput">
    'F#0 &lt;-&gt; F#1'    'F#1 &lt;-&gt; F#2'    'F#2 &lt;-&gt; F#3'    'F#3 &lt;-&gt; F#4'
    [          3]    [          3]    [          5]    [          0]


</pre><img vspace="5" hspace="5" src="cal_report_158c_20.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_21.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_22.png" alt=""> <pre class="codeinput">printfiles_report(findobj(<span class="string">'Tag'</span>,<span class="string">'FILTER_DISTRIBUTION'</span>),Cal.dir_figs,<span class="string">'Width'</span>,13,<span class="string">'Height'</span>,7.5);
printfiles_report(findobj(<span class="string">'Tag'</span>,<span class="string">'Ozone_diff_filter_rel'</span>),Cal.dir_figs,<span class="string">'Width'</span>,13,<span class="string">'Height'</span>,7.5);

close <span class="string">all</span>
</pre><h2 id="14">filter correction</h2><p>Si queremos eliminar algun filtro CORREGIR a NaN</p><pre class="codeinput"><span class="comment">%F_corr{Cal.n_inst}=[0,0,0,-13,0,0]</span>

<span class="keyword">for</span> ii=[Cal.n_ref Cal.n_inst]
   [summary_old_corr summary_corr]=filter_corr(summary_orig,summary_orig_old,ii,A,F_corr{ii});
   summary_old{ii}=summary_old_corr; summary{ii}=summary_corr;
<span class="keyword">end</span>
figure; plot(summary{Cal.n_inst}(:,1),summary{Cal.n_inst}(:,6),<span class="string">'r.'</span>,<span class="keyword">...</span>
             summary{Cal.n_ref(1)}(:,1),summary{Cal.n_ref(1)}(:,6),<span class="string">'k.'</span>);<span class="comment">%,...</span>
<span class="comment">%             summary{Cal.n_ref(2)}(:,1),summary{Cal.n_ref(2)}(:,6),'m.');</span>
legend(gca,<span class="string">'inst'</span>,<span class="string">'IZO#185'</span>,<span class="string">'Location'</span>,<span class="string">'NorthEast'</span>); grid;
datetick(<span class="string">'x'</span>,26,<span class="string">'KeepLimits'</span>,<span class="string">'KeepTicks'</span>);
ozone_filter_analysis_mi(summary,Cal);
</pre><pre class="codeoutput">
    'F#0 &lt;-&gt; F#1'    'F#1 &lt;-&gt; F#2'    'F#2 &lt;-&gt; F#3'    'F#3 &lt;-&gt; F#4'
    [          3]    [          3]    [          5]    [          0]


</pre><img vspace="5" hspace="5" src="cal_report_158c_23.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_24.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_25.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_26.png" alt=""> <h2 id="15">Ozone Calibration</h2><p>Reference Brewer #185</p><pre class="codeinput">close <span class="string">all</span>
n_ref=Cal.n_ref; <span class="comment">% Cuidado con cual referencia estamos asignando</span>
n_inst=Cal.n_inst;
brw=Cal.brw; brw_str=Cal.brw_str;

jday_ref=findm((diaj(summary{n_ref}(:,1))),Cal.calibration_days{n_inst,1},0.5);
ref=summary{n_ref}(jday_ref,:);
</pre><h2 id="16">Change? No change</h2><pre class="codeinput"> alldays=Cal.calibration_days{Cal.n_inst,1};

 jday=findm(diaj(summary_orig_old{Cal.n_inst}(:,1)),alldays,0.5);<span class="comment">% quiero mostrar la primera config. con sl</span>
 inst1=summary_orig_old{Cal.n_inst}(jday,:);

    [x,r,rp,ra,dat,ox,osc_smooth_ini]=ratio_min_ozone(<span class="keyword">...</span>
       inst1(:,[1,6,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),<span class="keyword">...</span>
       5,brw_str{n_inst},brw_str{n_ref},<span class="string">'plot_flag'</span>,0);<span class="comment">% original config</span>
</pre><pre class="codeoutput">Por defecto, LIM=2.5 (en boxparams)
    1.0134
   -0.4959
    0.8956
    0.9862
   -9.2669
    1.0406
    8.2751

--------- Validation OK --------------
List of arguments given default values:
   'OSC_lim'    defaults to 250  1900
--------------------------------------
</pre><img vspace="5" hspace="5" src="cal_report_158c_27.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_28.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_29.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_30.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_31.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_32.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_33.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_34.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_35.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_36.png" alt=""> <h2 id="17">Blind Period</h2><p>etiquetamos con _b, porque eso sera lo que usamos para plotear los individu~ales, con la configuraci?n sugerida</p><pre class="codeinput">close <span class="string">all</span>
blinddays=Cal.calibration_days{Cal.n_inst,2};

jday=findm(diaj(summary_orig_old{Cal.n_inst}(:,1)),blinddays,0.5);
inst1_b=summary_orig_old{Cal.n_inst}(jday,:); <span class="comment">% no filter correction</span>
<span class="comment">%inst1_b=summary_old{Cal.n_inst}(jday,:);~</span>
<span class="comment">% nan en blind days</span>

<span class="keyword">if</span> ~Cal.no_maint(Cal.n_inst)     <span class="comment">% if the instrument has changed due to maintenance</span>
</pre><pre class="codeinput">    [x,r,rp,ra,dat,ox,osc_smooth_ini]=ratio_min_ozone(<span class="keyword">...</span>
        inst1_b(:,[1,6,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),<span class="keyword">...</span>
        5,brw_str{n_inst},brw_str{n_inst},<span class="string">'plot_flag'</span>,0);<span class="comment">% original config</span>

    <span class="comment">% remove outliers</span>
    jout=find(isoutlier(r(:,2),<span class="string">'gesd'</span> ))
    jout=find(ismember(fix(summary_orig_old{Cal.n_inst}(:,1)*10000),fix(r(jout,1)*10000)))
    summary_orig_old{Cal.n_inst}(jout,:)=[];
    <span class="comment">% ojo revisar los NaN</span>
    <span class="comment">%summary_old{Cal.n_inst}(any(isnan( summary_old{Cal.n_inst})')',:)=[];</span>



    jday=findm(diaj(summary_orig_old{Cal.n_inst}(:,1)),blinddays,0.5);
    inst1_b=summary_orig_old{Cal.n_inst}(jday,:);

      [x,r,rp,ra,dat,ox,osc_smooth_inisl]=ratio_min_ozone(<span class="keyword">...</span>
        inst1_b(:,[1,12,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),<span class="keyword">...</span>
        5,brw_str{n_inst},brw_str{n_ref},<span class="string">'plot_flag'</span>,0);<span class="comment">% original config , sl corrected</span>
     [x,r,rp,ra,dat,ox,osc_smooth_ini]=ratio_min_ozone(<span class="keyword">...</span>
        inst1_b(:,[1,6,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),<span class="keyword">...</span>
        5,brw_str{n_inst},brw_str{n_ref},<span class="string">'plot_flag'</span>,0);<span class="comment">% original config</span>
</pre><pre class="codeoutput">Por defecto, LIM=2.5 (en boxparams)
--------- Validation OK --------------
List of arguments given default values:
   'OSC_lim'    defaults to 250  1900
--------------------------------------

jout =

  0&times;1 empty double column vector


jout =

  0&times;1 empty double column vector

Por defecto, LIM=2.5 (en boxparams)
    1.1630
  -50.1904
    0.8318
    1.1013
  -70.6737
    1.2248
  -29.7070

--------- Validation OK --------------
List of arguments given default values:
   'OSC_lim'    defaults to 250  1900
--------------------------------------
Por defecto, LIM=2.5 (en boxparams)
    1.1155
  -34.7353
    0.8380
    1.0576
  -53.9595
    1.1734
  -15.5111

--------- Validation OK --------------
List of arguments given default values:
   'OSC_lim'    defaults to 250  1900
--------------------------------------
</pre><img vspace="5" hspace="5" src="cal_report_158c_37.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_38.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_39.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_40.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_41.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_42.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_43.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_44.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_45.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_46.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_47.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_48.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_49.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_50.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_51.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_52.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_53.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_54.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_55.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_56.png" alt=""> <h2 id="19">Sugerido con los blind_days</h2><pre class="codeinput">    A1=A.old(ismember(Cal.Date.CALC_DAYS,blinddays),Cal.n_inst+1);
    A1_old=unique(A1(~isnan(A1)))
    osc_range=0.7
    <span class="comment">%A1_old=0.3390</span>
    [ETC_SUG,o3c_SUG,m_etc_SUG]=ETC_calibration_C(Cal,summary_orig_old,A1_old,<span class="keyword">...</span>
        Cal.n_inst,n_ref,10,osc_range,0.03,blinddays);

    data_tabl=[nanmean(ETC.old(:,n_inst+1)),round([ETC_SUG(1).NEW,ETC_SUG(1).TP(1)]),<span class="keyword">...</span>
        nanmean(A.old(:,n_inst+1)),ETC_SUG(1).TP(2)/10000,A1_old
        <span class="comment">%         solo el rango seleccionado</span>
        nanmean(ETC.old(:,n_inst+1)),round([ETC_SUG(2).NEW,ETC_SUG(2).TP(1)]),<span class="keyword">...</span>
        nanmean(A.old(:,n_inst+1)),ETC_SUG(2).TP(2)/10000,A1_old];
    <span class="comment">%         todo el rango</span>
    displaytable(data_tabl,{<span class="string">'ETCorig'</span>,<span class="string">'ETCnew 1p'</span>,<span class="string">'ETCnew 2p'</span>,<span class="string">'O3Abs (ICF)'</span>,<span class="string">'O3Abs 2p'</span>,<span class="string">'O3Abs sug.'</span>},<span class="keyword">...</span>
        11,{<span class="string">'d'</span>,<span class="string">'d'</span>,<span class="string">'d'</span>,<span class="string">'.4f'</span>,<span class="string">'.4f'</span>,<span class="string">'.4f'</span>},{sprintf(<span class="string">'OSC &lt; %.2f DU'</span>,osc_range),<span class="string">'All OSC range'</span>})

    <span class="comment">% suggested</span>
    o3r= (inst1_b(:,8)-ETC_SUG(1).NEW)./(A1_old*inst1_b(:,3)*10);
    inst1_b(:,10)=o3r;
    [x,r,rp,ra,dat,ox,osc_smooth_sug]=ratio_min_ozone(<span class="keyword">...</span>
        inst1_b(:,[1,10,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),<span class="keyword">...</span>
        5,brw_str{n_inst},brw_str{n_ref},<span class="string">'plot_flag'</span>,0);
    <span class="comment">% si es suficiente la correccion por sl</span>
    <span class="comment">% osc_smooth_sug=osc_smooth_inisl;</span>
</pre><pre class="codeoutput">
A1_old =

    0.3414


osc_range =

    0.7000

              |     ETCorig |   ETCnew 1p |   ETCnew 2p | O3Abs (ICF) |    O3Abs 2p |  O3Abs sug.
OSC &lt; 0.70 DU |        1820 |        1806 |        1801 |      0.3414 |      0.3425 |      0.3414
All OSC range |        1820 |        1805 |        1797 |      0.3414 |      0.3435 |      0.3414
Por defecto, LIM=2.5 (en boxparams)
    1.1007
  -32.9029
    0.9197
    1.0623
  -45.7614
    1.1391
  -20.0443

--------- Validation OK --------------
List of arguments given default values:
   'OSC_lim'    defaults to 250  1900
--------------------------------------
</pre><img vspace="5" hspace="5" src="cal_report_158c_57.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_58.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_59.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_60.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_61.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_62.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_63.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_64.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_65.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_66.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_67.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_68.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_69.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_70.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_71.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_72.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_73.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_74.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_75.png" alt=""> <pre class="codeinput">    figure(sort(findobj(<span class="string">'tag'</span>,<span class="string">'CAL_2P_SCHIST'</span>)));
    ax=findobj(gca,<span class="string">'type'</span>,<span class="string">'text'</span>);
    set(ax(2),<span class="string">'FontSize'</span>,9,<span class="string">'Backgroundcolor'</span>,<span class="string">'w'</span>); set(ax(3),<span class="string">'FontSize'</span>,9,<span class="string">'Backgroundcolor'</span>,<span class="string">'w'</span>);
    printfiles_report(gcf,Cal.dir_figs,<span class="string">'aux_pattern'</span>,{<span class="string">'sug'</span>},<span class="string">'Width'</span>,14,<span class="string">'Height'</span>,8);

    figure; set(gcf,<span class="string">'tag'</span>,<span class="string">'RATIO_ERRORBAR'</span>);
    h=plot_smooth(osc_smooth_ini,osc_smooth_inisl,osc_smooth_sug);
    legend(h,<span class="string">'Config. orig'</span>,<span class="string">'Config. orig, SL corrected'</span>,<span class="string">'Suggested'</span>);
    title([ brw_str{n_inst},<span class="string">' - '</span>,brw_str{n_ref},<span class="string">' / '</span>,brw_str{n_ref}]);
    printfiles_report(gcf,Cal.dir_figs,<span class="string">'aux_pattern'</span>,{<span class="string">'sug'</span>});
</pre><img vspace="5" hspace="5" src="cal_report_158c_76.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_77.png" alt=""> <pre class="codeinput">    close <span class="string">all</span>
</pre><h2 id="22">Blind days table</h2><p>m_etc: [date, ref_new_slcorr, +sd, +n, ...        inst(6), +sd, inst(10), +sd, inst(6 sl corr), +sd, ...        inst(rcalibrated, ETC sug), +sd]</p><p>Si no hay sugerida, sino que es la orig.SL corr., hacer</p><pre class="codeinput">    <span class="comment">%m_etc=[m_etc_SUG(:,1:6),NaN*m_etc_SUG(:,1),m_etc_SUG(:,9:10)];</span>
    m_etc=[m_etc_SUG(:,1:6),NaN*m_etc_SUG(:,1),m_etc_SUG(:,11:12)];
    m_etc(:,7)=100*(m_etc(:,5)-m_etc(:,2))./m_etc(:,2);
    m_etc(:,10)=100*(m_etc(:,8)-m_etc(:,2))./m_etc(:,2);
    M=cell(size(m_etc,1)+1,size(m_etc,2)+1);
    label={<span class="string">'Date'</span>,<span class="string">'Day'</span>,[<span class="string">'O3\#'</span>,brw_str{n_ref}],<span class="string">'O3std'</span>,<span class="string">'N'</span>,<span class="keyword">...</span>
        [<span class="string">'O3\#'</span>,brw_str{n_inst}],<span class="string">'O3 std'</span>,<span class="keyword">...</span>
        [<span class="string">'\%('</span>,brw_str{n_inst},<span class="string">'-'</span>,brw_str{n_ref},<span class="string">')/'</span>,brw_str{n_ref}]<span class="keyword">...</span><span class="comment">% old config</span>
        [<span class="string">'O3(*)\#'</span>,brw_str{n_inst}],<span class="string">'O3std'</span>,<span class="keyword">...</span><span class="comment">% new config., no SL corrected</span>
        [<span class="string">'(*)\%('</span>,brw_str{n_inst},<span class="string">'-'</span>,brw_str{n_ref},<span class="string">')/'</span>,brw_str{n_ref}]};
    M(1,:)=label;
    M(2:end,1)=cellstr(datestr(fix(m_etc(:,1))));
    m_etc(:,1)=diaj(m_etc(:,1));
    M(2:end,2:end)=num2cell(round(m_etc*10)/10);

    disp(M);
    matrix2latex_ctable(M(2:end,2:end),fullfile(Cal.file_latex,[<span class="string">'table_ETCdatasug_'</span>,Cal.brw_str{Cal.n_inst},<span class="string">'.tex'</span>]),<span class="keyword">...</span>
        <span class="string">'rowlabels'</span>,M(2:end,1),<span class="keyword">...</span>
        <span class="string">'columnlabels'</span>,label(2:end),<span class="string">'alignment'</span>,<span class="string">'c'</span>,<span class="string">'resize'</span>,0.9);
    <span class="comment">% Sergio: A&iuml;&iquest;&frac12;adido para los report en latex</span>
<span class="comment">%Info:</span>
    <span class="comment">% m_etc(1,1)=d&iuml;&iquest;&frac12;a inicial que se emplea para la sugerida</span>
    <span class="comment">% m_etc(:,1)=d&iuml;&iquest;&frac12;a final que se emplea para la sugerida</span>
    <span class="comment">% total= n&iuml;&iquest;&frac12;mero total de medidas</span>
    total_sugerida=sum(m_etc(:,4))
latexcmd(fullfile(Cal.file_latex,[<span class="string">'cal_status_'</span>,brw_str{n_inst}]),<span class="string">'\diaSUGstart'</span>,m_etc(1,1),<span class="keyword">...</span>
             <span class="string">'\diaSUGend'</span>,m_etc(end,1),<span class="string">'\totalSUG'</span>,total_sugerida);
</pre><pre class="codeoutput">  Columns 1 through 6

    'Date'           'Day'    'O3\#185'     'O3std'    'N'    'O3\#158' 
    '19-Jun-2019'    [170]    [326.8000]    [    0]    [1]    [323.6000]
    '19-Jun-2019'    [170]    [325.9000]    [    0]    [1]    [321.8000]
    '19-Jun-2019'    [170]    [325.9000]    [    0]    [1]    [321.9000]
    '19-Jun-2019'    [170]    [326.1000]    [    0]    [1]    [322.1000]
    '19-Jun-2019'    [170]    [326.2000]    [    0]    [2]    [321.8000]
    '19-Jun-2019'    [170]    [325.6000]    [    0]    [1]    [322.3000]
    '19-Jun-2019'    [170]    [326.6000]    [    0]    [2]    [320.7000]
    '19-Jun-2019'    [170]    [328.3000]    [    0]    [1]    [323.7000]
    '19-Jun-2019'    [170]    [328.1000]    [    0]    [1]    [324.4000]
    '19-Jun-2019'    [170]    [327.6000]    [    0]    [1]    [325.7000]
    '19-Jun-2019'    [170]    [328.1000]    [    0]    [1]    [321.7000]
    '19-Jun-2019'    [170]    [327.7000]    [    0]    [1]    [323.4000]
    '19-Jun-2019'    [170]    [328.6000]    [    0]    [1]    [324.1000]
    '19-Jun-2019'    [170]    [328.9000]    [    0]    [2]    [     324]
    '19-Jun-2019'    [170]    [     330]    [    0]    [2]    [324.7000]
    '19-Jun-2019'    [170]    [329.4000]    [    0]    [1]    [323.2000]
    '19-Jun-2019'    [170]    [328.7000]    [    0]    [1]    [324.7000]
    '19-Jun-2019'    [170]    [330.7000]    [    0]    [2]    [324.9000]
    '19-Jun-2019'    [170]    [329.4000]    [    0]    [2]    [323.9000]
    '19-Jun-2019'    [170]    [331.2000]    [    0]    [1]    [324.4000]
    '19-Jun-2019'    [170]    [331.5000]    [    0]    [1]    [326.5000]
    '19-Jun-2019'    [170]    [331.3000]    [    0]    [2]    [326.1000]
    '19-Jun-2019'    [170]    [331.9000]    [    0]    [1]    [326.9000]
    '19-Jun-2019'    [170]    [330.8000]    [    0]    [1]    [327.2000]
    '19-Jun-2019'    [170]    [     332]    [    0]    [1]    [325.7000]
    '19-Jun-2019'    [170]    [331.6000]    [    0]    [1]    [326.9000]
    '19-Jun-2019'    [170]    [333.2000]    [    0]    [2]    [325.9000]
    '19-Jun-2019'    [170]    [332.2000]    [    0]    [1]    [326.3000]
    '19-Jun-2019'    [170]    [333.8000]    [    0]    [1]    [327.9000]
    '19-Jun-2019'    [170]    [332.8000]    [    0]    [1]    [328.9000]
    '19-Jun-2019'    [170]    [332.8000]    [    0]    [1]    [328.7000]
    '19-Jun-2019'    [170]    [333.1000]    [    0]    [1]    [329.5000]
    '19-Jun-2019'    [170]    [334.5000]    [    0]    [2]    [328.8000]
    '19-Jun-2019'    [170]    [334.1000]    [    0]    [3]    [329.1000]
    '19-Jun-2019'    [170]    [333.2000]    [    0]    [1]    [328.3000]
    '19-Jun-2019'    [170]    [331.8000]    [    0]    [1]    [328.5000]
    '19-Jun-2019'    [170]    [333.2000]    [    0]    [1]    [327.4000]
    '19-Jun-2019'    [170]    [330.1000]    [    0]    [1]    [327.7000]
    '20-Jun-2019'    [171]    [327.5000]    [    0]    [1]    [326.8000]
    '20-Jun-2019'    [171]    [327.8000]    [    0]    [1]    [325.7000]
    '20-Jun-2019'    [171]    [328.9000]    [    0]    [2]    [327.1000]
    '20-Jun-2019'    [171]    [328.6000]    [    0]    [1]    [326.2000]
    '20-Jun-2019'    [171]    [329.3000]    [    0]    [1]    [326.1000]
    '20-Jun-2019'    [171]    [331.9000]    [    0]    [1]    [     327]
    '20-Jun-2019'    [171]    [331.9000]    [    0]    [1]    [329.7000]
    '20-Jun-2019'    [171]    [333.7000]    [    0]    [2]    [329.2000]
    '20-Jun-2019'    [171]    [     334]    [    0]    [1]    [329.2000]
    '20-Jun-2019'    [171]    [342.7000]    [    0]    [3]    [337.6000]
    '20-Jun-2019'    [171]    [343.8000]    [    0]    [2]    [337.7000]
    '20-Jun-2019'    [171]    [343.7000]    [    0]    [1]    [337.8000]
    '20-Jun-2019'    [171]    [344.5000]    [    0]    [1]    [338.7000]
    '20-Jun-2019'    [171]    [342.6000]    [    0]    [1]    [336.8000]
    '20-Jun-2019'    [171]    [342.2000]    [    0]    [2]    [336.9000]
    '20-Jun-2019'    [171]    [342.6000]    [    0]    [1]    [338.4000]
    '20-Jun-2019'    [171]    [341.2000]    [    0]    [1]    [335.6000]
    '20-Jun-2019'    [171]    [342.5000]    [    0]    [1]    [335.9000]
    '20-Jun-2019'    [171]    [342.6000]    [    0]    [1]    [337.3000]
    '20-Jun-2019'    [171]    [340.2000]    [    0]    [1]    [332.5000]
    '20-Jun-2019'    [171]    [339.3000]    [    0]    [1]    [335.6000]
    '20-Jun-2019'    [171]    [338.4000]    [    0]    [1]    [336.8000]
    '20-Jun-2019'    [171]    [338.9000]    [    0]    [1]    [334.2000]
    '20-Jun-2019'    [171]    [339.9000]    [    0]    [1]    [339.3000]
    '20-Jun-2019'    [171]    [338.7000]    [    0]    [1]    [338.1000]
    '21-Jun-2019'    [172]    [336.1000]    [    0]    [1]    [335.7000]
    '21-Jun-2019'    [172]    [337.1000]    [    0]    [2]    [335.3000]
    '21-Jun-2019'    [172]    [338.9000]    [    0]    [1]    [     335]
    '21-Jun-2019'    [172]    [339.6000]    [    0]    [1]    [336.1000]
    '21-Jun-2019'    [172]    [339.7000]    [    0]    [1]    [336.1000]
    '21-Jun-2019'    [172]    [339.8000]    [    0]    [1]    [336.4000]
    '21-Jun-2019'    [172]    [     340]    [    0]    [1]    [     336]
    '21-Jun-2019'    [172]    [340.4000]    [    0]    [1]    [336.5000]
    '21-Jun-2019'    [172]    [340.7000]    [    0]    [2]    [     338]
    '21-Jun-2019'    [172]    [     340]    [    0]    [4]    [337.2000]
    '21-Jun-2019'    [172]    [342.5000]    [    0]    [1]    [338.5000]
    '21-Jun-2019'    [172]    [342.6000]    [    0]    [1]    [338.2000]
    '21-Jun-2019'    [172]    [341.8000]    [    0]    [1]    [339.5000]
    '21-Jun-2019'    [172]    [343.1000]    [    0]    [1]    [338.9000]
    '21-Jun-2019'    [172]    [344.4000]    [    0]    [1]    [339.7000]
    '21-Jun-2019'    [172]    [     343]    [    0]    [1]    [340.3000]
    '21-Jun-2019'    [172]    [343.5000]    [    0]    [1]    [338.9000]
    '21-Jun-2019'    [172]    [343.1000]    [    0]    [2]    [340.3000]
    '21-Jun-2019'    [172]    [345.8000]    [    0]    [4]    [341.5000]
    '21-Jun-2019'    [172]    [346.6000]    [    0]    [1]    [341.4000]
    '21-Jun-2019'    [172]    [346.6000]    [    0]    [2]    [342.7000]
    '21-Jun-2019'    [172]    [346.8000]    [    0]    [1]    [342.3000]
    '21-Jun-2019'    [172]    [345.1000]    [    0]    [1]    [343.6000]
    '21-Jun-2019'    [172]    [345.5000]    [    0]    [1]    [340.1000]
    '21-Jun-2019'    [172]    [     345]    [    0]    [1]    [     342]
    '21-Jun-2019'    [172]    [345.9000]    [    0]    [1]    [341.6000]
    '21-Jun-2019'    [172]    [346.3000]    [    0]    [1]    [342.8000]
    '21-Jun-2019'    [172]    [345.4000]    [    0]    [1]    [     342]
    '21-Jun-2019'    [172]    [345.9000]    [    0]    [2]    [342.1000]
    '21-Jun-2019'    [172]    [345.9000]    [    0]    [3]    [342.7000]
    '21-Jun-2019'    [172]    [346.1000]    [    0]    [1]    [341.5000]
    '21-Jun-2019'    [172]    [346.9000]    [    0]    [1]    [340.2000]
    '21-Jun-2019'    [172]    [344.6000]    [    0]    [1]    [339.4000]
    '21-Jun-2019'    [172]    [345.5000]    [    0]    [1]    [341.7000]
    '21-Jun-2019'    [172]    [344.8000]    [    0]    [1]    [340.5000]
    '21-Jun-2019'    [172]    [344.7000]    [    0]    [1]    [340.8000]
    '21-Jun-2019'    [172]    [345.4000]    [    0]    [1]    [341.5000]
    '21-Jun-2019'    [172]    [345.1000]    [    0]    [1]    [340.2000]
    '21-Jun-2019'    [172]    [345.2000]    [    0]    [1]    [338.7000]
    '21-Jun-2019'    [172]    [344.8000]    [    0]    [1]    [     340]
    '21-Jun-2019'    [172]    [     345]    [    0]    [1]    [340.8000]
    '21-Jun-2019'    [172]    [345.9000]    [    0]    [1]    [340.3000]
    '21-Jun-2019'    [172]    [344.5000]    [    0]    [2]    [340.5000]
    '21-Jun-2019'    [172]    [344.3000]    [    0]    [1]    [341.4000]
    '21-Jun-2019'    [172]    [345.4000]    [    0]    [1]    [340.8000]
    '21-Jun-2019'    [172]    [344.9000]    [    0]    [1]    [339.4000]
    '21-Jun-2019'    [172]    [344.6000]    [    0]    [1]    [338.7000]
    '21-Jun-2019'    [172]    [345.3000]    [    0]    [1]    [341.2000]
    '21-Jun-2019'    [172]    [344.4000]    [    0]    [1]    [339.6000]
    '21-Jun-2019'    [172]    [343.7000]    [    0]    [1]    [340.9000]
    '21-Jun-2019'    [172]    [341.8000]    [    0]    [1]    [337.6000]
    '21-Jun-2019'    [172]    [343.2000]    [    0]    [1]    [337.3000]
    '21-Jun-2019'    [172]    [343.4000]    [    0]    [2]    [     339]
    '21-Jun-2019'    [172]    [341.8000]    [    0]    [2]    [337.2000]
    '21-Jun-2019'    [172]    [342.2000]    [    0]    [2]    [337.6000]
    '21-Jun-2019'    [172]    [342.3000]    [    0]    [2]    [338.6000]
    '21-Jun-2019'    [172]    [     345]    [    0]    [1]    [338.7000]
    '21-Jun-2019'    [172]    [345.1000]    [    0]    [1]    [339.3000]
    '21-Jun-2019'    [172]    [343.3000]    [    0]    [1]    [338.8000]
    '21-Jun-2019'    [172]    [343.6000]    [    0]    [1]    [338.2000]
    '21-Jun-2019'    [172]    [344.4000]    [    0]    [1]    [338.6000]
    '21-Jun-2019'    [172]    [     343]    [    0]    [3]    [338.4000]
    '21-Jun-2019'    [172]    [343.9000]    [    0]    [2]    [338.7000]
    '21-Jun-2019'    [172]    [342.8000]    [    0]    [1]    [     336]
    '21-Jun-2019'    [172]    [341.1000]    [    0]    [1]    [337.1000]
    '21-Jun-2019'    [172]    [341.6000]    [    0]    [1]    [337.9000]
    '21-Jun-2019'    [172]    [342.4000]    [    0]    [1]    [337.1000]
    '21-Jun-2019'    [172]    [341.5000]    [    0]    [1]    [337.6000]
    '21-Jun-2019'    [172]    [341.3000]    [    0]    [1]    [336.5000]
    '21-Jun-2019'    [172]    [333.9000]    [    0]    [1]    [331.7000]
    '21-Jun-2019'    [172]    [333.4000]    [    0]    [1]    [331.8000]
    '22-Jun-2019'    [173]    [326.8000]    [    0]    [1]    [324.7000]
    '22-Jun-2019'    [173]    [325.5000]    [    0]    [1]    [323.5000]
    '22-Jun-2019'    [173]    [331.9000]    [    0]    [1]    [     326]

  Columns 7 through 10

    'O3 std'    '\%(158-185)/185'    'O3(*)\#158'    'O3std' 
    [     0]    [             -1]    [  326.8000]    [     0]
    [     0]    [        -1.3000]    [  325.1000]    [     0]
    [     0]    [        -1.2000]    [  325.2000]    [     0]
    [     0]    [        -1.2000]    [  325.4000]    [     0]
    [     2]    [        -1.3000]    [  325.2000]    [     2]
    [     0]    [             -1]    [  325.9000]    [     0]
    [0.2000]    [        -1.8000]    [  324.3000]    [0.2000]
    [     0]    [        -1.4000]    [  327.6000]    [     0]
    [     0]    [        -1.1000]    [  328.4000]    [     0]
    [     0]    [        -0.6000]    [  329.6000]    [     0]
    [     0]    [             -2]    [  325.6000]    [     0]
    [     0]    [        -1.3000]    [  327.3000]    [     0]
    [     0]    [        -1.4000]    [       328]    [     0]
    [1.2000]    [        -1.5000]    [       328]    [1.2000]
    [0.1000]    [        -1.6000]    [  328.7000]    [0.1000]
    [     0]    [        -1.9000]    [  327.2000]    [     0]
    [     0]    [        -1.2000]    [  328.7000]    [     0]
    [0.1000]    [        -1.8000]    [  328.9000]    [0.1000]
    [1.4000]    [        -1.7000]    [  327.9000]    [1.4000]
    [     0]    [        -2.1000]    [  328.3000]    [     0]
    [     0]    [        -1.5000]    [  330.4000]    [     0]
    [1.5000]    [        -1.6000]    [       330]    [1.5000]
    [     0]    [        -1.5000]    [  330.7000]    [     0]
    [     0]    [        -1.1000]    [       331]    [     0]
    [     0]    [        -1.9000]    [  329.5000]    [     0]
    [     0]    [        -1.4000]    [  330.7000]    [     0]
    [0.7000]    [        -2.2000]    [  329.6000]    [0.7000]
    [     0]    [        -1.8000]    [       330]    [     0]
    [     0]    [        -1.8000]    [  331.5000]    [     0]
    [     0]    [        -1.2000]    [  332.4000]    [     0]
    [     0]    [        -1.2000]    [  332.3000]    [     0]
    [     0]    [        -1.1000]    [  332.9000]    [     0]
    [1.2000]    [        -1.7000]    [  332.1000]    [1.2000]
    [     1]    [        -1.5000]    [  332.3000]    [     1]
    [     0]    [        -1.5000]    [  331.3000]    [     0]
    [     0]    [             -1]    [  331.5000]    [     0]
    [     0]    [        -1.7000]    [  330.3000]    [     0]
    [     0]    [        -0.7000]    [  329.9000]    [     0]
    [     0]    [        -0.2000]    [  328.8000]    [     0]
    [     0]    [        -0.6000]    [  327.7000]    [     0]
    [0.5000]    [        -0.5000]    [  329.2000]    [0.5000]
    [     0]    [        -0.7000]    [  328.5000]    [     0]
    [     0]    [             -1]    [  328.5000]    [     0]
    [     0]    [        -1.5000]    [  329.6000]    [     0]
    [     0]    [        -0.7000]    [  332.5000]    [     0]
    [1.3000]    [        -1.3000]    [  332.2000]    [1.2000]
    [     0]    [        -1.4000]    [  332.3000]    [     0]
    [     1]    [        -1.5000]    [  341.4000]    [     1]
    [1.5000]    [        -1.8000]    [  341.6000]    [1.5000]
    [     0]    [        -1.7000]    [  341.7000]    [     0]
    [     0]    [        -1.7000]    [  342.6000]    [     0]
    [     0]    [        -1.7000]    [  340.7000]    [     0]
    [1.5000]    [        -1.5000]    [  340.8000]    [1.5000]
    [     0]    [        -1.2000]    [  342.4000]    [     0]
    [     0]    [        -1.6000]    [  339.6000]    [     0]
    [     0]    [        -1.9000]    [  339.9000]    [     0]
    [     0]    [        -1.5000]    [  341.3000]    [     0]
    [     0]    [        -2.3000]    [  336.1000]    [     0]
    [     0]    [        -1.1000]    [  338.7000]    [     0]
    [     0]    [        -0.5000]    [  339.5000]    [     0]
    [     0]    [        -1.4000]    [  336.6000]    [     0]
    [     0]    [        -0.2000]    [  341.7000]    [     0]
    [     0]    [        -0.2000]    [  340.3000]    [     0]
    [     0]    [        -0.1000]    [  337.7000]    [     0]
    [0.9000]    [        -0.5000]    [  337.6000]    [0.9000]
    [     0]    [        -1.2000]    [  337.3000]    [     0]
    [     0]    [             -1]    [  338.6000]    [     0]
    [     0]    [        -1.1000]    [  338.7000]    [     0]
    [     0]    [             -1]    [  339.1000]    [     0]
    [     0]    [        -1.2000]    [  338.7000]    [     0]
    [     0]    [        -1.1000]    [  339.2000]    [     0]
    [0.3000]    [        -0.8000]    [  340.9000]    [0.2000]
    [1.1000]    [        -0.8000]    [  340.2000]    [1.2000]
    [     0]    [        -1.2000]    [  341.6000]    [     0]
    [     0]    [        -1.3000]    [  341.3000]    [     0]
    [     0]    [        -0.7000]    [  342.7000]    [     0]
    [     0]    [        -1.2000]    [  342.1000]    [     0]
    [     0]    [        -1.4000]    [       343]    [     0]
    [     0]    [        -0.8000]    [  343.6000]    [     0]
    [     0]    [        -1.3000]    [  342.2000]    [     0]
    [0.1000]    [        -0.8000]    [  343.6000]    [0.1000]
    [0.8000]    [        -1.2000]    [       345]    [0.9000]
    [     0]    [        -1.5000]    [  344.9000]    [     0]
    [2.3000]    [        -1.1000]    [  346.2000]    [2.3000]
    [     0]    [        -1.3000]    [  345.9000]    [     0]
    [     0]    [        -0.4000]    [  347.3000]    [     0]
    [     0]    [        -1.6000]    [  343.8000]    [     0]
    [     0]    [        -0.9000]    [  345.6000]    [     0]
    [     0]    [        -1.2000]    [  345.3000]    [     0]
    [     0]    [             -1]    [  346.5000]    [     0]
    [     0]    [             -1]    [  345.7000]    [     0]
    [     1]    [        -1.1000]    [  345.9000]    [     1]
    [     0]    [        -0.9000]    [  346.6000]    [     0]
    [     0]    [        -1.3000]    [  345.4000]    [     0]
    [     0]    [        -1.9000]    [  344.1000]    [     0]
    [     0]    [        -1.5000]    [  343.3000]    [     0]
    [     0]    [        -1.1000]    [  345.6000]    [     0]
    [     0]    [        -1.2000]    [  344.5000]    [     0]
    [     0]    [        -1.1000]    [  344.7000]    [     0]
    [     0]    [        -1.1000]    [  345.4000]    [     0]
    [     0]    [        -1.4000]    [  344.1000]    [     0]
    [     0]    [        -1.9000]    [  342.7000]    [     0]
    [     0]    [        -1.4000]    [       344]    [     0]
    [     0]    [        -1.2000]    [  344.7000]    [     0]
    [     0]    [        -1.6000]    [  344.3000]    [     0]
    [1.2000]    [        -1.2000]    [  344.5000]    [1.2000]
    [     0]    [        -0.8000]    [  345.4000]    [     0]
    [     0]    [        -1.3000]    [  344.8000]    [     0]
    [     0]    [        -1.6000]    [  343.4000]    [     0]
    [     0]    [        -1.7000]    [  342.7000]    [     0]
    [     0]    [        -1.2000]    [  345.2000]    [     0]
    [     0]    [        -1.4000]    [  343.6000]    [     0]
    [     0]    [        -0.8000]    [  344.9000]    [     0]
    [     0]    [        -1.2000]    [  341.6000]    [     0]
    [     0]    [        -1.7000]    [  341.3000]    [     0]
    [0.6000]    [        -1.3000]    [       343]    [0.6000]
    [1.8000]    [        -1.3000]    [  341.2000]    [1.8000]
    [0.7000]    [        -1.3000]    [  341.6000]    [0.7000]
    [     1]    [        -1.1000]    [  342.5000]    [1.1000]
    [     0]    [        -1.8000]    [  342.6000]    [     0]
    [     0]    [        -1.7000]    [  343.2000]    [     0]
    [     0]    [        -1.3000]    [  342.7000]    [     0]
    [     0]    [        -1.6000]    [  342.1000]    [     0]
    [     0]    [        -1.7000]    [  342.4000]    [     0]
    [0.6000]    [        -1.3000]    [  342.2000]    [0.6000]
    [0.1000]    [        -1.5000]    [  342.5000]    [0.1000]
    [     0]    [             -2]    [  339.7000]    [     0]
    [     0]    [        -1.2000]    [  340.7000]    [     0]
    [     0]    [        -1.1000]    [  341.6000]    [     0]
    [     0]    [        -1.5000]    [  340.8000]    [     0]
    [     0]    [        -1.1000]    [  341.2000]    [     0]
    [     0]    [        -1.4000]    [  340.1000]    [     0]
    [     0]    [        -0.7000]    [  333.9000]    [     0]
    [     0]    [        -0.5000]    [  333.8000]    [     0]
    [     0]    [        -0.6000]    [  326.8000]    [     0]
    [     0]    [        -0.6000]    [  325.7000]    [     0]
    [     0]    [        -1.8000]    [  329.4000]    [     0]

  Column 11

    '(*)\%(158-185)/185'
    [                 0]
    [           -0.2000]
    [           -0.2000]
    [           -0.2000]
    [           -0.3000]
    [            0.1000]
    [           -0.7000]
    [           -0.2000]
    [            0.1000]
    [            0.6000]
    [           -0.8000]
    [           -0.1000]
    [           -0.2000]
    [           -0.3000]
    [           -0.4000]
    [           -0.7000]
    [                 0]
    [           -0.5000]
    [           -0.5000]
    [           -0.9000]
    [           -0.3000]
    [           -0.4000]
    [           -0.4000]
    [            0.1000]
    [           -0.8000]
    [           -0.3000]
    [           -1.1000]
    [           -0.7000]
    [           -0.7000]
    [           -0.1000]
    [           -0.2000]
    [           -0.1000]
    [           -0.7000]
    [           -0.5000]
    [           -0.6000]
    [           -0.1000]
    [           -0.9000]
    [           -0.1000]
    [            0.4000]
    [                 0]
    [            0.1000]
    [                 0]
    [           -0.2000]
    [           -0.7000]
    [            0.2000]
    [           -0.4000]
    [           -0.5000]
    [           -0.4000]
    [           -0.6000]
    [           -0.6000]
    [           -0.6000]
    [           -0.6000]
    [           -0.4000]
    [           -0.1000]
    [           -0.5000]
    [           -0.8000]
    [           -0.4000]
    [           -1.2000]
    [           -0.2000]
    [            0.3000]
    [           -0.7000]
    [            0.5000]
    [            0.5000]
    [            0.5000]
    [            0.1000]
    [           -0.5000]
    [           -0.3000]
    [           -0.3000]
    [           -0.2000]
    [           -0.4000]
    [           -0.4000]
    [            0.1000]
    [            0.1000]
    [           -0.3000]
    [           -0.4000]
    [            0.3000]
    [           -0.3000]
    [           -0.4000]
    [            0.2000]
    [           -0.4000]
    [            0.1000]
    [           -0.2000]
    [           -0.5000]
    [           -0.1000]
    [           -0.3000]
    [            0.6000]
    [           -0.5000]
    [            0.2000]
    [           -0.2000]
    [            0.1000]
    [            0.1000]
    [                 0]
    [            0.2000]
    [           -0.2000]
    [           -0.8000]
    [           -0.4000]
    [                 0]
    [           -0.1000]
    [                 0]
    [                 0]
    [           -0.3000]
    [           -0.7000]
    [           -0.2000]
    [           -0.1000]
    [           -0.5000]
    [                 0]
    [            0.3000]
    [           -0.2000]
    [           -0.4000]
    [           -0.6000]
    [                 0]
    [           -0.2000]
    [            0.3000]
    [           -0.1000]
    [           -0.6000]
    [           -0.1000]
    [           -0.2000]
    [           -0.2000]
    [            0.1000]
    [           -0.7000]
    [           -0.6000]
    [           -0.2000]
    [           -0.4000]
    [           -0.6000]
    [           -0.2000]
    [           -0.4000]
    [           -0.9000]
    [           -0.1000]
    [                 0]
    [           -0.5000]
    [           -0.1000]
    [           -0.4000]
    [                 0]
    [            0.1000]
    [                 0]
    [            0.1000]
    [           -0.8000]


total_sugerida =

   175

</pre><pre class="codeinput"><span class="keyword">else</span>
    disp(<span class="string">'No maintenance'</span>)
    ETC_SUG(1).NEW=NaN; o3c_SUG=NaN;  osc_smooth_sug=NaN*ones(1,7);

    [x,r,rp,ra,dat,ox,osc_smooth_ini]=ratio_min_ozone(<span class="keyword">...</span>
        inst1_b(:,[1,6,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),<span class="keyword">...</span>
        5,brw_str{n_ref},brw_str{n_ref},<span class="string">'plot_flag'</span>,0);<span class="comment">% original config</span>
    [x,r,rp,ra,dat,ox,osc_smooth_inisl]=ratio_min_ozone(<span class="keyword">...</span>
        inst1_b(:,[1,12,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),<span class="keyword">...</span>
        5,brw_str{n_ref},brw_str{n_ref},<span class="string">'plot_flag'</span>,0);<span class="comment">% original config with SL correction</span>

    osc_smooth{Cal.n_inst}.ini=osc_smooth_ini;  osc_smooth{Cal.n_inst}.ini_sl=osc_smooth_inisl;
    A1=A.old(ismember(Cal.Date.CALC_DAYS,blinddays),Cal.n_inst+1); A1_old=unique(A1(~isnan(A1)));
<span class="keyword">end</span>

latexcmd(fullfile(Cal.file_latex,[<span class="string">'cal_etc_'</span>,brw_str{n_inst}]),<span class="string">'\ETCblind'</span>,num2str(round(ETC_SUG(1).NEW)),<span class="keyword">...</span>
             <span class="string">'\ETCSOblind'</span>,config_def(12),<span class="string">'\SOABSblind'</span>,config_def(10),<span class="string">'\OtresSOABSblind'</span>,config_def(9),<span class="keyword">...</span>
             <span class="string">'\NobsCalblind'</span>,size(o3c_SUG,1));

etc{Cal.n_inst}.sug=ETC_SUG;
osc_smooth{Cal.n_inst}.ini=osc_smooth_ini; osc_smooth{Cal.n_inst}.ini_sl=osc_smooth_inisl;
osc_smooth{Cal.n_inst}.sug=osc_smooth_sug;

save(Cal.file_save,<span class="string">'-APPEND'</span>,<span class="string">'etc'</span>);
</pre><h2 id="24">Final Period</h2><pre class="codeinput">close <span class="string">all</span>
</pre><h2 id="25">filter correction</h2><p>% %Si queremos eliminar algun filtro CORREGIR a NaN  F_corr{Cal.n_inst}=[0,0,0,-15,0,0]  for ii=[Cal.n_ref Cal.n_inst]          [summary_old_corr summary_corr]=filter_corr(summary_orig,summary_orig_old,ii,A,F_corr{ii});     summary_old{ii}=summary_old_corr; summary{ii}=summary_corr;  end</p><pre class="codeinput">finaldays=Cal.calibration_days{Cal.n_inst,3}; <span class="comment">% no change</span>
finaldays(finaldays==173)=[]
finaldays(finaldays==172)=[]

jday=ismember(diaj(summary{Cal.n_inst}(:,1)),fix(finaldays));
jlim=(diaj2(summary{Cal.n_inst}(:,1))&gt;finaldays(1) &amp; <span class="keyword">...</span><span class="comment">    % 2st set the limits</span>
      diaj2(summary{Cal.n_inst}(:,1))&lt;finaldays(end));
inst2=summary{Cal.n_inst}(jday &amp; jlim ,:);
<span class="comment">%</span>
A1=A.new(ismember(Cal.Date.CALC_DAYS,finaldays),Cal.n_inst+1);
A1_new=unique(A1(~isnan(A1)))
<span class="comment">%A1_new=0.3435</span>
osc_range=1;

[ETC_NEW,o3c_NEW,m_etc_NEW]=ETC_calibration_C(Cal,summary,A1_new,n_inst,n_ref,<span class="keyword">...</span>
                                                                5,osc_range,0.02,finaldays);
hidx=ismember(Cal.Date.CALC_DAYS,finaldays);
cc=nanmean([ETC.new(hidx,Cal.n_inst+1),10000*A.new(hidx,Cal.n_inst+1),10000*A.old(hidx,Cal.n_inst+1)]);

tableform({<span class="string">'ETCorig'</span>,<span class="string">'ETCnew 1p'</span>,<span class="string">'ETCnew 2p'</span>,<span class="string">'O3Abs (ICF)'</span>,<span class="string">'O3Abs 2p'</span>,<span class="string">'O3Abs old'</span>},<span class="keyword">...</span>
          [round([cc(1),ETC_NEW(1).NEW,ETC_NEW(1).TP(1), cc(3),ETC_NEW(1).TP(2),cc(2)])
<span class="comment">%         solo el rango seleccionado</span>
           round([cc(1),ETC_NEW(2).NEW,ETC_NEW(2).TP(1), cc(3),ETC_NEW(2).TP(2),cc(3)])]);
<span class="comment">%         todo el rango</span>
latexcmd(fullfile([<span class="string">'&gt;'</span>,Cal.file_latex],[<span class="string">'cal_etc_'</span>,brw_str{n_inst}]),<span class="string">'\ETCfin'</span>,num2str(round(ETC_NEW(1).NEW)),<span class="keyword">...</span>
    <span class="string">'\ETCSOfin'</span>,config_def(12),<span class="string">'\SOABSfin'</span>,config_def(10),<span class="string">'\OtresSOABSfin'</span>,config_def(9),<span class="keyword">...</span>
    <span class="string">'\NobsCalfin'</span>,size(o3c_NEW,1));

etc{Cal.n_inst}.new=ETC_NEW;
save(Cal.file_save,<span class="string">'-APPEND'</span>,<span class="string">'etc'</span>);
</pre><pre class="codeoutput">
finaldays =

   174   175   176   177   178   179


finaldays =

   174   175   176   177   178   179


A1_new =

    0.3435


  Columns 1 through 5

    'ETCorig'    'ETCnew 1p'    'ETCnew 2p'    'O3Abs (ICF)'    'O3Abs 2p'
    [   1780]    [     1781]    [     1766]    [       3414]    [    3469]
    [   1780]    [     1782]    [     1768]    [       3414]    [    3464]

  Column 6

    'O3Abs old'
    [     3435]
    [     3414]


</pre><img vspace="5" hspace="5" src="cal_report_158c_78.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_79.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_80.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_81.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_82.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_83.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_84.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_85.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_86.png" alt=""> <h2 id="26">TEST NEW CONFIG</h2><pre class="language-matlab">o3r= (inst2(:,8)-ETC_NEW(1).NEW)./(A1_new*inst2(:,3)*10);
inst2(:,10)=o3r;
    [x,r,rp,ra,dat,ox,osc_smooth_fin]=ratio_min_ozone(<span class="keyword">...</span>
       inst2(:,[1,10,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),<span class="keyword">...</span>
       5,brw_str{n_inst},brw_str{n_ref},<span class="string">'plot_flag'</span>,0);
</pre><h2 id="27">FINAL CONFIG</h2><pre class="codeinput">    [x,r,rp,ra,dat,ox,osc_smooth_fin]=ratio_min_ozone(<span class="keyword">...</span>
        inst2(:,[1,6,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),<span class="keyword">...</span>
        5,brw_str{n_inst},brw_str{n_ref},<span class="string">'plot_flag'</span>,0);

 figure; set(gcf,<span class="string">'tag'</span>,<span class="string">'RATIO_ERRORBAR_all'</span>);
 h=plot_smooth(osc_smooth_ini,osc_smooth_inisl,osc_smooth_fin);
 legend(h,<span class="string">'Config. orig'</span>,<span class="string">'Config. orig, SL corrected'</span>,<span class="string">'Suggested'</span>); set(gca,<span class="string">'YLim'</span>,[-4 2]);
 title([ brw_str{n_inst},<span class="string">' - '</span>,brw_str{n_ref},<span class="string">' / '</span>,brw_str{n_ref}]);
</pre><pre class="codeoutput">Por defecto, LIM=2.5 (en boxparams)
    1.0653
  -21.3005
    0.9552
    1.0404
  -29.2720
    1.0903
  -13.3289

--------- Validation OK --------------
List of arguments given default values:
   'OSC_lim'    defaults to 250  1900
--------------------------------------
</pre><img vspace="5" hspace="5" src="cal_report_158c_87.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_88.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_89.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_90.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_91.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_92.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_93.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_94.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_95.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_96.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_97.png" alt=""> <h2 id="28">TWO POINT CALIBRATION</h2><pre>o3r= (inst2(:,8)-ETC_NEW(1).TP(1))./(ETC_NEW(1).TP(2)/10000*inst2(:,3)*10);
inst2(:,10)=o3r;
    [x,r,rp,ra,dat,ox,osc_smooth_2P]=ratio_min_ozone(...
       inst2(:,[1,10,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),...
       5,brw_str{n_inst},brw_str{n_ref},'plot_flag',0);</pre><pre class="codeinput">osc_smooth{Cal.n_inst}.fin=osc_smooth_fin;
<span class="comment">% osc_smooth{Cal.n_inst}.twoP=osc_smooth_2P;</span>
save(Cal.file_save,<span class="string">'-APPEND'</span>,<span class="string">'osc_smooth'</span>);
</pre><pre class="codeinput">figure(maxf(findobj(<span class="string">'tag'</span>,<span class="string">'CAL_2P_SCHIST'</span>)));
ax=findobj(gca,<span class="string">'type'</span>,<span class="string">'text'</span>);
set(ax(2),<span class="string">'FontSize'</span>,9,<span class="string">'Backgroundcolor'</span>,<span class="string">'w'</span>); set(ax(3),<span class="string">'FontSize'</span>,9,<span class="string">'Backgroundcolor'</span>,<span class="string">'w'</span>);
printfiles_report(gcf,Cal.dir_figs,<span class="string">'aux_pattern'</span>,{<span class="string">'fin'</span>},<span class="string">'Width'</span>,14,<span class="string">'Height'</span>,8);

figure(maxf(findobj(<span class="string">'tag'</span>,<span class="string">'RATIO_ERRORBAR'</span>)));
printfiles_report(gcf,Cal.dir_figs,<span class="string">'aux_pattern'</span>,{<span class="string">'fin'</span>});

figure(maxf(findobj(<span class="string">'tag'</span>,<span class="string">'RATIO_ERRORBAR_all'</span>)));
printfiles_report(gcf,Cal.dir_figs);

close <span class="string">all</span>
</pre><h2 id="31">STRAY</h2><pre class="codeinput"><span class="keyword">if</span> Cal.brwM(Cal.n_inst)~=3
</pre><pre class="codeinput">    close <span class="string">all</span>

    osc_range=2;
    [ETC_NEWo,o3c_NEWo,m_etc_NEW]=ETC_calibration_C(Cal,summary,A1_new,n_inst,n_ref,<span class="keyword">...</span>
        10,osc_range,0.05,finaldays);

    close <span class="string">all</span>;
    straylight_{n_inst}=straylight_model(o3c_NEWo,A1_new,ETC_NEW(1).NEW,Cal);
    save(Cal.file_save,<span class="string">'-APPEND'</span>,<span class="string">'straylight_'</span>);
</pre><pre class="codeinput">    figure(maxf(findobj(<span class="string">'-regexp'</span>,<span class="string">'tag'</span>,<span class="string">'ETC_StrayLight*'</span>)));
    <span class="comment">% ax=findobj(gca,'type','text');</span>
    <span class="comment">% set(ax,'FontSize',12,'Backgroundcolor','w');</span>
    <span class="comment">%set(ax(3),'FontSize',9,'Backgroundcolor','w');</span>
    printfiles_report(gcf,Cal.dir_figs,<span class="string">'aux_pattern'</span>,{<span class="string">'_Det'</span>},<span class="keyword">...</span>
        <span class="string">'Width'</span>,14,<span class="string">'Height'</span>,8,<span class="string">'FontSize'</span>,10);
</pre><h2 id="34">Latex variables</h2><pre class="codeinput">    a=straylight_{n_inst}.coeff.R(1);
    b=straylight_{n_inst}.coeff.R(2);
    sl_etc=straylight_{n_inst}.coeff.R(3);

    latexcmd(fullfile([<span class="string">'&gt;'</span>,Cal.file_latex],[<span class="string">'cal_etc_'</span>,brw_str{n_inst}]),<span class="keyword">...</span>
        <span class="string">'\SLETC'</span>,round(sl_etc),<span class="string">'\SLexp'</span>,round(b*100)/100,<span class="string">'\SLcoeff'</span>,round(a*10)/10);
</pre><h2 id="35">calculation</h2><pre class="codeinput">    a=straylight_{n_inst}.coeff.R(1);
    b=straylight_{n_inst}.coeff.R(2);
    sl_etc=straylight_{n_inst}.coeff.R(3);

    etc=ETC_NEW(1).NEW
    o3=inst2(:,6);
    m =inst2(:,3);
    o3r= o3 -  a/A1_new*(m.*o3/1000).^b./m/10;
    <span class="comment">%o3r1= o3 -  a/A1_new*(m.*o3r).^b./m/10;</span>

    inst2(:,10)=o3r;
    [x,r,rp,ra,dat,ox,osc_stray]=ratio_min_ozone(<span class="keyword">...</span>
        inst2(:,[1,10,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),<span class="keyword">...</span>
        5,brw_str{n_inst},brw_str{n_inst},<span class="string">'plot_flag'</span>,0);


    o3r1= o3 -  a/A1_new*(m.*o3r/1000).^b./m/10;

    inst2(:,10)=o3r1;
    [x,r,rp,ra,dat,ox,osc_stray2]=ratio_min_ozone(<span class="keyword">...</span>
        inst2(:,[1,10,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),<span class="keyword">...</span>
        5,brw_str{n_inst},brw_str{n_inst},<span class="string">'plot_flag'</span>,0);
</pre><h2 id="36">Apply the SL correction</h2><pre class="codeinput">    f=figure;
    set(f,<span class="string">'tag'</span>,<span class="string">'RATIO_ERRORBAR_stray'</span>);
    h=plot_smooth_(osc_smooth_inisl,osc_smooth_fin,osc_stray2);
    legend(h,<span class="string">'Config. initial (SL corrected)'</span>,<span class="string">'Final Configuration'</span>,<span class="string">'Stray Light corrected '</span>,<span class="keyword">...</span>
        <span class="string">'location'</span>,<span class="string">'southwest'</span>);
    set(gca,<span class="string">'YLim'</span>,[-4 2]);
    title([ brw_str{n_inst},<span class="string">' - '</span>,brw_str{n_ref},<span class="string">' / '</span>,brw_str{n_ref}]);

    figure(maxf(findobj(<span class="string">'-regexp'</span>,<span class="string">'tag'</span>,<span class="string">'RATIO_ERRORBAR_stray'</span>)));
    printfiles_report(gcf,Cal.dir_figs,<span class="keyword">...</span>
        <span class="string">'Width'</span>,14,<span class="string">'Height'</span>,8);
</pre><h2 id="37">Difference iter#1 to iter#2</h2><pre class="codeinput">    f=figure;
    set(f,<span class="string">'tag'</span>,<span class="string">'RATIO_ERRORBAR_stray_corr'</span>);
    h=plot_smooth_(osc_smooth_fin,osc_stray,osc_stray2);
    legend(h,<span class="string">'Config.final'</span>,<span class="string">'Stray Light corrected Iter #1'</span>,<span class="string">'Stray Light corrected Iter #2'</span>,<span class="keyword">...</span>
        <span class="string">'location'</span>,<span class="string">'southwest'</span>);
    set(gca,<span class="string">'YLim'</span>,[-4 2]);
    title([ brw_str{n_inst},<span class="string">' - '</span>,brw_str{n_ref},<span class="string">' / '</span>,brw_str{n_ref}]);
    f=figure;

    figure(maxf(findobj(<span class="string">'-regexp'</span>,<span class="string">'tag'</span>,<span class="string">'RATIO_ERRORBAR_stray_corr'</span>)));
    printfiles_report(gcf,Cal.dir_figs,<span class="keyword">...</span>
        <span class="string">'Width'</span>,14,<span class="string">'Height'</span>,8);
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><h2 id="39">Final days table</h2><p>m_etc_(lo que sea) son los datos filtrados por Tsync, OSC y sza !!! -&gt; salida de ETC_calibration En ste caso se usa summary, as? que la configuraci?n original ser? 10, y la final 6</p><pre class="codeinput">m_etc=[m_etc_NEW(:,[1:4 7:8]),NaN*m_etc_NEW(:,1),m_etc_NEW(:,5:6)];
m_etc(:,7)=100*(m_etc(:,5)-m_etc(:,2))./m_etc(:,2);
m_etc(:,10)=100*(m_etc(:,8)-m_etc(:,2))./m_etc(:,2);
<span class="comment">% La diferencia relativa anterior se refiere al ozono recalculado con la ETC que resulta de los c?lculos</span>
<span class="comment">% Esto podr?a ser una incoherencia: por ejemplo para el 072 sale 3179, pero mantenemos 3185.</span>

<span class="comment">%m_etc(:,[end-1,end])=[];</span>
M=cell(size(m_etc,1)+1,size(m_etc,2)+1);
label={<span class="string">'Date'</span>,<span class="string">'Day'</span>,[<span class="string">'O3\#'</span>,brw_str{n_ref}],<span class="string">'O3std'</span>,<span class="string">'N'</span>,<span class="keyword">...</span>
         [<span class="string">'O3\#'</span>,brw_str{n_inst}],<span class="string">'O3 std'</span>,<span class="keyword">...</span>
         [<span class="string">'\%('</span>,brw_str{n_inst},<span class="string">'-'</span>,brw_str{n_ref},<span class="string">')/'</span>,brw_str{n_ref}]<span class="keyword">...</span>
         [<span class="string">'O3(*)\#'</span>,brw_str{n_inst}],<span class="string">'O3std'</span>,<span class="keyword">...</span>
         [<span class="string">'(*)\%('</span>,brw_str{n_inst},<span class="string">'-'</span>,brw_str{n_ref},<span class="string">')/'</span>,brw_str{n_ref}]};
M(1,:)=label;
M(2:end,1)=cellstr(datestr(fix(m_etc(:,1))));
m_etc(:,1)=diaj(m_etc(:,1));
M(2:end,2:end)=num2cell(round(m_etc*10)/10);

disp(M);
matrix2latex_ctable(M(2:end,2:end),fullfile(Cal.file_latex,[<span class="string">'table_ETCdatafin_'</span>,Cal.brw_str{Cal.n_inst},<span class="string">'.tex'</span>]),<span class="keyword">...</span>
                                   <span class="string">'rowlabels'</span>,M(2:end,1),<span class="keyword">...</span>
                                   <span class="string">'columnlabels'</span>,label(2:end),<span class="string">'alignment'</span>,<span class="string">'c'</span>,<span class="string">'resize'</span>,0.9)

<span class="comment">% So2 calibration from icf file</span>
<span class="comment">% Pendiente</span>
<span class="comment">% latexcmd(['&gt;',file_latex,'_etc_',brw_str{n_inst}],'\ETCSOdos',config_def(12),'\SOdosABS',config_def(10),'\OtresSOdosABS',config_def(9));</span>
</pre><pre class="codeoutput">  Columns 1 through 6

    'Date'           'Day'    'O3\#185'     'O3std'    'N'    'O3\#158' 
    '22-Jun-2019'    [173]    [338.9000]    [    0]    [1]    [329.6000]
    '22-Jun-2019'    [173]    [338.7000]    [    0]    [1]    [331.2000]
    '22-Jun-2019'    [173]    [338.2000]    [    0]    [2]    [331.3000]
    '22-Jun-2019'    [173]    [     339]    [    0]    [2]    [331.9000]
    '22-Jun-2019'    [173]    [337.6000]    [    0]    [2]    [330.4000]
    '22-Jun-2019'    [173]    [338.8000]    [    0]    [1]    [329.6000]
    '22-Jun-2019'    [173]    [337.3000]    [    0]    [1]    [330.6000]
    '22-Jun-2019'    [173]    [336.7000]    [    0]    [1]    [329.7000]
    '22-Jun-2019'    [173]    [338.2000]    [    0]    [1]    [331.7000]
    '22-Jun-2019'    [173]    [336.9000]    [    0]    [1]    [330.7000]
    '22-Jun-2019'    [173]    [335.9000]    [    0]    [1]    [330.2000]
    '22-Jun-2019'    [173]    [336.8000]    [    0]    [1]    [330.6000]
    '22-Jun-2019'    [173]    [     336]    [    0]    [1]    [329.8000]
    '22-Jun-2019'    [173]    [335.7000]    [    0]    [1]    [328.2000]
    '22-Jun-2019'    [173]    [333.7000]    [    0]    [2]    [329.3000]
    '22-Jun-2019'    [173]    [333.6000]    [    0]    [1]    [328.6000]
    '22-Jun-2019'    [173]    [334.2000]    [    0]    [1]    [328.9000]
    '22-Jun-2019'    [173]    [330.7000]    [    0]    [1]    [327.1000]
    '22-Jun-2019'    [173]    [     330]    [    0]    [2]    [327.5000]
    '22-Jun-2019'    [173]    [329.5000]    [    0]    [2]    [327.5000]
    '22-Jun-2019'    [173]    [329.6000]    [    0]    [1]    [328.1000]
    '22-Jun-2019'    [173]    [329.2000]    [    0]    [1]    [328.8000]
    '22-Jun-2019'    [173]    [329.3000]    [    0]    [1]    [328.2000]
    '22-Jun-2019'    [173]    [329.9000]    [    0]    [1]    [328.1000]
    '22-Jun-2019'    [173]    [330.3000]    [    0]    [1]    [327.5000]
    '22-Jun-2019'    [173]    [329.7000]    [    0]    [1]    [328.5000]
    '22-Jun-2019'    [173]    [330.2000]    [    0]    [1]    [328.9000]
    '22-Jun-2019'    [173]    [330.3000]    [    0]    [1]    [328.3000]
    '23-Jun-2019'    [174]    [318.3000]    [    0]    [1]    [319.6000]
    '23-Jun-2019'    [174]    [320.2000]    [    0]    [1]    [320.1000]
    '23-Jun-2019'    [174]    [319.9000]    [    0]    [1]    [319.6000]
    '23-Jun-2019'    [174]    [     321]    [    0]    [1]    [320.6000]
    '23-Jun-2019'    [174]    [323.4000]    [    0]    [1]    [321.8000]
    '23-Jun-2019'    [174]    [324.4000]    [    0]    [1]    [322.9000]
    '23-Jun-2019'    [174]    [325.1000]    [    0]    [1]    [     323]
    '23-Jun-2019'    [174]    [324.8000]    [    0]    [1]    [322.1000]
    '23-Jun-2019'    [174]    [     325]    [    0]    [1]    [322.6000]
    '23-Jun-2019'    [174]    [325.1000]    [    0]    [1]    [322.8000]
    '23-Jun-2019'    [174]    [325.3000]    [    0]    [1]    [322.4000]
    '23-Jun-2019'    [174]    [325.6000]    [    0]    [1]    [321.9000]
    '23-Jun-2019'    [174]    [330.5000]    [    0]    [1]    [324.3000]
    '23-Jun-2019'    [174]    [329.1000]    [    0]    [1]    [324.3000]
    '23-Jun-2019'    [174]    [329.1000]    [    0]    [1]    [322.6000]
    '23-Jun-2019'    [174]    [327.6000]    [    0]    [1]    [323.7000]
    '23-Jun-2019'    [174]    [330.7000]    [    0]    [1]    [325.4000]
    '23-Jun-2019'    [174]    [332.8000]    [    0]    [1]    [324.7000]
    '23-Jun-2019'    [174]    [331.6000]    [    0]    [1]    [323.3000]
    '23-Jun-2019'    [174]    [330.1000]    [    0]    [1]    [323.3000]
    '23-Jun-2019'    [174]    [329.6000]    [    0]    [1]    [325.1000]
    '23-Jun-2019'    [174]    [330.8000]    [    0]    [2]    [323.8000]
    '23-Jun-2019'    [174]    [331.1000]    [    0]    [1]    [325.9000]
    '23-Jun-2019'    [174]    [331.5000]    [    0]    [1]    [322.7000]
    '23-Jun-2019'    [174]    [     331]    [    0]    [2]    [322.8000]
    '23-Jun-2019'    [174]    [333.9000]    [    0]    [1]    [325.8000]
    '23-Jun-2019'    [174]    [     332]    [    0]    [1]    [323.9000]
    '23-Jun-2019'    [174]    [334.8000]    [    0]    [2]    [323.9000]
    '23-Jun-2019'    [174]    [334.2000]    [    0]    [2]    [324.1000]
    '23-Jun-2019'    [174]    [     334]    [    0]    [1]    [     324]
    '23-Jun-2019'    [174]    [334.2000]    [    0]    [1]    [325.2000]
    '23-Jun-2019'    [174]    [334.6000]    [    0]    [1]    [324.6000]
    '23-Jun-2019'    [174]    [335.4000]    [    0]    [2]    [     325]
    '23-Jun-2019'    [174]    [334.9000]    [    0]    [1]    [323.3000]
    '23-Jun-2019'    [174]    [335.2000]    [    0]    [2]    [324.1000]
    '23-Jun-2019'    [174]    [334.4000]    [    0]    [1]    [323.8000]
    '23-Jun-2019'    [174]    [335.4000]    [    0]    [1]    [323.6000]
    '23-Jun-2019'    [174]    [     336]    [    0]    [1]    [324.2000]
    '23-Jun-2019'    [174]    [336.6000]    [    0]    [1]    [326.2000]
    '23-Jun-2019'    [174]    [334.8000]    [    0]    [1]    [326.4000]
    '23-Jun-2019'    [174]    [335.2000]    [    0]    [1]    [323.5000]
    '23-Jun-2019'    [174]    [335.6000]    [    0]    [1]    [     325]
    '23-Jun-2019'    [174]    [335.3000]    [    0]    [1]    [323.2000]
    '23-Jun-2019'    [174]    [333.8000]    [    0]    [1]    [323.3000]
    '23-Jun-2019'    [174]    [334.2000]    [    0]    [1]    [321.6000]
    '23-Jun-2019'    [174]    [333.9000]    [    0]    [1]    [319.9000]
    '23-Jun-2019'    [174]    [333.5000]    [    0]    [1]    [322.8000]
    '23-Jun-2019'    [174]    [333.7000]    [    0]    [1]    [     321]
    '23-Jun-2019'    [174]    [334.6000]    [    0]    [1]    [322.4000]
    '23-Jun-2019'    [174]    [333.9000]    [    0]    [2]    [323.1000]
    '23-Jun-2019'    [174]    [332.9000]    [    0]    [1]    [323.1000]
    '23-Jun-2019'    [174]    [334.4000]    [    0]    [1]    [323.7000]
    '23-Jun-2019'    [174]    [333.6000]    [    0]    [1]    [321.8000]
    '23-Jun-2019'    [174]    [334.5000]    [    0]    [1]    [322.6000]
    '23-Jun-2019'    [174]    [334.6000]    [    0]    [1]    [324.7000]
    '23-Jun-2019'    [174]    [     334]    [    0]    [1]    [324.1000]
    '23-Jun-2019'    [174]    [334.4000]    [    0]    [1]    [324.2000]
    '23-Jun-2019'    [174]    [334.5000]    [    0]    [1]    [326.3000]
    '23-Jun-2019'    [174]    [334.5000]    [    0]    [1]    [325.4000]
    '23-Jun-2019'    [174]    [     329]    [    0]    [1]    [322.2000]
    '23-Jun-2019'    [174]    [333.7000]    [    0]    [1]    [     323]
    '23-Jun-2019'    [174]    [332.3000]    [    0]    [1]    [     324]
    '23-Jun-2019'    [174]    [329.5000]    [    0]    [1]    [324.1000]
    '23-Jun-2019'    [174]    [328.4000]    [    0]    [2]    [322.7000]
    '23-Jun-2019'    [174]    [     333]    [    0]    [1]    [     326]
    '23-Jun-2019'    [174]    [     333]    [    0]    [1]    [326.1000]
    '23-Jun-2019'    [174]    [331.6000]    [    0]    [2]    [325.8000]
    '23-Jun-2019'    [174]    [     327]    [    0]    [1]    [     322]
    '23-Jun-2019'    [174]    [329.9000]    [    0]    [1]    [322.7000]
    '23-Jun-2019'    [174]    [329.8000]    [    0]    [1]    [324.2000]
    '23-Jun-2019'    [174]    [330.7000]    [    0]    [1]    [     322]
    '23-Jun-2019'    [174]    [329.8000]    [    0]    [2]    [     324]
    '23-Jun-2019'    [174]    [326.1000]    [    0]    [1]    [     323]
    '23-Jun-2019'    [174]    [326.8000]    [    0]    [1]    [322.1000]
    '23-Jun-2019'    [174]    [323.8000]    [    0]    [1]    [321.8000]
    '23-Jun-2019'    [174]    [     325]    [    0]    [1]    [323.7000]
    '23-Jun-2019'    [174]    [326.1000]    [    0]    [1]    [324.4000]
    '23-Jun-2019'    [174]    [327.1000]    [    0]    [1]    [324.2000]
    '23-Jun-2019'    [174]    [325.9000]    [    0]    [1]    [325.3000]
    '23-Jun-2019'    [174]    [327.2000]    [    0]    [1]    [325.2000]
    '23-Jun-2019'    [174]    [325.9000]    [    0]    [1]    [324.7000]
    '23-Jun-2019'    [174]    [324.3000]    [    0]    [1]    [324.5000]
    '23-Jun-2019'    [174]    [325.2000]    [    0]    [1]    [323.7000]
    '23-Jun-2019'    [174]    [     326]    [    0]    [1]    [324.2000]
    '24-Jun-2019'    [175]    [311.2000]    [    0]    [1]    [312.9000]
    '24-Jun-2019'    [175]    [311.2000]    [    0]    [1]    [311.9000]
    '24-Jun-2019'    [175]    [311.2000]    [    0]    [1]    [311.7000]
    '24-Jun-2019'    [175]    [309.3000]    [    0]    [1]    [310.5000]
    '24-Jun-2019'    [175]    [309.8000]    [    0]    [1]    [309.6000]
    '24-Jun-2019'    [175]    [308.6000]    [    0]    [1]    [309.9000]
    '24-Jun-2019'    [175]    [307.7000]    [    0]    [1]    [308.9000]
    '24-Jun-2019'    [175]    [     309]    [    0]    [1]    [307.4000]
    '24-Jun-2019'    [175]    [308.7000]    [    0]    [1]    [     306]
    '24-Jun-2019'    [175]    [309.7000]    [    0]    [1]    [306.4000]
    '24-Jun-2019'    [175]    [315.2000]    [    0]    [1]    [306.8000]
    '25-Jun-2019'    [176]    [308.2000]    [    0]    [1]    [308.8000]
    '25-Jun-2019'    [176]    [307.3000]    [    0]    [1]    [307.8000]
    '25-Jun-2019'    [176]    [305.7000]    [    0]    [1]    [309.1000]
    '25-Jun-2019'    [176]    [307.1000]    [    0]    [1]    [307.6000]
    '25-Jun-2019'    [176]    [307.6000]    [    0]    [1]    [307.6000]
    '25-Jun-2019'    [176]    [     318]    [    0]    [1]    [310.7000]
    '25-Jun-2019'    [176]    [317.8000]    [    0]    [1]    [308.9000]
    '25-Jun-2019'    [176]    [     318]    [    0]    [1]    [308.6000]
    '25-Jun-2019'    [176]    [317.3000]    [    0]    [1]    [     308]
    '25-Jun-2019'    [176]    [317.7000]    [    0]    [1]    [307.7000]
    '25-Jun-2019'    [176]    [319.1000]    [    0]    [1]    [309.9000]
    '25-Jun-2019'    [176]    [319.8000]    [    0]    [1]    [310.1000]
    '25-Jun-2019'    [176]    [320.5000]    [    0]    [1]    [311.5000]
    '25-Jun-2019'    [176]    [     319]    [    0]    [1]    [310.1000]
    '25-Jun-2019'    [176]    [319.3000]    [    0]    [1]    [311.6000]
    '25-Jun-2019'    [176]    [318.8000]    [    0]    [1]    [309.8000]
    '25-Jun-2019'    [176]    [318.9000]    [    0]    [1]    [309.5000]
    '25-Jun-2019'    [176]    [     318]    [    0]    [1]    [310.1000]
    '25-Jun-2019'    [176]    [     317]    [    0]    [1]    [308.2000]
    '25-Jun-2019'    [176]    [316.8000]    [    0]    [1]    [307.8000]
    '25-Jun-2019'    [176]    [316.8000]    [    0]    [1]    [308.3000]
    '25-Jun-2019'    [176]    [316.5000]    [    0]    [1]    [309.5000]
    '25-Jun-2019'    [176]    [317.4000]    [    0]    [1]    [     308]
    '25-Jun-2019'    [176]    [     318]    [    0]    [1]    [307.5000]
    '25-Jun-2019'    [176]    [316.6000]    [    0]    [1]    [304.9000]
    '25-Jun-2019'    [176]    [316.5000]    [    0]    [1]    [307.2000]
    '25-Jun-2019'    [176]    [315.3000]    [    0]    [1]    [307.2000]
    '25-Jun-2019'    [176]    [315.5000]    [    0]    [1]    [308.4000]
    '25-Jun-2019'    [176]    [314.4000]    [    0]    [1]    [307.5000]
    '25-Jun-2019'    [176]    [315.3000]    [    0]    [1]    [306.9000]
    '25-Jun-2019'    [176]    [314.9000]    [    0]    [1]    [307.8000]
    '25-Jun-2019'    [176]    [314.6000]    [    0]    [1]    [307.5000]
    '25-Jun-2019'    [176]    [313.9000]    [    0]    [1]    [308.1000]
    '25-Jun-2019'    [176]    [311.5000]    [    0]    [1]    [307.2000]
    '25-Jun-2019'    [176]    [313.5000]    [    0]    [1]    [307.7000]
    '25-Jun-2019'    [176]    [     313]    [    0]    [1]    [308.4000]
    '25-Jun-2019'    [176]    [312.8000]    [    0]    [1]    [307.9000]
    '25-Jun-2019'    [176]    [313.4000]    [    0]    [1]    [     309]
    '25-Jun-2019'    [176]    [     313]    [    0]    [1]    [309.2000]
    '25-Jun-2019'    [176]    [314.6000]    [    0]    [1]    [310.9000]
    '25-Jun-2019'    [176]    [314.3000]    [    0]    [1]    [309.2000]
    '25-Jun-2019'    [176]    [310.7000]    [    0]    [1]    [308.6000]
    '25-Jun-2019'    [176]    [311.9000]    [    0]    [1]    [309.9000]
    '25-Jun-2019'    [176]    [311.5000]    [    0]    [1]    [     311]
    '25-Jun-2019'    [176]    [312.1000]    [    0]    [1]    [     311]
    '26-Jun-2019'    [177]    [308.4000]    [    0]    [1]    [308.3000]
    '26-Jun-2019'    [177]    [314.8000]    [    0]    [1]    [309.3000]
    '26-Jun-2019'    [177]    [313.9000]    [    0]    [1]    [309.5000]
    '26-Jun-2019'    [177]    [313.9000]    [    0]    [1]    [308.4000]
    '26-Jun-2019'    [177]    [316.9000]    [    0]    [1]    [     308]
    '26-Jun-2019'    [177]    [316.8000]    [    0]    [1]    [308.8000]
    '26-Jun-2019'    [177]    [315.1000]    [    0]    [1]    [308.5000]
    '26-Jun-2019'    [177]    [316.7000]    [    0]    [1]    [306.1000]
    '26-Jun-2019'    [177]    [315.5000]    [    0]    [1]    [306.5000]
    '26-Jun-2019'    [177]    [317.8000]    [    0]    [1]    [306.7000]
    '26-Jun-2019'    [177]    [317.6000]    [    0]    [2]    [305.6000]
    '26-Jun-2019'    [177]    [317.5000]    [    0]    [1]    [306.7000]
    '26-Jun-2019'    [177]    [320.3000]    [    0]    [1]    [305.4000]
    '26-Jun-2019'    [177]    [320.4000]    [    0]    [1]    [     309]
    '26-Jun-2019'    [177]    [320.4000]    [    0]    [1]    [310.8000]
    '26-Jun-2019'    [177]    [320.9000]    [    0]    [1]    [311.8000]
    '26-Jun-2019'    [177]    [318.4000]    [    0]    [1]    [     309]
    '26-Jun-2019'    [177]    [     320]    [    0]    [1]    [311.1000]
    '26-Jun-2019'    [177]    [318.3000]    [    0]    [1]    [     308]
    '26-Jun-2019'    [177]    [317.3000]    [    0]    [1]    [310.8000]
    '26-Jun-2019'    [177]    [     317]    [    0]    [1]    [308.6000]
    '26-Jun-2019'    [177]    [318.8000]    [    0]    [1]    [308.7000]
    '26-Jun-2019'    [177]    [318.5000]    [    0]    [1]    [310.9000]
    '26-Jun-2019'    [177]    [320.3000]    [    0]    [1]    [309.8000]
    '26-Jun-2019'    [177]    [     320]    [    0]    [1]    [     313]
    '26-Jun-2019'    [177]    [319.9000]    [    0]    [1]    [312.5000]
    '26-Jun-2019'    [177]    [322.1000]    [    0]    [1]    [313.8000]
    '26-Jun-2019'    [177]    [319.4000]    [    0]    [1]    [314.4000]
    '26-Jun-2019'    [177]    [320.4000]    [    0]    [1]    [313.4000]
    '26-Jun-2019'    [177]    [321.1000]    [    0]    [1]    [315.5000]
    '26-Jun-2019'    [177]    [319.3000]    [    0]    [1]    [     317]
    '26-Jun-2019'    [177]    [318.6000]    [    0]    [1]    [317.9000]
    '26-Jun-2019'    [177]    [319.5000]    [    0]    [1]    [316.2000]
    '26-Jun-2019'    [177]    [320.3000]    [    0]    [1]    [318.5000]
    '26-Jun-2019'    [177]    [320.6000]    [    0]    [1]    [319.6000]
    '26-Jun-2019'    [177]    [318.5000]    [    0]    [1]    [319.7000]
    '26-Jun-2019'    [177]    [319.4000]    [    0]    [1]    [318.7000]
    '27-Jun-2019'    [178]    [306.2000]    [    0]    [1]    [306.1000]
    '27-Jun-2019'    [178]    [306.4000]    [    0]    [1]    [306.4000]
    '27-Jun-2019'    [178]    [307.1000]    [    0]    [1]    [306.9000]
    '27-Jun-2019'    [178]    [307.8000]    [    0]    [1]    [306.9000]
    '27-Jun-2019'    [178]    [308.5000]    [    0]    [1]    [307.5000]
    '27-Jun-2019'    [178]    [309.5000]    [    0]    [1]    [307.8000]
    '27-Jun-2019'    [178]    [309.2000]    [    0]    [1]    [308.3000]
    '27-Jun-2019'    [178]    [310.1000]    [    0]    [1]    [307.1000]
    '27-Jun-2019'    [178]    [309.9000]    [    0]    [1]    [     309]
    '27-Jun-2019'    [178]    [315.2000]    [    0]    [1]    [309.6000]
    '27-Jun-2019'    [178]    [314.3000]    [    0]    [1]    [307.4000]
    '27-Jun-2019'    [178]    [312.9000]    [    0]    [1]    [308.7000]
    '27-Jun-2019'    [178]    [315.4000]    [    0]    [1]    [308.8000]
    '27-Jun-2019'    [178]    [314.7000]    [    0]    [1]    [310.4000]
    '27-Jun-2019'    [178]    [315.9000]    [    0]    [1]    [308.5000]
    '27-Jun-2019'    [178]    [314.5000]    [    0]    [1]    [308.7000]
    '27-Jun-2019'    [178]    [319.3000]    [    0]    [2]    [308.6000]
    '27-Jun-2019'    [178]    [319.1000]    [    0]    [1]    [309.5000]
    '27-Jun-2019'    [178]    [318.3000]    [    0]    [1]    [311.4000]
    '27-Jun-2019'    [178]    [319.2000]    [    0]    [1]    [310.9000]
    '27-Jun-2019'    [178]    [319.3000]    [    0]    [1]    [309.7000]
    '27-Jun-2019'    [178]    [320.9000]    [    0]    [2]    [310.7000]
    '27-Jun-2019'    [178]    [320.4000]    [    0]    [1]    [310.7000]
    '27-Jun-2019'    [178]    [320.4000]    [    0]    [1]    [310.6000]
    '27-Jun-2019'    [178]    [322.3000]    [    0]    [1]    [308.9000]
    '27-Jun-2019'    [178]    [320.6000]    [    0]    [1]    [310.8000]
    '27-Jun-2019'    [178]    [317.8000]    [    0]    [1]    [311.4000]
    '27-Jun-2019'    [178]    [322.2000]    [    0]    [1]    [311.1000]
    '27-Jun-2019'    [178]    [321.4000]    [    0]    [1]    [310.3000]
    '27-Jun-2019'    [178]    [     324]    [    0]    [1]    [308.6000]
    '27-Jun-2019'    [178]    [321.4000]    [    0]    [2]    [312.2000]
    '27-Jun-2019'    [178]    [319.9000]    [    0]    [1]    [313.6000]
    '27-Jun-2019'    [178]    [320.2000]    [    0]    [1]    [314.1000]
    '27-Jun-2019'    [178]    [322.2000]    [    0]    [1]    [313.2000]
    '27-Jun-2019'    [178]    [318.7000]    [    0]    [1]    [312.6000]
    '27-Jun-2019'    [178]    [320.2000]    [    0]    [1]    [313.5000]
    '27-Jun-2019'    [178]    [318.8000]    [    0]    [1]    [313.8000]
    '27-Jun-2019'    [178]    [321.8000]    [    0]    [1]    [314.6000]
    '27-Jun-2019'    [178]    [320.1000]    [    0]    [1]    [312.5000]
    '27-Jun-2019'    [178]    [319.5000]    [    0]    [1]    [     315]
    '27-Jun-2019'    [178]    [317.1000]    [    0]    [1]    [     315]
    '27-Jun-2019'    [178]    [316.7000]    [    0]    [1]    [313.6000]
    '27-Jun-2019'    [178]    [316.4000]    [    0]    [1]    [313.5000]
    '27-Jun-2019'    [178]    [316.2000]    [    0]    [1]    [314.6000]
    '27-Jun-2019'    [178]    [316.3000]    [    0]    [1]    [314.1000]
    '27-Jun-2019'    [178]    [316.9000]    [    0]    [1]    [315.8000]
    '27-Jun-2019'    [178]    [     318]    [    0]    [1]    [315.7000]
    '27-Jun-2019'    [178]    [316.6000]    [    0]    [1]    [316.4000]
    '27-Jun-2019'    [178]    [316.6000]    [    0]    [1]    [317.5000]
    '27-Jun-2019'    [178]    [315.7000]    [    0]    [1]    [316.5000]
    '28-Jun-2019'    [179]    [     NaN]    [  NaN]    [0]    [     305]
    '28-Jun-2019'    [179]    [     NaN]    [  NaN]    [0]    [306.4000]
    '28-Jun-2019'    [179]    [     NaN]    [  NaN]    [0]    [306.2000]
    '28-Jun-2019'    [179]    [     NaN]    [  NaN]    [0]    [305.9000]
    '28-Jun-2019'    [179]    [     NaN]    [  NaN]    [0]    [305.6000]
    '28-Jun-2019'    [179]    [     NaN]    [  NaN]    [0]    [305.8000]
    '28-Jun-2019'    [179]    [     NaN]    [  NaN]    [0]    [305.8000]
    '28-Jun-2019'    [179]    [     NaN]    [  NaN]    [0]    [304.7000]
    '28-Jun-2019'    [179]    [     NaN]    [  NaN]    [0]    [305.8000]

  Columns 7 through 10

    'O3 std'    '\%(158-185)/185'    'O3(*)\#158'    'O3std' 
    [     0]    [        -2.7000]    [  336.6000]    [     0]
    [     0]    [        -2.2000]    [  337.6000]    [     0]
    [0.7000]    [             -2]    [  337.4000]    [     1]
    [0.3000]    [        -2.1000]    [  337.8000]    [0.4000]
    [1.1000]    [        -2.1000]    [  336.1000]    [1.1000]
    [     0]    [        -2.7000]    [  335.3000]    [     0]
    [     0]    [             -2]    [  336.1000]    [     0]
    [     0]    [        -2.1000]    [  335.2000]    [     0]
    [     0]    [        -1.9000]    [  336.9000]    [     0]
    [     0]    [        -1.8000]    [  335.8000]    [     0]
    [     0]    [        -1.7000]    [       335]    [     0]
    [     0]    [        -1.8000]    [       335]    [     0]
    [     0]    [        -1.8000]    [  334.2000]    [     0]
    [     0]    [        -2.2000]    [  332.5000]    [     0]
    [0.6000]    [        -1.3000]    [  333.5000]    [0.4000]
    [     0]    [        -1.5000]    [  332.4000]    [     0]
    [     0]    [        -1.6000]    [  332.7000]    [     0]
    [     0]    [        -1.1000]    [  328.7000]    [     0]
    [0.4000]    [        -0.8000]    [  328.9000]    [0.3000]
    [0.4000]    [        -0.6000]    [  328.7000]    [0.4000]
    [     0]    [        -0.5000]    [  329.1000]    [     0]
    [     0]    [        -0.1000]    [  329.5000]    [     0]
    [     0]    [        -0.3000]    [  328.8000]    [     0]
    [     0]    [        -0.5000]    [  328.7000]    [     0]
    [     0]    [        -0.8000]    [  327.8000]    [     0]
    [     0]    [        -0.4000]    [  328.8000]    [     0]
    [     0]    [        -0.4000]    [  329.2000]    [     0]
    [     0]    [        -0.6000]    [  328.5000]    [     0]
    [     0]    [         0.4000]    [  320.1000]    [     0]
    [     0]    [              0]    [  321.2000]    [     0]
    [     0]    [        -0.1000]    [  320.9000]    [     0]
    [     0]    [        -0.1000]    [  321.9000]    [     0]
    [     0]    [        -0.5000]    [  323.8000]    [     0]
    [     0]    [        -0.5000]    [       325]    [     0]
    [     0]    [        -0.6000]    [  325.2000]    [     0]
    [     0]    [        -0.8000]    [  324.6000]    [     0]
    [     0]    [        -0.7000]    [       325]    [     0]
    [     0]    [        -0.7000]    [  325.3000]    [     0]
    [     0]    [        -0.9000]    [  327.3000]    [     0]
    [     0]    [        -1.1000]    [  324.6000]    [     0]
    [     0]    [        -1.9000]    [  329.3000]    [     0]
    [     0]    [        -1.5000]    [  329.3000]    [     0]
    [     0]    [             -2]    [  327.8000]    [     0]
    [     0]    [        -1.2000]    [  326.8000]    [     0]
    [     0]    [        -1.6000]    [  331.4000]    [     0]
    [     0]    [        -2.4000]    [  330.7000]    [     0]
    [     0]    [        -2.5000]    [  329.6000]    [     0]
    [     0]    [        -2.1000]    [  329.4000]    [     0]
    [     0]    [        -1.4000]    [  331.4000]    [     0]
    [1.8000]    [        -2.1000]    [  330.2000]    [1.6000]
    [     0]    [        -1.6000]    [  332.3000]    [     0]
    [     0]    [        -2.7000]    [  329.2000]    [     0]
    [     0]    [        -2.5000]    [  329.4000]    [0.1000]
    [     0]    [        -2.4000]    [  332.9000]    [     0]
    [     0]    [        -2.4000]    [  330.9000]    [     0]
    [1.7000]    [        -3.3000]    [  331.4000]    [1.6000]
    [0.6000]    [             -3]    [  331.6000]    [0.5000]
    [     0]    [             -3]    [  332.2000]    [     0]
    [     0]    [        -2.7000]    [  333.1000]    [     0]
    [     0]    [             -3]    [  332.5000]    [     0]
    [0.5000]    [        -3.1000]    [       333]    [0.4000]
    [     0]    [        -3.5000]    [  331.7000]    [     0]
    [0.5000]    [        -3.3000]    [  332.2000]    [0.4000]
    [     0]    [        -3.2000]    [  332.1000]    [     0]
    [     0]    [        -3.5000]    [  331.8000]    [     0]
    [     0]    [        -3.5000]    [  332.6000]    [     0]
    [     0]    [        -3.1000]    [  334.4000]    [     0]
    [     0]    [        -2.5000]    [  334.3000]    [     0]
    [     0]    [        -3.5000]    [  331.7000]    [     0]
    [     0]    [        -3.2000]    [  333.2000]    [     0]
    [     0]    [        -3.6000]    [  331.6000]    [     0]
    [     0]    [        -3.1000]    [  331.6000]    [     0]
    [     0]    [        -3.8000]    [  330.1000]    [     0]
    [     0]    [        -4.2000]    [  328.3000]    [     0]
    [     0]    [        -3.2000]    [       331]    [     0]
    [     0]    [        -3.8000]    [  329.4000]    [     0]
    [     0]    [        -3.6000]    [  330.4000]    [     0]
    [0.3000]    [        -3.2000]    [  330.9000]    [0.5000]
    [     0]    [        -2.9000]    [  330.8000]    [     0]
    [     0]    [        -3.2000]    [  331.3000]    [     0]
    [     0]    [        -3.5000]    [  329.3000]    [     0]
    [     0]    [        -3.6000]    [  330.5000]    [     0]
    [     0]    [             -3]    [       332]    [     0]
    [     0]    [             -3]    [  331.6000]    [     0]
    [     0]    [        -3.1000]    [  331.5000]    [     0]
    [     0]    [        -2.5000]    [  333.2000]    [     0]
    [     0]    [        -2.7000]    [  332.3000]    [     0]
    [     0]    [        -2.1000]    [       326]    [     0]
    [     0]    [        -3.2000]    [  329.8000]    [     0]
    [     0]    [        -2.5000]    [  330.7000]    [     0]
    [     0]    [        -1.6000]    [  330.5000]    [     0]
    [0.9000]    [        -1.7000]    [  326.2000]    [0.2000]
    [     0]    [        -2.1000]    [  332.2000]    [     0]
    [     0]    [        -2.1000]    [  332.2000]    [     0]
    [0.9000]    [        -1.7000]    [  331.7000]    [     1]
    [     0]    [        -1.5000]    [  325.4000]    [     0]
    [     0]    [        -2.2000]    [  325.6000]    [     0]
    [     0]    [        -1.7000]    [  329.8000]    [     0]
    [     0]    [        -2.6000]    [  327.7000]    [     0]
    [0.3000]    [        -1.8000]    [  329.4000]    [     0]
    [     0]    [             -1]    [  325.5000]    [     0]
    [     0]    [        -1.4000]    [  324.1000]    [     0]
    [     0]    [        -0.6000]    [       324]    [     0]
    [     0]    [        -0.4000]    [  325.5000]    [     0]
    [     0]    [        -0.5000]    [       326]    [     0]
    [     0]    [        -0.9000]    [  325.6000]    [     0]
    [     0]    [        -0.2000]    [  326.5000]    [     0]
    [     0]    [        -0.6000]    [  326.3000]    [     0]
    [     0]    [        -0.4000]    [  325.5000]    [     0]
    [     0]    [         0.1000]    [  325.2000]    [     0]
    [     0]    [        -0.5000]    [  324.2000]    [     0]
    [     0]    [        -0.6000]    [  324.7000]    [     0]
    [     0]    [         0.5000]    [  313.1000]    [     0]
    [     0]    [         0.2000]    [  312.3000]    [     0]
    [     0]    [         0.2000]    [  312.3000]    [     0]
    [     0]    [         0.4000]    [       311]    [     0]
    [     0]    [        -0.1000]    [  310.3000]    [     0]
    [     0]    [         0.4000]    [       311]    [     0]
    [     0]    [         0.4000]    [  310.2000]    [     0]
    [     0]    [        -0.5000]    [  309.1000]    [     0]
    [     0]    [        -0.9000]    [       308]    [     0]
    [     0]    [        -1.1000]    [  308.7000]    [     0]
    [     0]    [        -2.7000]    [  311.7000]    [     0]
    [     0]    [         0.2000]    [  309.2000]    [     0]
    [     0]    [         0.2000]    [  308.7000]    [     0]
    [     0]    [         1.1000]    [  310.1000]    [     0]
    [     0]    [         0.2000]    [  308.7000]    [     0]
    [     0]    [              0]    [  309.3000]    [     0]
    [     0]    [        -2.3000]    [  317.9000]    [     0]
    [     0]    [        -2.8000]    [  316.3000]    [     0]
    [     0]    [             -3]    [  316.5000]    [     0]
    [     0]    [        -2.9000]    [       316]    [     0]
    [     0]    [        -3.1000]    [  315.9000]    [     0]
    [     0]    [        -2.9000]    [  317.9000]    [     0]
    [     0]    [             -3]    [  318.4000]    [     0]
    [     0]    [        -2.8000]    [  320.1000]    [     0]
    [     0]    [        -2.8000]    [       319]    [     0]
    [     0]    [        -2.4000]    [  320.2000]    [     0]
    [     0]    [        -2.8000]    [  318.3000]    [     0]
    [     0]    [        -2.9000]    [       318]    [     0]
    [     0]    [        -2.5000]    [  318.6000]    [     0]
    [     0]    [        -2.8000]    [  316.9000]    [     0]
    [     0]    [        -2.8000]    [       316]    [     0]
    [     0]    [        -2.7000]    [  317.2000]    [     0]
    [     0]    [        -2.2000]    [  317.6000]    [     0]
    [     0]    [             -3]    [  316.2000]    [     0]
    [     0]    [        -3.3000]    [  315.8000]    [     0]
    [     0]    [        -3.7000]    [  312.6000]    [     0]
    [     0]    [        -2.9000]    [       315]    [     0]
    [     0]    [        -2.6000]    [  314.7000]    [     0]
    [     0]    [        -2.3000]    [  315.7000]    [     0]
    [     0]    [        -2.2000]    [  314.5000]    [     0]
    [     0]    [        -2.7000]    [  313.8000]    [     0]
    [     0]    [        -2.3000]    [  314.2000]    [     0]
    [     0]    [        -2.3000]    [  313.8000]    [     0]
    [     0]    [        -1.8000]    [  314.3000]    [     0]
    [     0]    [        -1.4000]    [  312.9000]    [     0]
    [     0]    [        -1.9000]    [       313]    [     0]
    [     0]    [        -1.5000]    [  313.8000]    [     0]
    [     0]    [        -1.6000]    [  312.5000]    [     0]
    [     0]    [        -1.4000]    [  313.6000]    [     0]
    [     0]    [        -1.2000]    [  313.2000]    [     0]
    [     0]    [        -1.2000]    [  314.5000]    [     0]
    [     0]    [        -1.6000]    [  312.8000]    [     0]
    [     0]    [        -0.7000]    [       310]    [     0]
    [     0]    [        -0.6000]    [  311.1000]    [     0]
    [     0]    [        -0.2000]    [  311.4000]    [     0]
    [     0]    [        -0.4000]    [  311.2000]    [     0]
    [     0]    [              0]    [  309.8000]    [     0]
    [     0]    [        -1.7000]    [  315.5000]    [     0]
    [     0]    [        -1.4000]    [  315.8000]    [     0]
    [     0]    [        -1.8000]    [  314.4000]    [     0]
    [     0]    [        -2.8000]    [  315.3000]    [     0]
    [     0]    [        -2.5000]    [  316.3000]    [     0]
    [     0]    [        -2.1000]    [       316]    [     0]
    [     0]    [        -3.3000]    [  314.1000]    [     0]
    [     0]    [        -2.9000]    [  314.7000]    [     0]
    [     0]    [        -3.5000]    [  314.9000]    [     0]
    [     1]    [        -3.8000]    [  313.8000]    [0.8000]
    [     0]    [        -3.4000]    [       315]    [     0]
    [     0]    [        -4.7000]    [  314.2000]    [     0]
    [     0]    [        -3.6000]    [  317.6000]    [     0]
    [     0]    [             -3]    [  319.3000]    [     0]
    [     0]    [        -2.8000]    [  320.1000]    [     0]
    [     0]    [             -3]    [  317.5000]    [     0]
    [     0]    [        -2.8000]    [  319.2000]    [     0]
    [     0]    [        -3.2000]    [  315.7000]    [     0]
    [     0]    [             -2]    [  317.6000]    [     0]
    [     0]    [        -2.6000]    [  315.5000]    [     0]
    [     0]    [        -3.2000]    [  315.5000]    [     0]
    [     0]    [        -2.4000]    [  317.2000]    [     0]
    [     0]    [        -3.3000]    [  315.9000]    [     0]
    [     0]    [        -2.2000]    [  318.5000]    [     0]
    [     0]    [        -2.3000]    [       318]    [     0]
    [     0]    [        -2.6000]    [  318.9000]    [     0]
    [     0]    [        -1.6000]    [  319.1000]    [     0]
    [     0]    [        -2.2000]    [       318]    [     0]
    [     0]    [        -1.7000]    [       320]    [     0]
    [     0]    [        -0.7000]    [  318.7000]    [     0]
    [     0]    [        -0.2000]    [  319.5000]    [     0]
    [     0]    [             -1]    [  317.9000]    [     0]
    [     0]    [        -0.6000]    [  319.7000]    [     0]
    [     0]    [        -0.3000]    [  320.7000]    [     0]
    [     0]    [         0.4000]    [  320.3000]    [     0]
    [     0]    [        -0.2000]    [  318.9000]    [     0]
    [     0]    [              0]    [  306.6000]    [     0]
    [     0]    [              0]    [  307.6000]    [     0]
    [     0]    [        -0.1000]    [  308.3000]    [     0]
    [     0]    [        -0.3000]    [  308.5000]    [     0]
    [     0]    [        -0.3000]    [  309.4000]    [     0]
    [     0]    [        -0.5000]    [  309.7000]    [     0]
    [     0]    [        -0.3000]    [  310.3000]    [     0]
    [     0]    [             -1]    [  309.5000]    [     0]
    [     0]    [        -0.3000]    [  314.1000]    [     0]
    [     0]    [        -1.8000]    [  314.6000]    [     0]
    [     0]    [        -2.2000]    [  312.7000]    [     0]
    [     0]    [        -1.3000]    [  314.3000]    [     0]
    [     0]    [        -2.1000]    [  314.5000]    [     0]
    [     0]    [        -1.4000]    [  316.8000]    [     0]
    [     0]    [        -2.3000]    [  314.6000]    [     0]
    [     0]    [        -1.8000]    [  315.5000]    [     0]
    [1.2000]    [        -3.4000]    [  315.7000]    [0.9000]
    [     0]    [             -3]    [  317.3000]    [     0]
    [     0]    [        -2.2000]    [  319.1000]    [     0]
    [     0]    [        -2.6000]    [  318.8000]    [     0]
    [     0]    [             -3]    [  317.6000]    [     0]
    [0.8000]    [        -3.2000]    [  318.9000]    [0.8000]
    [     0]    [             -3]    [  319.3000]    [     0]
    [     0]    [        -3.1000]    [  318.9000]    [     0]
    [     0]    [        -4.2000]    [  317.3000]    [     0]
    [     0]    [        -3.1000]    [  319.3000]    [     0]
    [     0]    [             -2]    [  319.6000]    [     0]
    [     0]    [        -3.4000]    [  319.3000]    [     0]
    [     0]    [        -3.5000]    [  318.2000]    [     0]
    [     0]    [        -4.8000]    [  316.9000]    [     0]
    [     1]    [        -2.9000]    [  319.7000]    [0.9000]
    [     0]    [             -2]    [  320.6000]    [     0]
    [     0]    [        -1.9000]    [  320.7000]    [     0]
    [     0]    [        -2.8000]    [  319.6000]    [     0]
    [     0]    [        -1.9000]    [  318.9000]    [     0]
    [     0]    [        -2.1000]    [  319.6000]    [     0]
    [     0]    [        -1.6000]    [  319.5000]    [     0]
    [     0]    [        -2.2000]    [  320.1000]    [     0]
    [     0]    [        -2.4000]    [       318]    [     0]
    [     0]    [        -1.4000]    [  320.1000]    [     0]
    [     0]    [        -0.7000]    [  319.8000]    [     0]
    [     0]    [             -1]    [  316.1000]    [     0]
    [     0]    [        -0.9000]    [  315.4000]    [     0]
    [     0]    [        -0.5000]    [  316.5000]    [     0]
    [     0]    [        -0.7000]    [  315.9000]    [     0]
    [     0]    [        -0.3000]    [  317.1000]    [     0]
    [     0]    [        -0.7000]    [  316.8000]    [     0]
    [     0]    [        -0.1000]    [       317]    [     0]
    [     0]    [         0.3000]    [       318]    [     0]
    [     0]    [         0.3000]    [  316.9000]    [     0]
    [     0]    [            NaN]    [  305.5000]    [     0]
    [     0]    [            NaN]    [  306.9000]    [     0]
    [     0]    [            NaN]    [  307.1000]    [     0]
    [     0]    [            NaN]    [       307]    [     0]
    [     0]    [            NaN]    [  306.8000]    [     0]
    [     0]    [            NaN]    [  307.4000]    [     0]
    [     0]    [            NaN]    [  307.3000]    [     0]
    [     0]    [            NaN]    [  306.7000]    [     0]
    [     0]    [            NaN]    [  307.9000]    [     0]

  Column 11

    '(*)\%(158-185)/185'
    [           -0.7000]
    [           -0.3000]
    [           -0.2000]
    [           -0.4000]
    [           -0.4000]
    [                -1]
    [           -0.4000]
    [           -0.4000]
    [           -0.4000]
    [           -0.3000]
    [           -0.3000]
    [           -0.5000]
    [           -0.5000]
    [                -1]
    [           -0.1000]
    [           -0.4000]
    [           -0.4000]
    [           -0.6000]
    [           -0.3000]
    [           -0.2000]
    [           -0.2000]
    [            0.1000]
    [           -0.2000]
    [           -0.4000]
    [           -0.8000]
    [           -0.3000]
    [           -0.3000]
    [           -0.5000]
    [            0.6000]
    [            0.3000]
    [            0.3000]
    [            0.3000]
    [            0.1000]
    [            0.2000]
    [                 0]
    [           -0.1000]
    [                 0]
    [            0.1000]
    [            0.6000]
    [           -0.3000]
    [           -0.4000]
    [            0.1000]
    [           -0.4000]
    [           -0.2000]
    [            0.2000]
    [           -0.6000]
    [           -0.6000]
    [           -0.2000]
    [            0.5000]
    [           -0.2000]
    [            0.4000]
    [           -0.7000]
    [           -0.5000]
    [           -0.3000]
    [           -0.3000]
    [                -1]
    [           -0.8000]
    [           -0.5000]
    [           -0.3000]
    [           -0.6000]
    [           -0.7000]
    [                -1]
    [           -0.9000]
    [           -0.7000]
    [           -1.1000]
    [                -1]
    [           -0.7000]
    [           -0.1000]
    [                -1]
    [           -0.7000]
    [           -1.1000]
    [           -0.7000]
    [           -1.2000]
    [           -1.7000]
    [           -0.7000]
    [           -1.3000]
    [           -1.3000]
    [           -0.9000]
    [           -0.6000]
    [           -0.9000]
    [           -1.3000]
    [           -1.2000]
    [           -0.8000]
    [           -0.7000]
    [           -0.9000]
    [           -0.4000]
    [           -0.7000]
    [           -0.9000]
    [           -1.2000]
    [           -0.5000]
    [            0.3000]
    [           -0.7000]
    [           -0.2000]
    [           -0.2000]
    [                 0]
    [           -0.5000]
    [           -1.3000]
    [                 0]
    [           -0.9000]
    [           -0.1000]
    [           -0.2000]
    [           -0.8000]
    [            0.1000]
    [            0.2000]
    [                 0]
    [           -0.5000]
    [            0.2000]
    [           -0.3000]
    [           -0.1000]
    [            0.3000]
    [           -0.3000]
    [           -0.4000]
    [            0.6000]
    [            0.4000]
    [            0.4000]
    [            0.5000]
    [            0.2000]
    [            0.8000]
    [            0.8000]
    [                 0]
    [           -0.2000]
    [           -0.3000]
    [           -1.1000]
    [            0.3000]
    [            0.5000]
    [            1.4000]
    [            0.5000]
    [            0.6000]
    [                 0]
    [           -0.5000]
    [           -0.5000]
    [           -0.4000]
    [           -0.6000]
    [           -0.4000]
    [           -0.4000]
    [           -0.1000]
    [                 0]
    [            0.3000]
    [           -0.2000]
    [           -0.3000]
    [            0.2000]
    [                 0]
    [           -0.3000]
    [            0.1000]
    [            0.3000]
    [           -0.4000]
    [           -0.7000]
    [           -1.3000]
    [           -0.5000]
    [           -0.2000]
    [            0.1000]
    [                 0]
    [           -0.5000]
    [           -0.2000]
    [           -0.3000]
    [            0.1000]
    [            0.4000]
    [           -0.2000]
    [            0.3000]
    [           -0.1000]
    [            0.1000]
    [            0.1000]
    [                 0]
    [           -0.5000]
    [           -0.2000]
    [           -0.3000]
    [                 0]
    [           -0.3000]
    [            0.5000]
    [            0.2000]
    [            0.6000]
    [            0.2000]
    [           -0.5000]
    [           -0.2000]
    [            0.3000]
    [           -0.8000]
    [           -0.3000]
    [           -0.9000]
    [           -1.2000]
    [           -0.8000]
    [           -1.9000]
    [           -0.9000]
    [           -0.3000]
    [           -0.2000]
    [           -0.3000]
    [           -0.3000]
    [           -0.8000]
    [            0.1000]
    [           -0.5000]
    [                -1]
    [           -0.4000]
    [           -1.4000]
    [           -0.5000]
    [           -0.6000]
    [                -1]
    [           -0.1000]
    [           -0.7000]
    [           -0.3000]
    [           -0.2000]
    [            0.3000]
    [           -0.5000]
    [           -0.2000]
    [                 0]
    [            0.6000]
    [           -0.2000]
    [            0.1000]
    [            0.4000]
    [            0.4000]
    [            0.2000]
    [            0.3000]
    [            0.1000]
    [            0.4000]
    [           -0.2000]
    [            1.4000]
    [           -0.2000]
    [           -0.5000]
    [            0.4000]
    [           -0.3000]
    [            0.7000]
    [           -0.4000]
    [            0.3000]
    [           -1.1000]
    [           -0.6000]
    [            0.3000]
    [           -0.1000]
    [           -0.5000]
    [           -0.6000]
    [           -0.3000]
    [           -0.5000]
    [           -1.6000]
    [           -0.4000]
    [            0.6000]
    [           -0.9000]
    [                -1]
    [           -2.2000]
    [           -0.5000]
    [            0.2000]
    [            0.2000]
    [           -0.8000]
    [            0.1000]
    [           -0.2000]
    [            0.2000]
    [           -0.5000]
    [           -0.7000]
    [            0.2000]
    [            0.9000]
    [           -0.2000]
    [           -0.3000]
    [            0.1000]
    [           -0.1000]
    [            0.1000]
    [           -0.4000]
    [            0.1000]
    [            0.4000]
    [            0.4000]
    [               NaN]
    [               NaN]
    [               NaN]
    [               NaN]
    [               NaN]
    [               NaN]
    [               NaN]
    [               NaN]
    [               NaN]

</pre><h2 id="40">Summary  Final Comparison all data detailed for osc ranges</h2><pre class="codeinput">TIME_SYNC=5;
<span class="comment">%rowlabels=regexprep(str_leg, '#', '\#');</span>
caption=strcat(<span class="string">'Ozone Summary Report. Mean daily ozone, grouped by ozone slant path ranges,'</span>,<span class="keyword">...</span>
               <span class="string">' with original and final configuration (with an asterisk)'</span>);
tags_={<span class="string">'osc$&gt;$1500'</span> <span class="string">'1500$&gt;$osc$&gt;$1000'</span> <span class="string">'1000$&gt;$osc$&gt;$700'</span> <span class="string">'700$&gt;$osc$&gt;$400'</span> <span class="string">'osc$&lt;$400'</span>};
label_={<span class="string">'Day'</span>,<span class="string">'osc range'</span>,[<span class="string">'O3#'</span>,brw_str{n_ref}],<span class="string">'O3std'</span>,<span class="string">'N'</span>,<span class="keyword">...</span>
                          [<span class="string">'O3#'</span>,brw_str{n_inst}],<span class="string">'O3 std'</span>,<span class="string">'%diff'</span>,<span class="keyword">...</span>
                          [<span class="string">'(*)O3#'</span>,brw_str{n_inst}],<span class="string">'O3 std'</span>,<span class="string">'(*)%diff'</span>};

ozone_osc_sum=o3_daily_osc(Cal,TIME_SYNC,n_ref,ETC_SUG,A1_old,summary_orig_old,summary_old,summary);
dat=cat(2,num2cell(ozone_osc_sum(:,1)),tags_(ozone_osc_sum(:,end))',num2cell(ozone_osc_sum(:,2:end-1)));

displaytable(dat,label_,12);
matrix2latex_longtable(dat,fullfile(Cal.file_latex,[<span class="string">'table_summarydetailed_'</span>,brw_str{n_inst},<span class="string">'.tex'</span>]),<span class="keyword">...</span>
                                   <span class="string">'size'</span>,<span class="string">'tiny'</span>,<span class="string">'columnlabels'</span>,str2latex(label_),<span class="string">'alignment'</span>,<span class="string">'c'</span>,<span class="keyword">...</span>
                                   <span class="string">'format'</span>,{<span class="string">'%.0f'</span>,<span class="string">'%s'</span>,<span class="string">'%.0f'</span>,<span class="string">'%.1f'</span>,<span class="string">'%.0f'</span>,<span class="string">'%.0f'</span>,<span class="string">'%.1f'</span>,<span class="string">'%.1f'</span>,<span class="string">'%.0f'</span>,<span class="string">'%.1f'</span>,<span class="string">'%.1f'</span>},<span class="keyword">...</span>
                                   <span class="string">'caption'</span>,caption);
</pre><pre class="codeoutput">         Day |    osc range |       O3#185 |        O3std |            N |       O3#158 |       O3 std |        %diff |    (*)O3#158 |       O3 std |     (*)%diff
         170 | 1000$&gt;$osc$&gt; |        320.8 |          1.4 |            4 |        322.3 |          1.2 |          0.5 |        323.7 |          1.3 |          0.9
         170 | 700$&gt;$osc$&gt;$ |        331.9 |          3.6 |           13 |        326.7 |          3.2 |         -1.6 |        332.6 |          3.2 |          0.2
         170 |    osc$&lt;$400 |        331.1 |          2.2 |           31 |        324.9 |          2.1 |         -1.9 |        332.3 |          2.1 |          0.4
         171 | 1500$&gt;$osc$&gt; |        329.5 |          6.4 |            9 |        331.1 |          5.3 |          0.5 |        332.3 |          5.4 |          0.8
         171 | 1000$&gt;$osc$&gt; |        329.1 |            6 |           10 |        329.9 |          4.9 |          0.2 |        331.6 |          4.9 |          0.7
         171 | 700$&gt;$osc$&gt;$ |        333.4 |          5.1 |           16 |        330.4 |          4.7 |         -0.9 |        334.5 |          5.7 |          0.3
         171 |    osc$&lt;$400 |        343.8 |          1.1 |           14 |          337 |          1.7 |           -2 |        344.5 |          1.8 |          0.2
         172 |   osc$&gt;$1500 |        325.3 |            0 |            1 |          326 |            0 |          0.2 |          327 |            0 |          0.5
         172 | 1500$&gt;$osc$&gt; |        331.9 |          3.7 |            6 |        332.2 |          3.7 |          0.1 |        333.7 |          3.7 |          0.5
         172 | 1000$&gt;$osc$&gt; |        333.9 |          1.8 |            6 |        333.9 |          2.4 |           -0 |        335.9 |          2.4 |          0.6
         172 | 700$&gt;$osc$&gt;$ |        342.3 |          4.1 |           30 |        337.5 |          2.9 |         -1.4 |        343.4 |          4.5 |          0.3
         172 |    osc$&lt;$400 |        345.7 |          1.6 |           55 |        338.9 |          1.9 |           -2 |        347.2 |          1.9 |          0.4
         173 |   osc$&gt;$1500 |        322.3 |            0 |            2 |        322.2 |          0.5 |           -0 |        323.1 |          0.5 |          0.2
         173 | 1500$&gt;$osc$&gt; |        326.8 |          0.7 |            7 |        326.1 |          1.2 |         -0.2 |        327.3 |          1.3 |          0.2
         173 | 1000$&gt;$osc$&gt; |        328.8 |          0.9 |            9 |        328.1 |          0.7 |         -0.2 |        329.7 |          0.7 |          0.3
         173 | 700$&gt;$osc$&gt;$ |        333.9 |          3.3 |           28 |        329.4 |          1.9 |         -1.4 |        334.2 |          3.2 |          0.1
         174 | 1500$&gt;$osc$&gt; |        320.7 |          4.9 |            8 |        323.2 |          3.3 |          0.8 |        323.2 |          3.3 |          0.8
         174 | 1000$&gt;$osc$&gt; |          322 |          3.7 |           14 |        322.4 |          2.3 |          0.1 |        323.2 |          2.4 |          0.4
         174 | 700$&gt;$osc$&gt;$ |        327.6 |          2.8 |           39 |        323.7 |          1.3 |         -1.2 |          328 |          2.7 |          0.1
         174 |    osc$&lt;$400 |        332.5 |          1.8 |           45 |        323.9 |          1.4 |         -2.6 |        331.2 |          1.9 |         -0.4
         175 | 1500$&gt;$osc$&gt; |        306.7 |          1.3 |            6 |        310.7 |          0.6 |          1.3 |        310.5 |          0.6 |          1.2
         175 | 1000$&gt;$osc$&gt; |        309.5 |          1.2 |            6 |        311.4 |          1.2 |          0.6 |        311.7 |          1.1 |          0.7
         175 | 700$&gt;$osc$&gt;$ |        308.9 |          2.6 |            6 |        307.7 |          1.1 |         -0.4 |        309.6 |          1.3 |          0.2
         176 |   osc$&gt;$1500 |        307.5 |          1.9 |            2 |        307.5 |          2.5 |            0 |        307.1 |          2.7 |         -0.1
         176 | 1500$&gt;$osc$&gt; |        308.3 |          2.3 |            7 |        309.8 |          0.8 |          0.5 |        309.6 |          0.8 |          0.4
         176 | 1000$&gt;$osc$&gt; |        308.4 |          2.5 |            7 |        309.3 |          1.4 |          0.3 |          310 |          1.2 |          0.5
         176 | 700$&gt;$osc$&gt;$ |        311.8 |          1.9 |           13 |        308.4 |          1.1 |         -1.1 |        312.7 |          1.6 |          0.3
         176 |    osc$&lt;$400 |        316.1 |          1.5 |           26 |        308.4 |          1.5 |         -2.4 |        316.7 |          1.9 |          0.2
         177 |   osc$&gt;$1500 |        314.5 |            0 |            1 |        317.9 |            0 |          1.1 |        317.3 |            0 |          0.9
         177 | 1000$&gt;$osc$&gt; |        318.4 |          0.5 |            3 |        319.2 |          0.6 |          0.3 |        319.5 |          0.7 |          0.4
         177 | 700$&gt;$osc$&gt;$ |        316.8 |          4.2 |           17 |        313.3 |          3.9 |         -1.1 |          317 |          3.4 |          0.1
         177 |    osc$&lt;$400 |        316.8 |          1.6 |           20 |        308.5 |            2 |         -2.6 |        316.2 |          1.9 |         -0.2
         178 | 1500$&gt;$osc$&gt; |        311.5 |          4.7 |            4 |        312.5 |          4.6 |          0.3 |        312.6 |          4.4 |          0.4
         178 | 1000$&gt;$osc$&gt; |        310.2 |          5.2 |            7 |        310.9 |          5.5 |          0.2 |        311.8 |          5.2 |          0.5
         178 | 700$&gt;$osc$&gt;$ |        314.2 |          4.1 |           23 |        311.5 |          3.2 |         -0.9 |        315.3 |          3.8 |          0.3
         178 |    osc$&lt;$400 |        318.4 |          2.3 |           24 |        310.5 |          1.7 |         -2.5 |        318.3 |          1.7 |           -0
         179 | 1500$&gt;$osc$&gt; |        303.7 |            0 |            1 |          NaN |          NaN |          NaN |        305.6 |            0 |          0.6
         179 | 1000$&gt;$osc$&gt; |        304.2 |          0.9 |            5 |          NaN |          NaN |          NaN |        306.6 |          0.7 |          0.8
         179 | 700$&gt;$osc$&gt;$ |        305.7 |          0.6 |            4 |          NaN |          NaN |          NaN |        307.3 |          0.5 |          0.5
</pre><pre class="codeinput">[m,s,n,grpn]=grpstats(ozone_osc_sum,{ozone_osc_sum(:,1)},{<span class="string">'mean'</span>,<span class="string">'std'</span>,<span class="string">'numel'</span>,<span class="string">'gname'</span>});
ozone_day_sum=round([m(:,1),m(:,2),s(:,2),m(:,4),m(:,8),s(:,8),100*(m(:,8)-m(:,2))./m(:,2)]*10)/10;

 makeHtmlTable(ozone_day_sum,[],cellstr(datestr(ozone_day_sum(:,1)+datenum(Cal.Date.cal_year,1,0))),<span class="keyword">...</span>
        {<span class="string">'Day'</span>,[<span class="string">'O3 #'</span>,brw_str{n_ref}],<span class="string">'O3 std'</span>,<span class="string">'N obs'</span>,[<span class="string">'O3 #'</span>,brw_str{n_inst}],<span class="keyword">...</span>
         <span class="string">'O3 std'</span>,[<span class="string">' % '</span>,brw_str{n_ref},<span class="string">'-'</span>,brw_str{n_inst},<span class="string">'/'</span>,brw_str{n_ref}]})
</pre><table border="1" cellpadding="4" cellspacing="0">
<tr><td></td><td>Day</td><td>O3 #185</td><td>O3 std</td><td>N obs</td><td>O3 #158</td><td>O3 std</td><td> % 185-158/185</td></tr>
<tr><td>19-Jun-2019</td><td>170</td><td>327.9</td><td>6.2</td><td>16</td><td>329.5</td><td>5.1</td><td>0.5</td></tr>
<tr><td>20-Jun-2019</td><td>171</td><td>334</td><td>6.8</td><td>12.3</td><td>335.7</td><td>6</td><td>0.5</td></tr>
<tr><td>21-Jun-2019</td><td>172</td><td>335.8</td><td>8.2</td><td>19.6</td><td>337.4</td><td>8</td><td>0.5</td></tr>
<tr><td>22-Jun-2019</td><td>173</td><td>328</td><td>4.8</td><td>11.5</td><td>328.6</td><td>4.6</td><td>0.2</td></tr>
<tr><td>23-Jun-2019</td><td>174</td><td>325.7</td><td>5.4</td><td>26.5</td><td>326.4</td><td>3.9</td><td>0.2</td></tr>
<tr><td>24-Jun-2019</td><td>175</td><td>308.4</td><td>1.5</td><td>6</td><td>310.6</td><td>1.1</td><td>0.7</td></tr>
<tr><td>25-Jun-2019</td><td>176</td><td>310.4</td><td>3.6</td><td>11</td><td>311.2</td><td>3.7</td><td>0.3</td></tr>
<tr><td>26-Jun-2019</td><td>177</td><td>316.6</td><td>1.6</td><td>10.3</td><td>317.5</td><td>1.4</td><td>0.3</td></tr>
<tr><td>27-Jun-2019</td><td>178</td><td>313.6</td><td>3.6</td><td>14.5</td><td>314.5</td><td>2.9</td><td>0.3</td></tr>
<tr><td>28-Jun-2019</td><td>179</td><td>304.5</td><td>1</td><td>3.3</td><td>306.5</td><td>0.9</td><td>0.6</td></tr>
</table><h2 id="42">Plot daily summary</h2><pre class="codeinput">close <span class="string">all</span>
figure; set(gcf,<span class="string">'Tag'</span>,<span class="string">'_GlobalPlot_'</span>);
plot(summary{n_ref}(:,1),summary{n_ref}(:,6),<span class="string">'g*'</span>,<span class="string">'MarkerSize'</span>,5);
hold <span class="string">on</span>; plot(summary{Cal.n_inst}(:,1),summary{Cal.n_inst}(:,6),<span class="string">'b.'</span>,<span class="string">'MarkerSize'</span>,12);
legend(gca,Cal.brw_name{n_ref},Cal.brw_name{Cal.n_inst},<span class="string">'Location'</span>,<span class="string">'Best'</span>,<span class="keyword">...</span>
                                                               <span class="string">'Orientation'</span>,<span class="string">'Horizontal'</span>);
ylabel(<span class="string">'Total Ozone (DU)'</span>); xlabel(<span class="string">'Date'</span>); grid;
title(Cal.campaign);
datetick(<span class="string">'x'</span>,6,<span class="string">'keepLimits'</span>,<span class="string">'KeepTicks'</span>);


f0=figure;

<span class="comment">% blind days: suggested config.</span>
<span class="keyword">if</span> ~Cal.no_maint(Cal.n_inst)     <span class="comment">% if the instrument has changed due to maintenance</span>
   inst1_b      =summary_old{Cal.n_inst}(findm(diaj(summary_old{Cal.n_inst}(:,1)),blinddays,0.5),:);
   inst1_b(:,10)=(inst1_b(:,9)-ETC_SUG(1).NEW)./(A1_old*inst1_b(:,3)*10);
   <span class="keyword">for</span> dd=1:length(blinddays)
      j=find(diajul(floor(inst1_b(:,1)))==blinddays(dd));
      j_=find(diajul(floor(ref(:,1)))==blinddays(dd));
      <span class="keyword">if</span> (isempty(j) || length(j)&lt;4), <span class="keyword">continue</span>; <span class="keyword">end</span>
         f=figure;
         set(f,<span class="string">'Tag'</span>,sprintf(<span class="string">'%s%s'</span>,<span class="string">'DayPlot_'</span>,num2str(blinddays(dd))));
         h1=gscatter(ref(j_,1),ref(j_,6),ref(j_,5),<span class="string">'g'</span>,<span class="string">'x+o.sp'</span>); set(h1,<span class="string">'MarkerSize'</span>,6,<span class="string">'MarkerFaceColor'</span>,<span class="string">'g'</span>);
         hold <span class="string">on</span>; h2=gscatter(inst1_b(j,1),inst1_b(j,10),inst1_b(j,5),<span class="string">'b'</span>,<span class="string">'x+o.sp'</span>); set(h2,<span class="string">'MarkerSize'</span>,6,<span class="string">'MarkerFaceColor'</span>,<span class="string">'b'</span>);
         hold <span class="string">on</span>; h3=gscatter(inst1_b(j,1),inst1_b(j,6),inst1_b(j,5),<span class="string">'r'</span>,<span class="string">'x+o.sp'</span>); set(h3,<span class="string">'MarkerSize'</span>,6,<span class="string">'MarkerFaceColor'</span>,<span class="string">'r'</span>);

         <span class="comment">%plot(inst1_b(j,1),inst1_b(j,6),'r:.','MarkerSize',9);</span>
         title(sprintf(<span class="string">'Suggested configuration \n  Blind day %d%d'</span>,blinddays(dd), Cal.Date.cal_year-2000))
         legend([h1(1),h2(1),h3(1)],Cal.brw_name{n_ref},Cal.brw_name{Cal.n_inst},[Cal.brw_name{Cal.n_inst} <span class="string">' old config.'</span>],<span class="string">'Location'</span>,<span class="string">'SouthEast'</span>,<span class="keyword">...</span>
                                                               <span class="string">'Orientation'</span>,<span class="string">'Horizontal'</span>);
         ylabel(<span class="string">'Total Ozone (DU)'</span>); grid;
         datetick(<span class="string">'x'</span>,15,<span class="string">'keepLimits'</span>,<span class="string">'KeepTicks'</span>);
         set(gca,<span class="string">'YLim'</span>,[min(inst1_b(j,10))-8 max(inst1_b(j,10))+8])
   <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="cal_report_158c_98.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_99.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_100.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_101.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_102.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_103.png" alt=""> <h2 id="43">final days: final config.</h2><pre class="codeinput">jday=findm(diaj(summary{Cal.n_inst}(:,1)),finaldays,0.5);<span class="comment">% quiero mostrar la primera config. con sl</span>
inst2=summary{Cal.n_inst}(jday,:);

<span class="keyword">for</span> dd=1:length(finaldays)
j=find(diajul(floor(inst2(:,1)))==finaldays(dd));
j_=find(diajul(floor(ref(:,1)))==finaldays(dd));
<span class="keyword">if</span> (isempty(j) || length(j)&lt;4), <span class="keyword">continue</span>; <span class="keyword">end</span>
f=figure;
set(f,<span class="string">'Tag'</span>,sprintf(<span class="string">'%s%s'</span>,<span class="string">'DayPlot_'</span>,num2str(finaldays(dd))));


<span class="comment">% plot(ref(j_,1),ref(j_,6),'g-s','MarkerSize',6,'MarkerFaceColor','g');</span>
<span class="comment">% hold on; plot(inst2(j,1),inst2(j,6),'b--d','MarkerSize',7,'MarkerFaceColor','b');</span>
<span class="comment">%          plot(inst2(j,1),inst2(j,10),'r:.','MarkerSize',9);</span>
<span class="comment">% title(sprintf('Final configuration \nFinal day %d%02d',finaldays(dd), Cal.Date.cal_year-2000))</span>
<span class="comment">% legend(gca,Cal.brw_name{n_ref},Cal.brw_name{Cal.n_inst},[Cal.brw_name{Cal.n_inst} ' old config.'],...</span>
<span class="comment">%                                                       'Location','SouthEast','Orientation','Horizontal');</span>

 h1=gscatter(ref(j_,1),ref(j_,6),ref(j_,5),<span class="string">'g'</span>,<span class="string">'x+o.sp'</span>); set(h1,<span class="string">'MarkerSize'</span>,6,<span class="string">'MarkerFaceColor'</span>,<span class="string">'g'</span>);
 hold <span class="string">on</span>; h2=gscatter(inst2(j,1),inst2(j,10),inst2(j,5),<span class="string">'b'</span>,<span class="string">'x+o.sp'</span>); set(h2,<span class="string">'MarkerSize'</span>,6,<span class="string">'MarkerFaceColor'</span>,<span class="string">'b'</span>);
 hold <span class="string">on</span>; h3=gscatter(inst2(j,1),inst2(j,6),inst2(j,5),<span class="string">'r'</span>,<span class="string">'x+o.sp'</span>); set(h3,<span class="string">'MarkerSize'</span>,6,<span class="string">'MarkerFaceColor'</span>,<span class="string">'r'</span>);
 title(sprintf(<span class="string">'Final configuration \nFinal day %d%02d'</span>,finaldays(dd), Cal.Date.cal_year-2000))
 legend([h1(1),h2(1),h3(1)],Cal.brw_name{n_ref},Cal.brw_name{Cal.n_inst},[Cal.brw_name{Cal.n_inst} <span class="string">' old config.'</span>],<span class="string">'Location'</span>,<span class="string">'SouthEast'</span>,<span class="string">'Orientation'</span>,<span class="string">'Horizontal'</span>);
         ylabel(<span class="string">'Total Ozone (DU)'</span>); grid;



ylabel(<span class="string">'Total Ozone (DU)'</span>); grid;
datetick(<span class="string">'x'</span>,15,<span class="string">'keepLimits'</span>,<span class="string">'KeepTicks'</span>);
set(gca,<span class="string">'YLim'</span>,[min(inst2(j,10))-8 max(inst2(j,10))+8])
<span class="keyword">end</span>

figure(maxf(findobj(<span class="string">'tag'</span>,<span class="string">'_GlobalPlot_'</span>)));
printfiles_report(gcf,Cal.dir_figs,<span class="string">'Height'</span>,7,<span class="string">'Width'</span>,13);


printfiles_report(double(f0):double(f),<span class="keyword">...</span>
                              Cal.dir_figs,<span class="string">'Width'</span>,14.5,<span class="string">'Height'</span>,7.5);

graph2latex(Cal.file_latex,{<span class="string">'summaryplot'</span>,<span class="string">'DayPlot_'</span>},brw_str{n_inst},<span class="string">'scale'</span>,0.8);
</pre><img vspace="5" hspace="5" src="cal_report_158c_104.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_105.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_106.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_107.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_108.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_109.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_110.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_111.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_112.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_113.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_114.png" alt=""> <img vspace="5" hspace="5" src="cal_report_158c_115.png" alt=""> <h2 id="44">detailed comparison</h2><p>%save detailed_comparison o3_c %load detailed_comparison head='Date_matlab date_dif sza_R airm_R temp_R filter_R O3_R sO3_R ms9 sm9 O3_R_o SO3_R_o O3_R_sl sO3_R_sl I_sza I_airm I_temp I_filter O3_I sO3_I ms9_I sm9_I O3_I_o sO3_I_o O3_I_sl sO3_I_sl'; [o3,i,j]=unique(o3_c(:,1)); label_detailed=mmcellstr(strtrim(strrep(head,' ','|'))); columns_detailed_report=[1:8,21,19,23]; aux=[cellstr(datestr(o3_c(i,1))),num2cell(o3_c(i,columns_detailed_report))]; head_end={'date.hour','diff (min)','sza ','airm','MS9','O3ref'}; summary_end=[diaj2(o3_c(i,1)),fix(o3_c(i,2)*24*60),o3_c(i,15),o3_c(i,16),round(o3_c(i,21)),round(o3_c(i,7)*10)/10]; matrix2latex_config(summary_end,fullfile(Cal.file_latex,['table_summary_end_',Cal.brw_str{Cal.n_inst},'.tex']),...                                   'columnlabels',head_end,...                                   'alignment','c');</p><p>% if ispc % xlswrite_(aux,'',['Date';label_detailed(columns_detailed_report)],'detailed_report.xls'); % else %  head1=cellstr(['Date';label_detailed(columns_detailed_report)]'); %  cell2csv(['comparison_report_',brw_str{n_inst},'.csv'],[head1;aux],','); %  % Todo linux outpit % end</p><p>% %% configration files % head2=[cellstr(leg),num2cell(config_def),num2cell(config_orig),num2cell(config_ref)]'; % head2{2}='Final ICF'; % head2{3}='Original ICF'; % head2{4}='Reference ICF'; % if ispc %   xlswrite_(head2','','','config_report.xls'); % else %   cell2csv(['config_report_',brw_str{n_inst},'.csv'],head2',','); % end</p><p>%% %makeHtmlTable(head2,[]);   % 'Date, Diff(min), REF</p><p>%close all;</p><p>%% Stray light [ETC_NEW_ST,o3c,m_etc]=ETC_calibration_C(Cal,summary,A.new(Cal.n_inst),Cal.n_inst,Cal.n_ref(2),7,0.8,0.03,[]);</p><p>%% figure; ms9=o3c(:,21); o3p=o3c(:,13).*o3c(:,16)*ETC_NEW_ST(1).TP(2); %airmas from instrument ozone_slant=o3c(:,13).*o3c(:,16)/1000; %air mass from instrument ozone_scale=fix(ozone_slant/.1)*.1; o3rc=(ms9-ETC_NEW_ST(1).TP(1))./(ETC_NEW_ST(1).TP(2)/1000*o3c(:,16)); y=100*(o3rc-o3c(:,13))./o3c(:,13);</p><p>%%</p><p>[m,s,n,name,v,ci]=grpstats(ms9-o3p,ozone_scale,{'mean','std','numel','gname','var','meanci'}); x=unique(ozone_scale); errorbar(x,m,x-s,x+s); hold on; [r,gof,c]=fit(x,m,'power2','Robust','on');          plot(ozone_slant,ms9-o3p,'.')          plot(r,'r.');</p><pre>        R=coeffvalues(r);</pre><pre>        hline(R(3),'r',num2str(R(3)));
        hline(ETC_NEW(1).NEW,'g',num2str(ETC_NEW(1).NEW));
        title({formula(r),num2str(coeffvalues(r))});
        suptitle(brw_str(n_inst));</pre><pre>%% cuadratic
figure;
f=fittype('a+b*x^2');
[r,gof,c]=fit(x,m,f,'Robust','on');
plot(ozone_slant,ms9-o3p,'.');hold on;
plot(r,'r.');
R=coeffvalues(r);
hline(ETC_NEW(1).NEW,'g',num2str(ETC_NEW(1).NEW));</pre><p>title({formula(r),num2str(coeffvalues(r))});</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018a</a><br></p></div><!--
##### SOURCE BEGIN #####
% options_pub.outputDir=fullfile(pwd,'latex','158','html'); options_pub.showCode=true;
% close all; publish(fullfile(pwd,'cal_report_158c.m'),options_pub);

%% Brewer Evaluation
clear all;
file_setup='arenos2019_setup';

eval(file_setup);     % configuracion por defecto
Cal.n_inst=find(Cal.brw==158);
Cal.file_latex=fullfile('.','latex',Cal.brw_str{Cal.n_inst});
Cal.dir_figs=fullfile('latex',filesep(),Cal.brw_str{Cal.n_inst},...
                              filesep(),[Cal.brw_str{Cal.n_inst},'_figures'],filesep());
mkdir(Cal.dir_figs);

try
 save(Cal.file_save,'-Append','Cal'); %sobreescribimos la configuracion guardada.
 load(Cal.file_save);
catch
    disp('clean');
    save(Cal.file_save);
end

% Brewer setup
Cal.Date.CALC_DAYS=Cal.calibration_days{Cal.n_inst,1};
Cal.n_ref=find(Cal.brw==185);

%% READ Brewer Summaries
 for i=[Cal.n_ref,Cal.n_inst]
    dsum{i}={};       ozone_raw{i}={};   hg{i}={};
    ozone_sum{i}={};  ozone_raw0{i}={};  bhg{i}={};
    config{i}={};     sl{i}={};          log{i}={};
    ozone_ds{i}={};   sl_cr{i}={};       missing{i}=[];

    [ozone,log_,missing_]=read_bdata(i,Cal);

    dsum{i}=ozone.dsum;
    ozone_sum{i}=ozone.ozone_sum;
    config{i}=ozone.config;
    ozone_ds{i}=ozone.ozone_ds;
    ozone_raw{i}=ozone.raw;
    ozone_raw0{i}=ozone.raw0;
    sl{i}=ozone.sl; %first calibration/ bfiles
    sl_cr{i}=ozone.sl_cr; %recalculated with 2? configuration
    hg{i}=ozone.hg;
    bhg{i}=ozone.bhg;
    log{i}=cat(1,log_{:});
    missing{i}=missing_';
    disp(log{i});
 end

save(Cal.file_save,'-APPEND','ozone_raw','dsum','ozone_sum','ozone_ds','config','sl','sl_cr','log','missing');
matrix2latex(log{Cal.n_inst},fullfile(Cal.file_latex,['tabla_fileprocess_',Cal.brw_str{Cal.n_inst},'.tex']));

%% configuration files
change=write_excel_config(config,Cal,Cal.n_inst);

[config_ref,TCref,DTref,ETCref,A1ref,ATref,leg]  =read_icf(Cal.brw_config_files{Cal.n_ref(1),2});
[config_def,TCdef,DTdef,ETCdef,A1def,ATdef]      =read_icf(Cal.brw_config_files{Cal.n_inst,2});
[config_orig,TCorig,DTorig,ETCorig,A1orig,ATorig]=read_icf(Cal.brw_config_files{Cal.n_inst,1});

latexcmd(fullfile(Cal.file_latex,['cal_config_',Cal.brw_str{Cal.n_inst}]),...
                     DTref,'\ETCref',ETCref(1),'\Aref',A1ref(1),...
                     DTdef,'\ETCdef',ETCdef(1),'\Adef',A1def(1),...
                     DTorig,'\ETCorig',ETCorig(1),'\Aorig',A1orig(1));
str_leg={};
 for i=1:size(leg,1)
     str_leg{i,1}=leg(i,:);
 end
rowlabels=regexprep(str_leg, '#', '\#');
[a b c]=fileparts(Cal.brw_config_files{Cal.n_inst,1}); confini=strcat(b,c);
[a b c]=fileparts(Cal.brw_config_files{Cal.n_inst,2}); confend=strcat(b,c);
columnlabels={sprintf('%s %c%s%c','Initial','(',confini,')'),...
              sprintf('%s %c%s%c','Final','(',confend,')')};
matrix2latex_config([config_orig(2:end),config_def(2:end)],...
                     fullfile(Cal.file_latex,['table_config_',Cal.brw_str{Cal.n_inst},'.tex']),...
                                              'rowlabels',rowlabels(2:end),'columnlabels',columnlabels,...
                                              'size','footnotesize');
%%
 makeHtml_Table([config_orig,config_def],[],cellstr(leg),[Cal.brw_config_files(Cal.n_inst,1),Cal.brw_config_files(Cal.n_inst,2)])

%% DT analysis_
 DT_analysis(Cal,ozone_raw0,config,'plot_flag',0);

%
%figure(findobj('tag','DT_comp'));
%set(get(gca,'title'),'FontSize',8);
%printfiles_report(gcf,Cal.dir_figs,'LockAxes',0,'Height',6);

% figure(findobj('tag','raw_counts_187')); title('Day 18711');
% set(findobj(gcf,'Tag','legend'),'FontSize',8);
% printfiles_report(gcf,Cal.dir_figs,'Width',8,'Height',6,'LockAxes',0);
% 
% figure(findobj('tag','raw_counts_191')); title('Day 19111'); ylabel('');
% set(findobj(gcf,'Tag','legend'),'FontSize',8);
% printfiles_report(gcf,Cal.dir_figs,'Width',8,'Height',6,'LockAxes',0);
%close all
%
%% SL Report
close all;
for ii=[Cal.n_ref,Cal.n_inst]
    sl_mov_o{ii}={}; sl_median_o{ii}={}; sl_out_o{ii}={}; R6_o{ii}={};
    sl_mov_n{ii}={}; sl_median_n{ii}={}; sl_out_n{ii}={}; R6_n{ii}={};
    try
    if ii==Cal.n_inst
% old instrumental constants
      [sl_mov_o{ii},sl_median_o{ii},sl_out_o{ii},R6_o{ii}]=sl_report_jday(ii,sl,Cal.brw_str,...
                               'date_range',datenum(Cal.Date.cal_year,1,Cal.calibration_days{Cal.n_inst,1}([1 end])),...
                               'outlier_flag',0,'hgflag',1,'fplot',1);
      fprintf('%s Old constants: %5.0f +/-%5.1f\n',Cal.brw_name{ii},...
                  nanmedian(R6_o{ii}(diajul(R6_o{ii}(:,1))>=Cal.calibration_days{ii,2}(1),2)),...
                  nanstd(   R6_o{ii}(diajul(R6_o{ii}(:,1))>=Cal.calibration_days{ii,2}(1),2)));
% new instrumental constants
      [sl_mov_n{ii},sl_median_n{ii},sl_out_n{ii},R6_n{ii}]=sl_report_jday(ii,sl_cr,Cal.brw_str,...
                               'date_range',datenum(Cal.Date.cal_year,1,Cal.calibration_days{Cal.n_inst,1}([1 end])),...
                               'outlier_flag',0,'hgflag',1,'fplot',1);
      fprintf('%s New constants: %5.0f +/-%5.1f\n',Cal.brw_name{ii},...
                  nanmedian(R6_n{ii}(diajul(R6_n{ii}(:,1))>=Cal.calibration_days{ii,3}(1),2)),...
                  nanstd(   R6_n{ii}(diajul(R6_n{ii}(:,1))>=Cal.calibration_days{ii,3}(1),2)));
    else
        
      [sl_mov_o{ii},sl_median_o{ii},sl_out_o{ii},R6_o{ii}]=sl_report_jday(ii,sl,Cal.brw_str,...
                               'date_range',datenum(Cal.Date.cal_year,1,Cal.calibration_days{Cal.n_ref,1}([1 end])),...
                               'outlier_flag',0,'fplot',0);  
        
      [sl_mov_n{ii},sl_median_n{ii},sl_out_n{ii},R6_n{ii}]=sl_report_jday(ii,sl_cr,Cal.brw_str,...
                               'date_range',datenum(Cal.Date.cal_year,1,Cal.calibration_days{Cal.n_ref,1}([1 end])),...
                               'outlier_flag',0,'fplot',0);
   
    end
    catch exception
          fprintf('%s, brewer: %s\n',exception.message,Cal.brw_str{ii});
    end
end
% anadimos el sl
save(Cal.file_save,'-APPEND','sl_mov_o','sl_median_o','sl_out_o','R6_o',...
                             'sl_mov_n','sl_median_n','sl_out_n','R6_n');

sl_report{Cal.n_inst}.sl_mov_n=sl_mov_n{Cal.n_inst};         sl_report{Cal.n_inst}.sl_mov_o=sl_mov_o{Cal.n_inst};
sl_report{Cal.n_inst}.sl_median_n=sl_median_n{Cal.n_inst};   sl_report{Cal.n_inst}.sl_median_o=sl_median_o{Cal.n_inst};
sl_report{Cal.n_inst}.sl_out_n=sl_out_n{Cal.n_inst};         sl_report{Cal.n_inst}.sl_out_o=sl_out_o{Cal.n_inst};
sl_report{Cal.n_inst}.R6_n{Cal.n_inst}=R6_n{Cal.n_inst};     sl_report{Cal.n_inst}.R6_o{Cal.n_inst}=R6_o{Cal.n_inst};
save(Cal.file_save,'-APPEND','sl_report');

%% SL report plot
ix=sort(findobj('-regexp','Tag','SL_R\w+'));
if length(ix)>2
   for i=ix, set( findobj(i,'Tag','legend'),'FontSize',8); end
   set(ix(1),'tag','SL_R6_report_old'); set(ix(2),'tag','SL_R5_report_old');
   Width=8; Height=6;
else
   Width=14; Height=6.5;
end
printfiles_report(ix',Cal.dir_figs,'Width',Width,'Height',Height);

figure(maxf(findobj('tag','SL_I5_report')));
printfiles_report(gcf,Cal.dir_figs,'LockAxes',0,'no_export');

close all

%% Hg Report
% Hg failure 
hg_fail=read_custom(fullfile(Cal.path_root,sprintf('bdata%s',Cal.brw_str{Cal.n_inst})),sprintf('B*.%s',Cal.brw_str{Cal.n_inst}),...
                              'hg: lamp not detected','printfile',0,...
                              'date_range',datenum(Cal.Date.cal_year,1,1));
if ~isempty(hg_fail)
    [mean_hg_fail N_hg_fail] = grpstats(fix(hg_fail),fix(hg_fail),{'nanmean','numel'}); 
    displaytable( N_hg_fail,{'N(Hg failure)'},13,'d',cellstr(datestr(mean_hg_fail(:,1),1)))
else
    fprintf('Ho Hg failures recorded for Brewer %s\r\n',Cal.brw_name{Cal.n_inst});
end
% Hg during campaign
hg_report(Cal.n_inst,hg,Cal,'outlier_flag',1,'date_range',[]);

%% READ Configuration
close all
[A,ETC,SL_B,SL_R,F_corr,cfg]=read_cal_config_new(config,Cal,{sl_median_o,sl_median_n});

try
 tabla_sl=printmatrix([Cal.brw(:)';ETC.old;ETC.new;A.old;A.new;Cal.SL_OLD_REF';Cal.SL_NEW_REF';fix(SL_B)']',4);
 cell2csv(fullfile(Cal.file_latex,'tabla_config.csv'),tabla_sl',';');
catch
  l=lasterror;
  disp(l.message)
  disp('tabla de configuracion posiblemente incompleta')
end

%% Data recalculation for summaries  and individual observations
for i=[Cal.n_inst Cal.n_ref]
    cal{i}={}; summary{i}={}; summary_old{i}={};
    if i==Cal.n_inst
    [cal{i},summary{i},summary_old{i}]=test_recalculation(Cal,i,ozone_ds,A,SL_R,SL_B,'flag_sl',1,'hg_dep',1);
    else
    [cal{i},summary{i},summary_old{i}]=test_recalculation(Cal,i,ozone_ds,A,SL_R,SL_B,'flag_sl',1);
    end
end

% outlier
% id_out=find(summary{Cal.n_inst}(:,6)>400 | summary{Cal.n_inst}(:,6)<200);
% disp(unique(diaj(summary{Cal.n_inst}(id_out,1))));
% 
% id_out=find(isoutlier(summary{Cal.n_inst}(:,6)))
% disp(unique(diaj(summary{Cal.n_inst}(id_out,1))));
% 
% summary{Cal.n_inst}(id_out,:)=[];
% summary_old{Cal.n_inst}(id_out,:)=[];



summary_orig=summary; summary_orig_old=summary_old;
save(Cal.file_save,'-APPEND','summary_old','summary_orig_old','summary','summary_orig');

%% Filter distribution
close all
ozone_filter_analysis_mi(summary,Cal);

%%
printfiles_report(findobj('Tag','FILTER_DISTRIBUTION'),Cal.dir_figs,'Width',13,'Height',7.5);
printfiles_report(findobj('Tag','Ozone_diff_filter_rel'),Cal.dir_figs,'Width',13,'Height',7.5);

close all

%% filter correction
% Si queremos eliminar algun filtro CORREGIR a NaN
%F_corr{Cal.n_inst}=[0,0,0,-13,0,0]

for ii=[Cal.n_ref Cal.n_inst]
   [summary_old_corr summary_corr]=filter_corr(summary_orig,summary_orig_old,ii,A,F_corr{ii});
   summary_old{ii}=summary_old_corr; summary{ii}=summary_corr;
end
figure; plot(summary{Cal.n_inst}(:,1),summary{Cal.n_inst}(:,6),'r.',...
             summary{Cal.n_ref(1)}(:,1),summary{Cal.n_ref(1)}(:,6),'k.');%,...
%             summary{Cal.n_ref(2)}(:,1),summary{Cal.n_ref(2)}(:,6),'m.');
legend(gca,'inst','IZO#185','Location','NorthEast'); grid;
datetick('x',26,'KeepLimits','KeepTicks');
ozone_filter_analysis_mi(summary,Cal);
%% Ozone Calibration
% Reference Brewer #185
close all
n_ref=Cal.n_ref; % Cuidado con cual referencia estamos asignando
n_inst=Cal.n_inst;
brw=Cal.brw; brw_str=Cal.brw_str;

jday_ref=findm((diaj(summary{n_ref}(:,1))),Cal.calibration_days{n_inst,1},0.5);
ref=summary{n_ref}(jday_ref,:);

%% Change? No change
 alldays=Cal.calibration_days{Cal.n_inst,1};
 
 jday=findm(diaj(summary_orig_old{Cal.n_inst}(:,1)),alldays,0.5);% quiero mostrar la primera config. con sl
 inst1=summary_orig_old{Cal.n_inst}(jday,:);
 
    [x,r,rp,ra,dat,ox,osc_smooth_ini]=ratio_min_ozone(...
       inst1(:,[1,6,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),...
       5,brw_str{n_inst},brw_str{n_ref},'plot_flag',0);% original config

%% Blind Period
% etiquetamos con _b, porque eso sera lo que usamos para plotear los individu~ales, con la configuraci?n sugerida
close all
blinddays=Cal.calibration_days{Cal.n_inst,2};

jday=findm(diaj(summary_orig_old{Cal.n_inst}(:,1)),blinddays,0.5);
inst1_b=summary_orig_old{Cal.n_inst}(jday,:); % no filter correction
%inst1_b=summary_old{Cal.n_inst}(jday,:);~
% nan en blind days

if ~Cal.no_maint(Cal.n_inst)     % if the instrument has changed due to maintenance
    
    [x,r,rp,ra,dat,ox,osc_smooth_ini]=ratio_min_ozone(...
        inst1_b(:,[1,6,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),...
        5,brw_str{n_inst},brw_str{n_inst},'plot_flag',0);% original config
  
    % remove outliers
    jout=find(isoutlier(r(:,2),'gesd' ))
    jout=find(ismember(fix(summary_orig_old{Cal.n_inst}(:,1)*10000),fix(r(jout,1)*10000)))
    summary_orig_old{Cal.n_inst}(jout,:)=[];
    % ojo revisar los NaN
    %summary_old{Cal.n_inst}(any(isnan( summary_old{Cal.n_inst})')',:)=[];
    
    
    
    jday=findm(diaj(summary_orig_old{Cal.n_inst}(:,1)),blinddays,0.5);
    inst1_b=summary_orig_old{Cal.n_inst}(jday,:);
    
      [x,r,rp,ra,dat,ox,osc_smooth_inisl]=ratio_min_ozone(...
        inst1_b(:,[1,12,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),...
        5,brw_str{n_inst},brw_str{n_ref},'plot_flag',0);% original config , sl corrected
     [x,r,rp,ra,dat,ox,osc_smooth_ini]=ratio_min_ozone(...
        inst1_b(:,[1,6,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),...
        5,brw_str{n_inst},brw_str{n_ref},'plot_flag',0);% original config
  
    
    %% Sugerido con los blind_days
    A1=A.old(ismember(Cal.Date.CALC_DAYS,blinddays),Cal.n_inst+1);
    A1_old=unique(A1(~isnan(A1)))
    osc_range=0.7
    %A1_old=0.3390
    [ETC_SUG,o3c_SUG,m_etc_SUG]=ETC_calibration_C(Cal,summary_orig_old,A1_old,...
        Cal.n_inst,n_ref,10,osc_range,0.03,blinddays);
    
    data_tabl=[nanmean(ETC.old(:,n_inst+1)),round([ETC_SUG(1).NEW,ETC_SUG(1).TP(1)]),...
        nanmean(A.old(:,n_inst+1)),ETC_SUG(1).TP(2)/10000,A1_old
        %         solo el rango seleccionado
        nanmean(ETC.old(:,n_inst+1)),round([ETC_SUG(2).NEW,ETC_SUG(2).TP(1)]),...
        nanmean(A.old(:,n_inst+1)),ETC_SUG(2).TP(2)/10000,A1_old];
    %         todo el rango
    displaytable(data_tabl,{'ETCorig','ETCnew 1p','ETCnew 2p','O3Abs (ICF)','O3Abs 2p','O3Abs sug.'},...
        11,{'d','d','d','.4f','.4f','.4f'},{sprintf('OSC < %.2f DU',osc_range),'All OSC range'})
    
    % suggested
    o3r= (inst1_b(:,8)-ETC_SUG(1).NEW)./(A1_old*inst1_b(:,3)*10);
    inst1_b(:,10)=o3r;
    [x,r,rp,ra,dat,ox,osc_smooth_sug]=ratio_min_ozone(...
        inst1_b(:,[1,10,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),...
        5,brw_str{n_inst},brw_str{n_ref},'plot_flag',0);
    % si es suficiente la correccion por sl
    % osc_smooth_sug=osc_smooth_inisl;
    
    %%
    figure(sort(findobj('tag','CAL_2P_SCHIST')));
    ax=findobj(gca,'type','text');
    set(ax(2),'FontSize',9,'Backgroundcolor','w'); set(ax(3),'FontSize',9,'Backgroundcolor','w');
    printfiles_report(gcf,Cal.dir_figs,'aux_pattern',{'sug'},'Width',14,'Height',8);
    
    figure; set(gcf,'tag','RATIO_ERRORBAR');
    h=plot_smooth(osc_smooth_ini,osc_smooth_inisl,osc_smooth_sug);
    legend(h,'Config. orig','Config. orig, SL corrected','Suggested');
    title([ brw_str{n_inst},' - ',brw_str{n_ref},' / ',brw_str{n_ref}]);
    printfiles_report(gcf,Cal.dir_figs,'aux_pattern',{'sug'});
    %%
    close all
    
    %% Blind days table
    % m_etc: [date, ref_new_slcorr, +sd, +n, ...
    %        inst(6), +sd, inst(10), +sd, inst(6 sl corr), +sd, ...
    %        inst(rcalibrated, ETC sug), +sd]
    %
    % Si no hay sugerida, sino que es la orig.SL corr., hacer
    %m_etc=[m_etc_SUG(:,1:6),NaN*m_etc_SUG(:,1),m_etc_SUG(:,9:10)];
    m_etc=[m_etc_SUG(:,1:6),NaN*m_etc_SUG(:,1),m_etc_SUG(:,11:12)];
    m_etc(:,7)=100*(m_etc(:,5)-m_etc(:,2))./m_etc(:,2);
    m_etc(:,10)=100*(m_etc(:,8)-m_etc(:,2))./m_etc(:,2);
    M=cell(size(m_etc,1)+1,size(m_etc,2)+1);
    label={'Date','Day',['O3\#',brw_str{n_ref}],'O3std','N',...
        ['O3\#',brw_str{n_inst}],'O3 std',...
        ['\%(',brw_str{n_inst},'-',brw_str{n_ref},')/',brw_str{n_ref}]...% old config
        ['O3(*)\#',brw_str{n_inst}],'O3std',...% new config., no SL corrected
        ['(*)\%(',brw_str{n_inst},'-',brw_str{n_ref},')/',brw_str{n_ref}]};
    M(1,:)=label;
    M(2:end,1)=cellstr(datestr(fix(m_etc(:,1))));
    m_etc(:,1)=diaj(m_etc(:,1));
    M(2:end,2:end)=num2cell(round(m_etc*10)/10);
    
    disp(M);
    matrix2latex_ctable(M(2:end,2:end),fullfile(Cal.file_latex,['table_ETCdatasug_',Cal.brw_str{Cal.n_inst},'.tex']),...
        'rowlabels',M(2:end,1),...
        'columnlabels',label(2:end),'alignment','c','resize',0.9);
    % Sergio: Aï¿½adido para los report en latex
%Info:
    % m_etc(1,1)=dï¿½a inicial que se emplea para la sugerida
    % m_etc(:,1)=dï¿½a final que se emplea para la sugerida
    % total= nï¿½mero total de medidas 
    total_sugerida=sum(m_etc(:,4))
latexcmd(fullfile(Cal.file_latex,['cal_status_',brw_str{n_inst}]),'\diaSUGstart',m_etc(1,1),...
             '\diaSUGend',m_etc(end,1),'\totalSUG',total_sugerida);
else
    disp('No maintenance')
    ETC_SUG(1).NEW=NaN; o3c_SUG=NaN;  osc_smooth_sug=NaN*ones(1,7);
    
    [x,r,rp,ra,dat,ox,osc_smooth_ini]=ratio_min_ozone(...
        inst1_b(:,[1,6,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),...
        5,brw_str{n_ref},brw_str{n_ref},'plot_flag',0);% original config
    [x,r,rp,ra,dat,ox,osc_smooth_inisl]=ratio_min_ozone(...
        inst1_b(:,[1,12,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),...
        5,brw_str{n_ref},brw_str{n_ref},'plot_flag',0);% original config with SL correction
    
    osc_smooth{Cal.n_inst}.ini=osc_smooth_ini;  osc_smooth{Cal.n_inst}.ini_sl=osc_smooth_inisl;
    A1=A.old(ismember(Cal.Date.CALC_DAYS,blinddays),Cal.n_inst+1); A1_old=unique(A1(~isnan(A1)));
end

latexcmd(fullfile(Cal.file_latex,['cal_etc_',brw_str{n_inst}]),'\ETCblind',num2str(round(ETC_SUG(1).NEW)),...
             '\ETCSOblind',config_def(12),'\SOABSblind',config_def(10),'\OtresSOABSblind',config_def(9),...
             '\NobsCalblind',size(o3c_SUG,1));

etc{Cal.n_inst}.sug=ETC_SUG;
osc_smooth{Cal.n_inst}.ini=osc_smooth_ini; osc_smooth{Cal.n_inst}.ini_sl=osc_smooth_inisl;
osc_smooth{Cal.n_inst}.sug=osc_smooth_sug;

save(Cal.file_save,'-APPEND','etc');

%% Final Period
close all

%% filter correction
% % %Si queremos eliminar algun filtro CORREGIR a NaN
%  F_corr{Cal.n_inst}=[0,0,0,-15,0,0]
%  for ii=[Cal.n_ref Cal.n_inst]
%          [summary_old_corr summary_corr]=filter_corr(summary_orig,summary_orig_old,ii,A,F_corr{ii});
%     summary_old{ii}=summary_old_corr; summary{ii}=summary_corr;
%  end

finaldays=Cal.calibration_days{Cal.n_inst,3}; % no change
finaldays(finaldays==173)=[]
finaldays(finaldays==172)=[]

jday=ismember(diaj(summary{Cal.n_inst}(:,1)),fix(finaldays));
jlim=(diaj2(summary{Cal.n_inst}(:,1))>finaldays(1) & ...    % 2st set the limits
      diaj2(summary{Cal.n_inst}(:,1))<finaldays(end)); 
inst2=summary{Cal.n_inst}(jday & jlim ,:);
%
A1=A.new(ismember(Cal.Date.CALC_DAYS,finaldays),Cal.n_inst+1);
A1_new=unique(A1(~isnan(A1)))
%A1_new=0.3435
osc_range=1;

[ETC_NEW,o3c_NEW,m_etc_NEW]=ETC_calibration_C(Cal,summary,A1_new,n_inst,n_ref,...
                                                                5,osc_range,0.02,finaldays);
hidx=ismember(Cal.Date.CALC_DAYS,finaldays);
cc=nanmean([ETC.new(hidx,Cal.n_inst+1),10000*A.new(hidx,Cal.n_inst+1),10000*A.old(hidx,Cal.n_inst+1)]);

tableform({'ETCorig','ETCnew 1p','ETCnew 2p','O3Abs (ICF)','O3Abs 2p','O3Abs old'},...
          [round([cc(1),ETC_NEW(1).NEW,ETC_NEW(1).TP(1), cc(3),ETC_NEW(1).TP(2),cc(2)])
%         solo el rango seleccionado
           round([cc(1),ETC_NEW(2).NEW,ETC_NEW(2).TP(1), cc(3),ETC_NEW(2).TP(2),cc(3)])]);
%         todo el rango
latexcmd(fullfile(['>',Cal.file_latex],['cal_etc_',brw_str{n_inst}]),'\ETCfin',num2str(round(ETC_NEW(1).NEW)),...
    '\ETCSOfin',config_def(12),'\SOABSfin',config_def(10),'\OtresSOABSfin',config_def(9),...
    '\NobsCalfin',size(o3c_NEW,1));

etc{Cal.n_inst}.new=ETC_NEW;
save(Cal.file_save,'-APPEND','etc');

%% TEST NEW CONFIG
%   o3r= (inst2(:,8)-ETC_NEW(1).NEW)./(A1_new*inst2(:,3)*10);
%   inst2(:,10)=o3r;
%       [x,r,rp,ra,dat,ox,osc_smooth_fin]=ratio_min_ozone(...
%          inst2(:,[1,10,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),...
%          5,brw_str{n_inst},brw_str{n_ref},'plot_flag',0);

 %% FINAL CONFIG   
    [x,r,rp,ra,dat,ox,osc_smooth_fin]=ratio_min_ozone(...
        inst2(:,[1,6,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),...
        5,brw_str{n_inst},brw_str{n_ref},'plot_flag',0);
    
 figure; set(gcf,'tag','RATIO_ERRORBAR_all');
 h=plot_smooth(osc_smooth_ini,osc_smooth_inisl,osc_smooth_fin);
 legend(h,'Config. orig','Config. orig, SL corrected','Suggested'); set(gca,'YLim',[-4 2]);
 title([ brw_str{n_inst},' - ',brw_str{n_ref},' / ',brw_str{n_ref}]);

%% TWO POINT CALIBRATION
%  o3r= (inst2(:,8)-ETC_NEW(1).TP(1))./(ETC_NEW(1).TP(2)/10000*inst2(:,3)*10);
%  inst2(:,10)=o3r;
%      [x,r,rp,ra,dat,ox,osc_smooth_2P]=ratio_min_ozone(...
%         inst2(:,[1,10,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),...
%         5,brw_str{n_inst},brw_str{n_ref},'plot_flag',0);

osc_smooth{Cal.n_inst}.fin=osc_smooth_fin;
% osc_smooth{Cal.n_inst}.twoP=osc_smooth_2P;
save(Cal.file_save,'-APPEND','osc_smooth');

%%
figure(maxf(findobj('tag','CAL_2P_SCHIST')));
ax=findobj(gca,'type','text');
set(ax(2),'FontSize',9,'Backgroundcolor','w'); set(ax(3),'FontSize',9,'Backgroundcolor','w');
printfiles_report(gcf,Cal.dir_figs,'aux_pattern',{'fin'},'Width',14,'Height',8);

figure(maxf(findobj('tag','RATIO_ERRORBAR')));
printfiles_report(gcf,Cal.dir_figs,'aux_pattern',{'fin'});

figure(maxf(findobj('tag','RATIO_ERRORBAR_all')));
printfiles_report(gcf,Cal.dir_figs);

close all

%%
%% STRAY
if Cal.brwM(Cal.n_inst)~=3
    
    close all
    
    osc_range=2;
    [ETC_NEWo,o3c_NEWo,m_etc_NEW]=ETC_calibration_C(Cal,summary,A1_new,n_inst,n_ref,...
        10,osc_range,0.05,finaldays);
    
    close all;
    straylight_{n_inst}=straylight_model(o3c_NEWo,A1_new,ETC_NEW(1).NEW,Cal);
    save(Cal.file_save,'-APPEND','straylight_');
    
    %%
    figure(maxf(findobj('-regexp','tag','ETC_StrayLight*')));
    % ax=findobj(gca,'type','text');
    % set(ax,'FontSize',12,'Backgroundcolor','w');
    %set(ax(3),'FontSize',9,'Backgroundcolor','w');
    printfiles_report(gcf,Cal.dir_figs,'aux_pattern',{'_Det'},...
        'Width',14,'Height',8,'FontSize',10);
    
    %% Latex variables
    a=straylight_{n_inst}.coeff.R(1);
    b=straylight_{n_inst}.coeff.R(2);
    sl_etc=straylight_{n_inst}.coeff.R(3);
    
    latexcmd(fullfile(['>',Cal.file_latex],['cal_etc_',brw_str{n_inst}]),...
        '\SLETC',round(sl_etc),'\SLexp',round(b*100)/100,'\SLcoeff',round(a*10)/10);
    
    
    %% calculation
    a=straylight_{n_inst}.coeff.R(1);
    b=straylight_{n_inst}.coeff.R(2);
    sl_etc=straylight_{n_inst}.coeff.R(3);
    
    etc=ETC_NEW(1).NEW
    o3=inst2(:,6);
    m =inst2(:,3);
    o3r= o3 -  a/A1_new*(m.*o3/1000).^b./m/10;
    %o3r1= o3 -  a/A1_new*(m.*o3r).^b./m/10;
    
    inst2(:,10)=o3r;
    [x,r,rp,ra,dat,ox,osc_stray]=ratio_min_ozone(...
        inst2(:,[1,10,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),...
        5,brw_str{n_inst},brw_str{n_inst},'plot_flag',0);
    
    
    o3r1= o3 -  a/A1_new*(m.*o3r/1000).^b./m/10;
    
    inst2(:,10)=o3r1;
    [x,r,rp,ra,dat,ox,osc_stray2]=ratio_min_ozone(...
        inst2(:,[1,10,3,2,8,9,4,5]),ref(:,[1,6,3,2,8,9,4,5]),...
        5,brw_str{n_inst},brw_str{n_inst},'plot_flag',0);
    
    
    %% Apply the SL correction
    f=figure;
    set(f,'tag','RATIO_ERRORBAR_stray');
    h=plot_smooth_(osc_smooth_inisl,osc_smooth_fin,osc_stray2);
    legend(h,'Config. initial (SL corrected)','Final Configuration','Stray Light corrected ',...
        'location','southwest');
    set(gca,'YLim',[-4 2]);
    title([ brw_str{n_inst},' - ',brw_str{n_ref},' / ',brw_str{n_ref}]);
    
    figure(maxf(findobj('-regexp','tag','RATIO_ERRORBAR_stray')));
    printfiles_report(gcf,Cal.dir_figs,...
        'Width',14,'Height',8);
    
    
    
    
    %% Difference iter#1 to iter#2
    f=figure;
    set(f,'tag','RATIO_ERRORBAR_stray_corr');
    h=plot_smooth_(osc_smooth_fin,osc_stray,osc_stray2);
    legend(h,'Config.final','Stray Light corrected Iter #1','Stray Light corrected Iter #2',...
        'location','southwest');
    set(gca,'YLim',[-4 2]);
    title([ brw_str{n_inst},' - ',brw_str{n_ref},' / ',brw_str{n_ref}]);
    f=figure;
    
    figure(maxf(findobj('-regexp','tag','RATIO_ERRORBAR_stray_corr')));
    printfiles_report(gcf,Cal.dir_figs,...
        'Width',14,'Height',8);
    
end
%% Final days table
% m_etc_(lo que sea) son los datos filtrados por Tsync, OSC y sza !!! -> salida de ETC_calibration
% En ste caso se usa summary, as? que la configuraci?n original ser? 10, y la final 6
m_etc=[m_etc_NEW(:,[1:4 7:8]),NaN*m_etc_NEW(:,1),m_etc_NEW(:,5:6)];
m_etc(:,7)=100*(m_etc(:,5)-m_etc(:,2))./m_etc(:,2);
m_etc(:,10)=100*(m_etc(:,8)-m_etc(:,2))./m_etc(:,2);
% La diferencia relativa anterior se refiere al ozono recalculado con la ETC que resulta de los c?lculos
% Esto podr?a ser una incoherencia: por ejemplo para el 072 sale 3179, pero mantenemos 3185.

%m_etc(:,[end-1,end])=[];
M=cell(size(m_etc,1)+1,size(m_etc,2)+1);
label={'Date','Day',['O3\#',brw_str{n_ref}],'O3std','N',...
         ['O3\#',brw_str{n_inst}],'O3 std',...
         ['\%(',brw_str{n_inst},'-',brw_str{n_ref},')/',brw_str{n_ref}]...
         ['O3(*)\#',brw_str{n_inst}],'O3std',...
         ['(*)\%(',brw_str{n_inst},'-',brw_str{n_ref},')/',brw_str{n_ref}]};
M(1,:)=label;
M(2:end,1)=cellstr(datestr(fix(m_etc(:,1))));
m_etc(:,1)=diaj(m_etc(:,1));
M(2:end,2:end)=num2cell(round(m_etc*10)/10);

disp(M);
matrix2latex_ctable(M(2:end,2:end),fullfile(Cal.file_latex,['table_ETCdatafin_',Cal.brw_str{Cal.n_inst},'.tex']),...
                                   'rowlabels',M(2:end,1),...
                                   'columnlabels',label(2:end),'alignment','c','resize',0.9)

% So2 calibration from icf file
% Pendiente
% latexcmd(['>',file_latex,'_etc_',brw_str{n_inst}],'\ETCSOdos',config_def(12),'\SOdosABS',config_def(10),'\OtresSOdosABS',config_def(9));

%% Summary  Final Comparison all data detailed for osc ranges
TIME_SYNC=5;
%rowlabels=regexprep(str_leg, '#', '\#');
caption=strcat('Ozone Summary Report. Mean daily ozone, grouped by ozone slant path ranges,',...
               ' with original and final configuration (with an asterisk)');
tags_={'osc$>$1500' '1500$>$osc$>$1000' '1000$>$osc$>$700' '700$>$osc$>$400' 'osc$<$400'};
label_={'Day','osc range',['O3#',brw_str{n_ref}],'O3std','N',...
                          ['O3#',brw_str{n_inst}],'O3 std','%diff',...
                          ['(*)O3#',brw_str{n_inst}],'O3 std','(*)%diff'};

ozone_osc_sum=o3_daily_osc(Cal,TIME_SYNC,n_ref,ETC_SUG,A1_old,summary_orig_old,summary_old,summary);
dat=cat(2,num2cell(ozone_osc_sum(:,1)),tags_(ozone_osc_sum(:,end))',num2cell(ozone_osc_sum(:,2:end-1)));

displaytable(dat,label_,12);
matrix2latex_longtable(dat,fullfile(Cal.file_latex,['table_summarydetailed_',brw_str{n_inst},'.tex']),...
                                   'size','tiny','columnlabels',str2latex(label_),'alignment','c',...
                                   'format',{'%.0f','%s','%.0f','%.1f','%.0f','%.0f','%.1f','%.1f','%.0f','%.1f','%.1f'},...
                                   'caption',caption);
                              




%%
[m,s,n,grpn]=grpstats(ozone_osc_sum,{ozone_osc_sum(:,1)},{'mean','std','numel','gname'});
ozone_day_sum=round([m(:,1),m(:,2),s(:,2),m(:,4),m(:,8),s(:,8),100*(m(:,8)-m(:,2))./m(:,2)]*10)/10;

 makeHtmlTable(ozone_day_sum,[],cellstr(datestr(ozone_day_sum(:,1)+datenum(Cal.Date.cal_year,1,0))),...
        {'Day',['O3 #',brw_str{n_ref}],'O3 std','N obs',['O3 #',brw_str{n_inst}],...
         'O3 std',[' % ',brw_str{n_ref},'-',brw_str{n_inst},'/',brw_str{n_ref}]})

%% Plot daily summary
close all
figure; set(gcf,'Tag','_GlobalPlot_');
plot(summary{n_ref}(:,1),summary{n_ref}(:,6),'g*','MarkerSize',5);
hold on; plot(summary{Cal.n_inst}(:,1),summary{Cal.n_inst}(:,6),'b.','MarkerSize',12);
legend(gca,Cal.brw_name{n_ref},Cal.brw_name{Cal.n_inst},'Location','Best',...
                                                               'Orientation','Horizontal');
ylabel('Total Ozone (DU)'); xlabel('Date'); grid;
title(Cal.campaign);
datetick('x',6,'keepLimits','KeepTicks');


f0=figure;

% blind days: suggested config.
if ~Cal.no_maint(Cal.n_inst)     % if the instrument has changed due to maintenance
   inst1_b      =summary_old{Cal.n_inst}(findm(diaj(summary_old{Cal.n_inst}(:,1)),blinddays,0.5),:);
   inst1_b(:,10)=(inst1_b(:,9)-ETC_SUG(1).NEW)./(A1_old*inst1_b(:,3)*10);     
   for dd=1:length(blinddays)
      j=find(diajul(floor(inst1_b(:,1)))==blinddays(dd));
      j_=find(diajul(floor(ref(:,1)))==blinddays(dd));
      if (isempty(j) || length(j)<4), continue; end
         f=figure; 
         set(f,'Tag',sprintf('%s%s','DayPlot_',num2str(blinddays(dd))));
         h1=gscatter(ref(j_,1),ref(j_,6),ref(j_,5),'g','x+o.sp'); set(h1,'MarkerSize',6,'MarkerFaceColor','g');
         hold on; h2=gscatter(inst1_b(j,1),inst1_b(j,10),inst1_b(j,5),'b','x+o.sp'); set(h2,'MarkerSize',6,'MarkerFaceColor','b');
         hold on; h3=gscatter(inst1_b(j,1),inst1_b(j,6),inst1_b(j,5),'r','x+o.sp'); set(h3,'MarkerSize',6,'MarkerFaceColor','r');
       
         %plot(inst1_b(j,1),inst1_b(j,6),'r:.','MarkerSize',9);
         title(sprintf('Suggested configuration \n  Blind day %d%d',blinddays(dd), Cal.Date.cal_year-2000))
         legend([h1(1),h2(1),h3(1)],Cal.brw_name{n_ref},Cal.brw_name{Cal.n_inst},[Cal.brw_name{Cal.n_inst} ' old config.'],'Location','SouthEast',...
                                                               'Orientation','Horizontal');
         ylabel('Total Ozone (DU)'); grid;
         datetick('x',15,'keepLimits','KeepTicks');
         set(gca,'YLim',[min(inst1_b(j,10))-8 max(inst1_b(j,10))+8])
   end
end

%% final days: final config.
jday=findm(diaj(summary{Cal.n_inst}(:,1)),finaldays,0.5);% quiero mostrar la primera config. con sl
inst2=summary{Cal.n_inst}(jday,:);

for dd=1:length(finaldays)
j=find(diajul(floor(inst2(:,1)))==finaldays(dd));
j_=find(diajul(floor(ref(:,1)))==finaldays(dd));
if (isempty(j) || length(j)<4), continue; end
f=figure;
set(f,'Tag',sprintf('%s%s','DayPlot_',num2str(finaldays(dd))));


% plot(ref(j_,1),ref(j_,6),'g-s','MarkerSize',6,'MarkerFaceColor','g');
% hold on; plot(inst2(j,1),inst2(j,6),'bREPLACE_WITH_DASH_DASHd','MarkerSize',7,'MarkerFaceColor','b');
%          plot(inst2(j,1),inst2(j,10),'r:.','MarkerSize',9);
% title(sprintf('Final configuration \nFinal day %d%02d',finaldays(dd), Cal.Date.cal_year-2000))
% legend(gca,Cal.brw_name{n_ref},Cal.brw_name{Cal.n_inst},[Cal.brw_name{Cal.n_inst} ' old config.'],...
%                                                       'Location','SouthEast','Orientation','Horizontal');
                                                  
 h1=gscatter(ref(j_,1),ref(j_,6),ref(j_,5),'g','x+o.sp'); set(h1,'MarkerSize',6,'MarkerFaceColor','g');
 hold on; h2=gscatter(inst2(j,1),inst2(j,10),inst2(j,5),'b','x+o.sp'); set(h2,'MarkerSize',6,'MarkerFaceColor','b');
 hold on; h3=gscatter(inst2(j,1),inst2(j,6),inst2(j,5),'r','x+o.sp'); set(h3,'MarkerSize',6,'MarkerFaceColor','r');
 title(sprintf('Final configuration \nFinal day %d%02d',finaldays(dd), Cal.Date.cal_year-2000))       
 legend([h1(1),h2(1),h3(1)],Cal.brw_name{n_ref},Cal.brw_name{Cal.n_inst},[Cal.brw_name{Cal.n_inst} ' old config.'],'Location','SouthEast','Orientation','Horizontal');
         ylabel('Total Ozone (DU)'); grid;
                                                      
                                                  
                                                  
ylabel('Total Ozone (DU)'); grid;
datetick('x',15,'keepLimits','KeepTicks');
set(gca,'YLim',[min(inst2(j,10))-8 max(inst2(j,10))+8])
end

figure(maxf(findobj('tag','_GlobalPlot_')));
printfiles_report(gcf,Cal.dir_figs,'Height',7,'Width',13);


printfiles_report(double(f0):double(f),...
                              Cal.dir_figs,'Width',14.5,'Height',7.5);

graph2latex(Cal.file_latex,{'summaryplot','DayPlot_'},brw_str{n_inst},'scale',0.8);

%% detailed comparison
% %save detailed_comparison o3_c
% %load detailed_comparison
% head='Date_matlab date_dif sza_R airm_R temp_R filter_R O3_R sO3_R ms9 sm9 O3_R_o SO3_R_o O3_R_sl sO3_R_sl I_sza I_airm I_temp I_filter O3_I sO3_I ms9_I sm9_I O3_I_o sO3_I_o O3_I_sl sO3_I_sl';
% [o3,i,j]=unique(o3_c(:,1));
% label_detailed=mmcellstr(strtrim(strrep(head,' ','|')));
% columns_detailed_report=[1:8,21,19,23];
% aux=[cellstr(datestr(o3_c(i,1))),num2cell(o3_c(i,columns_detailed_report))];
% head_end={'date.hour','diff (min)','sza ','airm','MS9','O3ref'};
% summary_end=[diaj2(o3_c(i,1)),fix(o3_c(i,2)*24*60),o3_c(i,15),o3_c(i,16),round(o3_c(i,21)),round(o3_c(i,7)*10)/10];
% matrix2latex_config(summary_end,fullfile(Cal.file_latex,['table_summary_end_',Cal.brw_str{Cal.n_inst},'.tex']),...
%                                   'columnlabels',head_end,...
%                                   'alignment','c');
%
% % if ispc
% % xlswrite_(aux,'',['Date';label_detailed(columns_detailed_report)],'detailed_report.xls');
% % else
% %  head1=cellstr(['Date';label_detailed(columns_detailed_report)]');
% %  cell2csv(['comparison_report_',brw_str{n_inst},'.csv'],[head1;aux],',');
% %  % Todo linux outpit
% % end
%
% % %% configration files
% % head2=[cellstr(leg),num2cell(config_def),num2cell(config_orig),num2cell(config_ref)]';
% % head2{2}='Final ICF';
% % head2{3}='Original ICF';
% % head2{4}='Reference ICF';
% % if ispc
% %   xlswrite_(head2','','','config_report.xls');
% % else
% %   cell2csv(['config_report_',brw_str{n_inst},'.csv'],head2',',');
% % end
%
% %%
% %makeHtmlTable(head2,[]);
%   % 'Date, Diff(min), REF
%
% %close all;
%
% %% Stray light
% [ETC_NEW_ST,o3c,m_etc]=ETC_calibration_C(Cal,summary,A.new(Cal.n_inst),Cal.n_inst,Cal.n_ref(2),7,0.8,0.03,[]);
%
% %%
% figure;
% ms9=o3c(:,21);
% o3p=o3c(:,13).*o3c(:,16)*ETC_NEW_ST(1).TP(2); %airmas from instrument
% ozone_slant=o3c(:,13).*o3c(:,16)/1000; %air mass from instrument
% ozone_scale=fix(ozone_slant/.1)*.1;
% o3rc=(ms9-ETC_NEW_ST(1).TP(1))./(ETC_NEW_ST(1).TP(2)/1000*o3c(:,16));
% y=100*(o3rc-o3c(:,13))./o3c(:,13);
%
%
% %%
%
% [m,s,n,name,v,ci]=grpstats(ms9-o3p,ozone_scale,{'mean','std','numel','gname','var','meanci'});
% x=unique(ozone_scale);
% errorbar(x,m,x-s,x+s); hold on;
% [r,gof,c]=fit(x,m,'power2','Robust','on');
%          plot(ozone_slant,ms9-o3p,'.')
%          plot(r,'r.');
%
%          R=coeffvalues(r);
%
%          hline(R(3),'r',num2str(R(3)));
%          hline(ETC_NEW(1).NEW,'g',num2str(ETC_NEW(1).NEW));
%          title({formula(r),num2str(coeffvalues(r))});
%          suptitle(brw_str(n_inst));
%
%  %% cuadratic
%  figure;
%  f=fittype('a+b*x^2');
%  [r,gof,c]=fit(x,m,f,'Robust','on');
%  plot(ozone_slant,ms9-o3p,'.');hold on;
%  plot(r,'r.');
%  R=coeffvalues(r);
%  hline(ETC_NEW(1).NEW,'g',num2str(ETC_NEW(1).NEW));
%
% title({formula(r),num2str(coeffvalues(r))});
%
%

##### SOURCE END #####
--></body></html>